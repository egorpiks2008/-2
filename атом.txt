import tkinter as tk
from tkinter import messagebox, ttk, scrolledtext, simpledialog, filedialog
import time
import webbrowser
import json
import os
import queue
import random
from urllib.parse import quote
from datetime import datetime
import subprocess
import sys
import urllib.request
import urllib.error
import socket
import threading
import hashlib
from tkinter import font as tkfont
import math
import ctypes
import winsound

# ========== –ò–ù–§–û–†–ú–ê–¶–ò–Ø –î–õ–Ø –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø ==========
print("=" * 60)
print("–ê—Ç–æ–º v4.0 PRO - –ì–æ–ª–æ—Å–æ–≤–æ–π –ø–æ–º–æ—â–Ω–∏–∫")
print("=" * 60)
print("\n–î–ª—è –ø–æ–ª–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ –≥–æ–ª–æ—Å–æ–≤–æ–≥–æ –≤–≤–æ–¥–∞ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ:")
print("1. speech_recognition: pip install SpeechRecognition")
print("2. pyttsx3: pip install pyttsx3")
print("3. pyaudio: pip install pyaudio")
print("\n–ò–õ–ò –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ —Å–∏—Å—Ç–µ–º–Ω–æ–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —Ä–µ—á–∏ –≤ Windows.")
print("=" * 60)
print("\n–í —Ç–µ–∫—É—â–µ–º —Ä–µ–∂–∏–º–µ –¥–æ—Å—Ç—É–ø–µ–Ω —É–ø—Ä–æ—â–µ–Ω–Ω—ã–π –≥–æ–ª–æ—Å–æ–≤–æ–π –≤–≤–æ–¥.")
print("=" * 60)

# ========== –ü–†–û–í–ï–†–ö–ê –î–û–°–¢–£–ü–ù–´–• –ú–ï–¢–û–î–û–í –ì–û–õ–û–°–û–í–û–ì–û –í–í–û–î–ê ==========

VOICE_INPUT_AVAILABLE = False
VOICE_INPUT_METHOD = None
VOICE_METHODS = []

def check_voice_input_methods():
    """–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –º–µ—Ç–æ–¥–æ–≤ –≥–æ–ª–æ—Å–æ–≤–æ–≥–æ –≤–≤–æ–¥–∞"""
    methods = []
    
    try:
        # 1. –ü—Ä–æ–≤–µ—Ä—è–µ–º Windows Speech API
        if os.name == 'nt':
            try:
                # –ü—ã—Ç–∞–µ–º—Å—è —Å–æ–∑–¥–∞—Ç—å COM –æ–±—ä–µ–∫—Ç –¥–ª—è –≥–æ–ª–æ—Å–∞
                try:
                    import win32com.client
                    speaker = win32com.client.Dispatch("SAPI.SpVoice")
                    methods.append(('windows_sapi', 'Windows Speech API (–≥–æ–ª–æ—Å–æ–≤–æ–π –≤—ã–≤–æ–¥)'))
                except ImportError:
                    pass
                
                # –ü—Ä–æ–≤–µ—Ä—è–µ–º —Ä–µ–µ—Å—Ç—Ä –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –≥–æ–ª–æ—Å–æ–≤—ã—Ö –¥–≤–∏–∂–∫–æ–≤
                try:
                    import winreg
                    key = winreg.OpenKey(winreg.HKEY_LOCAL_MACHINE, 
                                       r"SOFTWARE\Microsoft\Speech\Voices\Tokens")
                    winreg.CloseKey(key)
                    methods.append(('windows_speech', 'Windows Speech Platform'))
                except:
                    pass
                    
            except Exception as e:
                print(f"–û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ Windows SAPI: {e}")
    except:
        pass
    
    # 2. –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ speech_recognition (–µ—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)
    try:
        import speech_recognition as sr
        methods.append(('speech_recognition', 'SpeechRecognition (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)'))
    except ImportError:
        pass
    
    # 3. –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ pyttsx3 (–µ—Å–ª–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)
    try:
        import pyttsx3
        methods.append(('pyttsx3', 'PyTTSx3 (—Å–∏–Ω—Ç–µ–∑ —Ä–µ—á–∏)'))
    except ImportError:
        pass
    
    # 4. –î–æ–±–∞–≤–ª—è–µ–º –ø—Ä–æ—Å—Ç–æ–π fallback –º–µ—Ç–æ–¥
    methods.append(('simple_dialog', '–î–∏–∞–ª–æ–≥–æ–≤—ã–π –≤–≤–æ–¥ (—Ä–∞–±–æ—Ç–∞–µ—Ç –≤—Å–µ–≥–¥–∞)'))
    
    return methods

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–æ—Å—Ç—É–ø–Ω—ã–µ –º–µ—Ç–æ–¥—ã
VOICE_METHODS = check_voice_input_methods()
if VOICE_METHODS:
    VOICE_INPUT_AVAILABLE = True
    # –í—ã–±–∏—Ä–∞–µ–º –ª—É—á—à–∏–π –¥–æ—Å—Ç—É–ø–Ω—ã–π –º–µ—Ç–æ–¥
    for method_id, method_name in VOICE_METHODS:
        if method_id in ['speech_recognition', 'windows_sapi', 'pyttsx3']:
            VOICE_INPUT_METHOD = method_id
            break
    else:
        VOICE_INPUT_METHOD = VOICE_METHODS[0][0]
    
    print(f"–î–æ—Å—Ç—É–ø–Ω—ã–µ –º–µ—Ç–æ–¥—ã –≥–æ–ª–æ—Å–æ–≤–æ–≥–æ –≤–≤–æ–¥–∞: {[m[1] for m in VOICE_METHODS]}")
    print(f"–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –º–µ—Ç–æ–¥: {VOICE_INPUT_METHOD}")

# –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ –¥–ª—è –≥–æ–ª–æ—Å–æ–≤–æ–≥–æ –ø–æ–º–æ—â–Ω–∏–∫–∞ –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–Ω—ã
try:
    import speech_recognition as sr
    import pyttsx3
    SPEECH_AVAILABLE = True
except ImportError:
    SPEECH_AVAILABLE = False
    print("\n–ë–∏–±–ª–∏–æ—Ç–µ–∫–∏ –¥–ª—è –≥–æ–ª–æ—Å–æ–≤–æ–≥–æ –ø–æ–º–æ—â–Ω–∏–∫–∞ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã.")
    print("–î–æ—Å—Ç—É–ø–µ–Ω —É–ø—Ä–æ—â–µ–Ω–Ω—ã–π —Ä–µ–∂–∏–º –≥–æ–ª–æ—Å–æ–≤–æ–≥–æ –≤–≤–æ–¥–∞.")

# –î–ª—è –∑–≤—É–∫–∞ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –≤ Windows
try:
    import winsound
    WINSOUND_AVAILABLE = True
except ImportError:
    WINSOUND_AVAILABLE = False

# ========== –ö–û–î –ò–ò-–ê–°–°–ò–°–¢–ï–ù–¢–ê ==========

import pickle
from collections import defaultdict, deque
from typing import List, Tuple, Dict, Any, Optional, Union
from dataclasses import dataclass
from enum import Enum
import statistics
import itertools
import re
import csv
from pathlib import Path

class ActivationFunction(Enum):
    SIGMOID = "sigmoid"
    RELU = "relu"
    TANH = "tanh"
    LEAKY_RELU = "leaky_relu"
    SOFTMAX = "softmax"

@dataclass
class TrainingConfig:
    learning_rate: float = 0.01
    momentum: float = 0.9
    batch_size: int = 32
    epochs: int = 100
    l2_lambda: float = 0.001
    dropout_rate: float = 0.0
    early_stopping_patience: int = 10
    validation_split: float = 0.2

class EnhancedNeuralNetwork:
    def __init__(self, layers: List[int], 
                 activations: List[ActivationFunction] = None,
                 config: TrainingConfig = None):
        
        self.layers = layers
        self.num_layers = len(layers)
        self.config = config or TrainingConfig()
        
        if activations is None:
            activations = [ActivationFunction.RELU] * (len(layers) - 2)
            activations.append(ActivationFunction.SIGMOID)
        
        self.activations = activations
        self.weights = []
        self.biases = []
        
        for i in range(len(layers) - 1):
            if i < len(activations) and activations[i] == ActivationFunction.RELU:
                std = math.sqrt(2.0 / layers[i])
            else:
                std = math.sqrt(1.0 / layers[i])
            
            weight_matrix = [[random.gauss(0, std) for _ in range(layers[i + 1])] 
                            for _ in range(layers[i])]
            bias_vector = [0.0 for _ in range(layers[i + 1])]
            
            self.weights.append(weight_matrix)
            self.biases.append(bias_vector)
        
        self.history = {'loss': [], 'accuracy': [], 'val_loss': [], 'val_accuracy': []}
    
    def _activate(self, x: float, activation: ActivationFunction) -> float:
        if activation == ActivationFunction.SIGMOID:
            return 1.0 / (1.0 + math.exp(-x))
        elif activation == ActivationFunction.RELU:
            return max(0.0, x)
        elif activation == ActivationFunction.LEAKY_RELU:
            return x if x > 0 else 0.01 * x
        elif activation == ActivationFunction.TANH:
            return math.tanh(x)
        else:
            return x
    
    def _activate_derivative(self, x: float, activation: ActivationFunction) -> float:
        if activation == ActivationFunction.SIGMOID:
            return x * (1 - x)
        elif activation == ActivationFunction.RELU:
            return 1.0 if x > 0 else 0.0
        elif activation == ActivationFunction.LEAKY_RELU:
            return 1.0 if x > 0 else 0.01
        elif activation == ActivationFunction.TANH:
            return 1 - x ** 2
        else:
            return 1.0
    
    def _softmax(self, x: List[float]) -> List[float]:
        exp_values = [math.exp(val - max(x)) for val in x]
        sum_exp = sum(exp_values)
        return [val / sum_exp for val in exp_values]
    
    def feedforward(self, inputs: List[float], training: bool = False):
        activations = [inputs]
        z_values = []
        current_activation = inputs
        
        for i in range(self.num_layers - 1):
            z = []
            for j in range(self.layers[i + 1]):
                weighted_sum = self.biases[i][j]
                for k in range(self.layers[i]):
                    weighted_sum += current_activation[k] * self.weights[i][k][j]
                z.append(weighted_sum)
            
            z_values.append(z)
            
            if i == self.num_layers - 2 and self.activations[i] == ActivationFunction.SOFTMAX:
                next_activation = self._softmax(z)
            else:
                next_activation = [self._activate(val, self.activations[i]) for val in z]
            
            if training and self.config.dropout_rate > 0 and i < self.num_layers - 2:
                next_activation = [val if random.random() > self.config.dropout_rate else 0 
                                 for val in next_activation]
            
            activations.append(next_activation)
            current_activation = next_activation
        
        return activations, z_values
    
    def predict(self, inputs: List[float]) -> List[float]:
        activations, _ = self.feedforward(inputs, training=False)
        return activations[-1]
    
    def predict_batch(self, X: List[List[float]]) -> List[List[float]]:
        return [self.predict(x) for x in X]
    
    def compute_loss(self, predictions: List[float], targets: List[float]) -> float:
        epsilon = 1e-8
        loss = 0.0
        for pred, target in zip(predictions, targets):
            loss -= target * math.log(pred + epsilon)
        return loss
    
    def compute_accuracy(self, predictions: List[List[float]], targets: List[List[float]]) -> float:
        correct = 0
        for pred, target in zip(predictions, targets):
            pred_idx = pred.index(max(pred))
            target_idx = target.index(max(target))
            if pred_idx == target_idx:
                correct += 1
        return correct / len(predictions)
    
    def train_on_batch(self, X_batch: List[List[float]], y_batch: List[List[float]]) -> float:
        total_loss = 0.0
        for X, y in zip(X_batch, y_batch):
            activations, _ = self.feedforward(X, training=True)
            total_loss += self.compute_loss(activations[-1], y)
        return total_loss / len(X_batch)
    
    def fit(self, X: List[List[float]], y: List[List[float]], verbose: bool = True):
        split_idx = int(len(X) * (1 - self.config.validation_split))
        X_train, X_val = X[:split_idx], X[split_idx:]
        y_train, y_val = y[:split_idx], y[split_idx:]
        
        for epoch in range(self.config.epochs):
            indices = list(range(len(X_train)))
            random.shuffle(indices)
            X_shuffled = [X_train[i] for i in indices]
            y_shuffled = [y_train[i] for i in indices]
            
            epoch_loss = 0.0
            num_batches = 0
            
            for i in range(0, len(X_train), self.config.batch_size):
                X_batch = X_shuffled[i:i + self.config.batch_size]
                y_batch = y_shuffled[i:i + self.config.batch_size]
                batch_loss = self.train_on_batch(X_batch, y_batch)
                epoch_loss += batch_loss
                num_batches += 1
            
            avg_loss = epoch_loss / max(num_batches, 1)
            
            val_loss = 0.0
            val_accuracy = 0.0
            
            if X_val:
                val_predictions = self.predict_batch(X_val)
                val_loss = sum(self.compute_loss(pred, target) 
                             for pred, target in zip(val_predictions, y_val)) / len(X_val)
                val_accuracy = self.compute_accuracy(val_predictions, y_val)
            
            train_predictions = self.predict_batch(X_train[:100])
            train_accuracy = self.compute_accuracy(train_predictions, y_train[:100])
            
            self.history['loss'].append(avg_loss)
            self.history['accuracy'].append(train_accuracy)
            self.history['val_loss'].append(val_loss)
            self.history['val_accuracy'].append(val_accuracy)
            
            if verbose and epoch % 10 == 0:
                print(f"Epoch {epoch:3d}: loss={avg_loss:.4f}, acc={train_accuracy:.4f}, val_loss={val_loss:.4f}, val_acc={val_accuracy:.4f}")
        
        return self.history
    
    def save(self, filename: str):
        data = {
            'layers': self.layers,
            'weights': self.weights,
            'biases': self.biases,
            'activations': [a.value for a in self.activations],
            'config': self.config.__dict__,
            'history': self.history
        }
        with open(filename, 'wb') as f:
            pickle.dump(data, f)
    
    @classmethod
    def load(cls, filename: str):
        with open(filename, 'rb') as f:
            data = pickle.load(f)
        config = TrainingConfig(**data['config'])
        activations = [ActivationFunction(a) for a in data['activations']]
        model = cls(data['layers'], activations, config)
        model.weights = data['weights']
        model.biases = data['biases']
        model.history = data['history']
        return model

class AIAssistantCore:
    def __init__(self):
        self.models = {}
        self.data_storage = defaultdict(list)
        self.history = []
        self.context = {}
        
    def process_query(self, query: str) -> str:
        """–û—Å–Ω–æ–≤–Ω–æ–π –º–µ—Ç–æ–¥ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤"""
        self.history.append((datetime.now(), query))
        
        # –û—á–∏—Å—Ç–∫–∞ –∑–∞–ø—Ä–æ—Å–∞
        query = query.lower().strip()
        
        # –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ –∑–∞–ø—Ä–æ—Å–∞
        response = ""
        
        if any(word in query for word in ['–æ–±—É—á–∏', '—Ç—Ä–µ–Ω–∏—Ä—É–π', '—Å–æ–∑–¥–∞–π –º–æ–¥–µ–ª—å', '—Å–æ–∑–¥–∞–π –Ω–µ–π—Ä–æ—Å–µ—Ç—å']):
            response = self.handle_training_request(query)
        elif any(word in query for word in ['–ø—Ä–µ–¥—Å–∫–∞–∂–∏', '–ø—Ä–æ–≥–Ω–æ–∑', '–∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–π', '—Ä–∞—Å–ø–æ–∑–Ω–∞–π']):
            response = self.handle_prediction_request(query)
        elif any(word in query for word in ['—Å–æ—Ö—Ä–∞–Ω–∏', '—ç–∫—Å–ø–æ—Ä—Ç', '–∑–∞–ø–∏—à–∏']):
            response = self.handle_save_request(query)
        elif any(word in query for word in ['–∑–∞–≥—Ä—É–∑–∏', '–∏–º–ø–æ—Ä—Ç', '–æ—Ç–∫—Ä–æ–π']):
            response = self.handle_load_request(query)
        elif any(word in query for word in ['–ø–æ–º–æ—â—å', 'help', '–∫–æ–º–∞–Ω–¥—ã']):
            response = self.show_help()
        elif any(word in query for word in ['–ø—Ä–∏–º–µ—Ä', '–¥–µ–º–æ', '—Ç–µ—Å—Ç']):
            response = self.run_demo()
        elif any(word in query for word in ['—Å—Ç–∞—Ç—É—Å', '–∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è', '–∏–Ω—Ñ–æ']):
            response = self.show_status()
        elif any(word in query for word in ['–æ—á–∏—Å—Ç–∏', '—É–¥–∞–ª–∏', 'reset']):
            response = self.clear_data(query)
        elif any(word in query for word in ['–∞–Ω–∞–ª–∏–∑', '–ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π', '—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞']):
            response = self.analyze_data(query)
        else:
            response = self.handle_general_query(query)
        
        return response
    
    def handle_training_request(self, query: str) -> str:
        """–û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ –æ–±—É—á–µ–Ω–∏–µ"""
        try:
            if '–Ω–µ–π—Ä–æ—Å–µ—Ç—å' in query or '–Ω–µ–π—Ä–æ–Ω–Ω—É—é —Å–µ—Ç—å' in query:
                return self.train_neural_network(query)
            elif '—Å–ª—É—á–∞–π–Ω—ã–π –ª–µ—Å' in query or 'random forest' in query:
                return self.train_random_forest(query)
            elif '–¥–µ—Ä–µ–≤–æ' in query or 'decision tree' in query:
                return self.train_decision_tree(query)
            elif '–∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—è' in query or 'k-means' in query:
                return self.train_kmeans(query)
            else:
                return "–ö–∞–∫—É—é –º–æ–¥–µ–ª—å –≤—ã —Ö–æ—Ç–∏—Ç–µ –æ–±—É—á–∏—Ç—å? –£–∫–∞–∂–∏—Ç–µ: –Ω–µ–π—Ä–æ—Å–µ—Ç—å, —Å–ª—É—á–∞–π–Ω—ã–π –ª–µ—Å, –¥–µ—Ä–µ–≤–æ —Ä–µ—à–µ–Ω–∏–π –∏–ª–∏ –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—é."
        except Exception as e:
            return f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏: {str(e)}"
    
    def handle_prediction_request(self, query: str) -> str:
        """–û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ"""
        try:
            # –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ –∑–∞–ø—Ä–æ—Å–∞
            numbers = self.extract_numbers(query)
            if not numbers:
                return "–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø—Ä–µ–¥–æ—Å—Ç–∞–≤—å—Ç–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –≤ –≤–∏–¥–µ —á–∏—Å–µ–ª."
            
            # –ü–æ–∏—Å–∫ –º–æ–¥–µ–ª–∏
            model_name = self.find_model_in_query(query)
            if not model_name:
                return "–ö–∞–∫–∞—è –º–æ–¥–µ–ª—å –¥–æ–ª–∂–Ω–∞ —Å–¥–µ–ª–∞—Ç—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ? –£–∫–∞–∂–∏—Ç–µ –∏–º—è –º–æ–¥–µ–ª–∏."
            
            if model_name not in self.models:
                return f"–ú–æ–¥–µ–ª—å '{model_name}' –Ω–µ –Ω–∞–π–¥–µ–Ω–∞. –°–Ω–∞—á–∞–ª–∞ –æ–±—É—á–∏—Ç–µ –º–æ–¥–µ–ª—å."
            
            model = self.models[model_name]
            
            if hasattr(model, 'predict'):
                prediction = model.predict([numbers])
                if isinstance(prediction[0], list):
                    # –î–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –∫–ª–∞—Å—Å–∞–º–∏
                    pred_values = prediction[0]
                    max_idx = pred_values.index(max(pred_values))
                    return f"–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ: –∫–ª–∞—Å—Å {max_idx} —Å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—è–º–∏: {pred_values}"
                else:
                    # –î–ª—è —Ä–µ–≥—Ä–µ—Å—Å–∏–∏ –∏–ª–∏ –±–∏–Ω–∞—Ä–Ω–æ–π –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏
                    return f"–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ: {prediction[0]}"
            else:
                return "–ú–æ–¥–µ–ª—å –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è."
                
        except Exception as e:
            return f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–∏: {str(e)}"
    
    def handle_save_request(self, query: str) -> str:
        """–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π –∏–ª–∏ –¥–∞–Ω–Ω—ã—Ö"""
        try:
            if '–º–æ–¥–µ–ª—å' in query:
                # –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∏–º–µ–Ω–∏ –º–æ–¥–µ–ª–∏
                match = re.search(r'–º–æ–¥–µ–ª—å\s+(\w+)', query)
                if match:
                    model_name = match.group(1)
                    if model_name in self.models:
                        filename = f"{model_name}_model.pkl"
                        self.models[model_name].save(filename)
                        return f"–ú–æ–¥–µ–ª—å '{model_name}' —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞ –≤ —Ñ–∞–π–ª {filename}"
                return "–£–∫–∞–∂–∏—Ç–µ –∏–º—è –º–æ–¥–µ–ª–∏ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è."
            else:
                # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
                filename = "data_export.json"
                with open(filename, 'w') as f:
                    json.dump(self.data_storage, f)
                return f"–î–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤ —Ñ–∞–π–ª {filename}"
        except Exception as e:
            return f"–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏: {str(e)}"
    
    def handle_load_request(self, query: str) -> str:
        """–ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–µ–π –∏–ª–∏ –¥–∞–Ω–Ω—ã—Ö"""
        try:
            if '–º–æ–¥–µ–ª—å' in query:
                # –ü–æ–∏—Å–∫ —Ñ–∞–π–ª–∞ –º–æ–¥–µ–ª–∏
                files = [f for f in os.listdir() if f.endswith('_model.pkl')]
                if files:
                    filename = files[0]
                    model_name = filename.replace('_model.pkl', '')
                    self.models[model_name] = EnhancedNeuralNetwork.load(filename)
                    return f"–ú–æ–¥–µ–ª—å '{model_name}' –∑–∞–≥—Ä—É–∂–µ–Ω–∞ –∏–∑ —Ñ–∞–π–ª–∞ {filename}"
                return "–§–∞–π–ª—ã –º–æ–¥–µ–ª–µ–π –Ω–µ –Ω–∞–π–¥–µ–Ω—ã."
            else:
                # –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
                if os.path.exists("data_export.json"):
                    with open("data_export.json", 'r') as f:
                        self.data_storage = json.load(f)
                    return "–î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –∏–∑ —Ñ–∞–π–ª–∞ data_export.json"
                return "–§–∞–π–ª –¥–∞–Ω–Ω—ã—Ö –Ω–µ –Ω–∞–π–¥–µ–Ω."
        except Exception as e:
            return f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ: {str(e)}"
    
    def handle_general_query(self, query: str) -> str:
        """–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ–±—â–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤"""
        responses = {
            '–ø—Ä–∏–≤–µ—Ç': "–ü—Ä–∏–≤–µ—Ç! –Ø –≤–∞—à –ò–ò –∞—Å—Å–∏—Å—Ç–µ–Ω—Ç. –ß–µ–º –º–æ–≥—É –ø–æ–º–æ—á—å?",
            '–∫–∞–∫ –¥–µ–ª–∞': "–£ –º–µ–Ω—è –≤—Å—ë —Ö–æ—Ä–æ—à–æ! –ì–æ—Ç–æ–≤ –ø–æ–º–æ—á—å –≤–∞–º —Å –∑–∞–¥–∞—á–∞–º–∏ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è.",
            '—Å–ø–∞—Å–∏–±–æ': "–ü–æ–∂–∞–ª—É–π—Å—Ç–∞! –û–±—Ä–∞—â–∞–π—Ç–µ—Å—å, –µ—Å–ª–∏ –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è –µ—â—ë –ø–æ–º–æ—â—å.",
            '–ø–æ–∫–∞': "–î–æ —Å–≤–∏–¥–∞–Ω–∏—è! –ë—É–¥—É —Ä–∞–¥ –ø–æ–º–æ—á—å –≤–∞–º –≤ –±—É–¥—É—â–µ–º.",
            '—á—Ç–æ —Ç—ã —É–º–µ–µ—à—å': "–Ø –º–æ–≥—É –æ–±—É—á–∞—Ç—å –º–æ–¥–µ–ª–∏, –¥–µ–ª–∞—Ç—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è, –∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ –∏ –º–Ω–æ–≥–æ–µ –¥—Ä—É–≥–æ–µ. –°–∫–∞–∂–∏—Ç–µ '–ø–æ–º–æ—â—å' –¥–ª—è —Å–ø–∏—Å–∫–∞ –∫–æ–º–∞–Ω–¥.",
            '–≤—Ä–µ–º—è': f"–¢–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è: {datetime.now().strftime('%H:%M:%S')}",
            '–¥–∞—Ç–∞': f"–°–µ–≥–æ–¥–Ω—è: {datetime.now().strftime('%d.%m.%Y')}",
        }
        
        for key, response in responses.items():
            if key in query:
                return response
        
        # –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è
        if any(op in query for op in ['+', '-', '*', '/', '^']):
            try:
                # –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ
                expr = query.replace('x', '*').replace('^', '**')
                # –£–¥–∞–ª—è–µ–º –≤—Å—ë –∫—Ä–æ–º–µ —á–∏—Å–µ–ª –∏ –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤
                expr = re.sub(r'[^\d\+\-\*\/\.\(\)\s]', '', expr)
                if expr:
                    result = eval(expr)
                    return f"–†–µ–∑—É–ª—å—Ç–∞—Ç: {result}"
            except:
                pass
        
        # –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
        if '—Å–≥–µ–Ω–µ—Ä–∏—Ä—É–π –¥–∞–Ω–Ω—ã–µ' in query or '—Å–æ–∑–¥–∞–π –¥–∞–Ω–Ω—ã–µ' in query:
            return self.generate_sample_data()
        
        return "–ò–∑–≤–∏–Ω–∏—Ç–µ, —è –Ω–µ —Å–æ–≤—Å–µ–º –ø–æ–Ω—è–ª –∑–∞–ø—Ä–æ—Å. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–µ—Ä–µ—Ñ—Ä–∞–∑–∏—Ä–æ–≤–∞—Ç—å –∏–ª–∏ —Å–∫–∞–∂–∏—Ç–µ '–ø–æ–º–æ—â—å' –¥–ª—è —Å–ø–∏—Å–∫–∞ –∫–æ–º–∞–Ω–¥."
    
    def extract_numbers(self, text: str) -> List[float]:
        """–ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —á–∏—Å–µ–ª –∏–∑ —Ç–µ–∫—Å—Ç–∞"""
        numbers = re.findall(r'[-+]?\d*\.\d+|\d+', text)
        return [float(num) for num in numbers]
    
    def find_model_in_query(self, query: str) -> str:
        """–ü–æ–∏—Å–∫ –∏–º–µ–Ω–∏ –º–æ–¥–µ–ª–∏ –≤ –∑–∞–ø—Ä–æ—Å–µ"""
        for model_name in self.models.keys():
            if model_name.lower() in query.lower():
                return model_name
        
        # –ï—Å–ª–∏ –º–æ–¥–µ–ª—å –Ω–µ —É–∫–∞–∑–∞–Ω–∞, –≤–µ—Ä–Ω–µ–º –ø–µ—Ä–≤—É—é –¥–æ—Å—Ç—É–ø–Ω—É—é
        if self.models:
            return list(self.models.keys())[0]
        
        return ""
    
    def train_neural_network(self, query: str) -> str:
        """–û–±—É—á–µ–Ω–∏–µ –Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Å–µ—Ç–∏"""
        # –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –∏–∑ –∑–∞–ø—Ä–æ—Å–∞
        if '–¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏' in query:
            layers = [10, 16, 8, 3]  # –ü—Ä–∏–º–µ—Ä –¥–ª—è 3 –∫–ª–∞—Å—Å–æ–≤
        elif '–¥–ª—è —Ä–µ–≥—Ä–µ—Å—Å–∏–∏' in query:
            layers = [10, 8, 4, 1]
        else:
            layers = [10, 8, 4, 2]  # –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é
        
        # –°–æ–∑–¥–∞–Ω–∏–µ –∏ –æ–±—É—á–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
        model_name = f"nn_model_{len(self.models)}"
        config = TrainingConfig(epochs=50, learning_rate=0.01)
        
        # –°–æ–∑–¥–∞–Ω–∏–µ —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö
        n_samples = 100
        n_features = layers[0]
        n_classes = layers[-1] if layers[-1] > 1 else 2
        
        X, y = self.create_sample_data(n_samples, n_features, n_classes)
        
        model = EnhancedNeuralNetwork(
            layers=layers,
            activations=[
                ActivationFunction.RELU,
                ActivationFunction.RELU,
                ActivationFunction.SOFTMAX if n_classes > 1 else ActivationFunction.SIGMOID
            ],
            config=config
        )
        
        history = model.fit(X, y, verbose=False)
        
        # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
        self.models[model_name] = model
        self.data_storage[model_name] = {
            'X_sample': X[:5],  # –°–æ—Ö—Ä–∞–Ω—è–µ–º –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø—Ä–∏–º–µ—Ä–æ–≤
            'y_sample': y[:5],
            'history': history
        }
        
        accuracy = history['accuracy'][-1]
        return f"–ú–æ–¥–µ–ª—å '{model_name}' –æ–±—É—á–µ–Ω–∞! –¢–æ—á–Ω–æ—Å—Ç—å: {accuracy:.2%}\n–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞: {layers}"
    
    def train_random_forest(self, query: str) -> str:
        """–û–±—É—á–µ–Ω–∏–µ —Å–ª—É—á–∞–π–Ω–æ–≥–æ –ª–µ—Å–∞ (—É–ø—Ä–æ—â–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è)"""
        model_name = f"rf_model_{len(self.models)}"
        
        # –°–æ–∑–¥–∞–Ω–∏–µ —É–ø—Ä–æ—â–µ–Ω–Ω–æ–≥–æ –¥–µ—Ä–µ–≤–∞
        class SimpleTree:
            def __init__(self):
                self.threshold = random.random()
                self.feature = random.randint(0, 9)
            
            def predict(self, X):
                return [1 if x[self.feature] > self.threshold else 0 for x in X]
        
        # –°–æ–∑–¥–∞–Ω–∏–µ "—Å–ª—É—á–∞–π–Ω–æ–≥–æ –ª–µ—Å–∞" –∏–∑ –ø—Ä–æ—Å—Ç—ã—Ö –¥–µ—Ä–µ–≤—å–µ–≤
        class SimpleRandomForest:
            def __init__(self, n_trees=10):
                self.trees = [SimpleTree() for _ in range(n_trees)]
            
            def predict(self, X):
                predictions = []
                for x in X:
                    votes = [tree.predict([x])[0] for tree in self.trees]
                    prediction = 1 if sum(votes) > len(votes) / 2 else 0
                    predictions.append(prediction)
                return predictions
        
        model = SimpleRandomForest(n_trees=10)
        self.models[model_name] = model
        
        return f"–°–ª—É—á–∞–π–Ω—ã–π –ª–µ—Å '{model_name}' —Å–æ–∑–¥–∞–Ω! (10 –¥–µ—Ä–µ–≤—å–µ–≤)"
    
    def train_decision_tree(self, query: str) -> str:
        """–û–±—É—á–µ–Ω–∏–µ –¥–µ—Ä–µ–≤–∞ —Ä–µ—à–µ–Ω–∏–π"""
        model_name = f"dt_model_{len(self.models)}"
        
        class SimpleDecisionTree:
            def __init__(self):
                self.threshold = 0.5
                self.feature = 0
            
            def fit(self, X, y):
                # –ü—Ä–æ—Å—Ç–∞—è –ª–æ–≥–∏–∫–∞: –Ω–∞—Ö–æ–¥–∏–º –ª—É—á—à–∏–π –ø–æ—Ä–æ–≥ –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ –ø—Ä–∏–∑–Ω–∞–∫–∞
                if X:
                    self.feature = random.randint(0, len(X[0])-1)
                    values = [x[self.feature] for x in X]
                    if values:
                        self.threshold = sum(values) / len(values)
                return self
            
            def predict(self, X):
                return [1 if x[self.feature] > self.threshold else 0 for x in X]
        
        model = SimpleDecisionTree()
        self.models[model_name] = model
        
        return f"–î–µ—Ä–µ–≤–æ —Ä–µ—à–µ–Ω–∏–π '{model_name}' —Å–æ–∑–¥–∞–Ω–æ!"
    
    def train_kmeans(self, query: str) -> str:
        """–û–±—É—á–µ–Ω–∏–µ K-means"""
        model_name = f"kmeans_model_{len(self.models)}"
        
        class SimpleKMeans:
            def __init__(self, n_clusters=3):
                self.n_clusters = n_clusters
                self.centroids = []
            
            def fit(self, X):
                if X and len(X) >= self.n_clusters:
                    indices = random.sample(range(len(X)), self.n_clusters)
                    self.centroids = [X[i][:] for i in indices]
                return self
            
            def predict(self, X):
                predictions = []
                for x in X:
                    if self.centroids:
                        distances = [math.sqrt(sum((x[i]-c[i])**2 for i in range(min(len(x), len(c))))) 
                                   for c in self.centroids]
                        predictions.append(distances.index(min(distances)))
                    else:
                        predictions.append(0)
                return predictions
        
        model = SimpleKMeans(n_clusters=3)
        self.models[model_name] = model
        
        return f"K-means –º–æ–¥–µ–ª—å '{model_name}' —Å–æ–∑–¥–∞–Ω–∞! (3 –∫–ª–∞—Å—Ç–µ—Ä–∞)"
    
    def create_sample_data(self, n_samples: int, n_features: int, n_classes: int):
        """–°–æ–∑–¥–∞–Ω–∏–µ —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö"""
        X = []
        y = []
        
        for _ in range(n_samples):
            sample = [random.uniform(-1, 1) for _ in range(n_features)]
            X.append(sample)
            
            if n_classes > 1:
                # –ú–Ω–æ–≥–æ–∫–ª–∞—Å—Å–æ–≤–∞—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è
                if sum(sample[:3]) > 0.5:
                    class_idx = 0
                elif sum(sample[3:6]) < -0.5:
                    class_idx = 1
                else:
                    class_idx = 2 if n_classes > 2 else 1
                
                one_hot = [0] * n_classes
                one_hot[class_idx % n_classes] = 1
                y.append(one_hot)
            else:
                # –†–µ–≥—Ä–µ—Å—Å–∏—è
                y.append([sum(sample) + random.gauss(0, 0.1)])
        
        return X, y
    
    def generate_sample_data(self) -> str:
        """–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–∏–º–µ—Ä–æ–≤ –¥–∞–Ω–Ω—ã—Ö"""
        datasets = {
            'iris': "–ò—Ä–∏—Å—ã –§–∏—à–µ—Ä–∞: 4 –ø—Ä–∏–∑–Ω–∞–∫–∞, 3 –∫–ª–∞—Å—Å–∞ (setosa, versicolor, virginica)",
            'mnist': "–¶–∏—Ñ—Ä—ã MNIST: 784 –ø—Ä–∏–∑–Ω–∞–∫–∞ (28x28), 10 –∫–ª–∞—Å—Å–æ–≤ (0-9)",
            'titanic': "–î–∞–Ω–Ω—ã–µ –¢–∏—Ç–∞–Ω–∏–∫–∞: –≤–æ–∑—Ä–∞—Å—Ç, –ø–æ–ª, –∫–ª–∞—Å—Å –±–∏–ª–µ—Ç–∞...",
            'boston': "–ë–æ—Å—Ç–æ–Ω—Å–∫–æ–µ –∂–∏–ª—å–µ: 13 –ø—Ä–∏–∑–Ω–∞–∫–æ–≤, —Ü–µ–Ω–∞ –Ω–µ–¥–≤–∏–∂–∏–º–æ—Å—Ç–∏",
            'xor': "XOR –ø—Ä–æ–±–ª–µ–º–∞: 2 –≤—Ö–æ–¥–∞, 1 –≤—ã—Ö–æ–¥ (0 –∏–ª–∏ 1)"
        }
        
        result = "–ü—Ä–∏–º–µ—Ä—ã –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ–±—É—á–µ–Ω–∏—è:\n"
        for name, desc in datasets.items():
            result += f"‚Ä¢ {name}: {desc}\n"
        
        result += "\n–°–∫–∞–∂–∏—Ç–µ '–æ–±—É—á–∏ –º–æ–¥–µ–ª—å –Ω–∞ XOR' –∏–ª–∏ '—Å–æ–∑–¥–∞–π –Ω–µ–π—Ä–æ—Å–µ—Ç—å –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏'"
        return result
    
    def show_help(self) -> str:
        """–ü–æ–∫–∞–∑–∞—Ç—å —Å–ø—Ä–∞–≤–∫—É –ø–æ –∫–æ–º–∞–Ω–¥–∞–º"""
        help_text = """
üéØ –î–û–°–¢–£–ü–ù–´–ï –ö–û–ú–ê–ù–î–´ –ò–ò-–ê–°–°–ò–°–¢–ï–ù–¢–ê:

ü§ñ –û–ë–£–ß–ï–ù–ò–ï –ú–û–î–ï–õ–ï–ô:
‚Ä¢ "–û–±—É—á–∏ –Ω–µ–π—Ä–æ—Å–µ—Ç—å –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏"
‚Ä¢ "–°–æ–∑–¥–∞–π —Å–ª—É—á–∞–π–Ω—ã–π –ª–µ—Å"
‚Ä¢ "–û–±—É—á–∏ –¥–µ—Ä–µ–≤–æ —Ä–µ—à–µ–Ω–∏–π"
‚Ä¢ "–°–¥–µ–ª–∞–π –∫–ª–∞—Å—Ç–µ—Ä–∏–∑–∞—Ü–∏—é K-means"

üìä –ü–†–ï–î–°–ö–ê–ó–ê–ù–ò–Ø:
‚Ä¢ "–ü—Ä–µ–¥—Å–∫–∞–∂–∏ –ø–æ –º–æ–¥–µ–ª–∏ [–∏–º—è] –¥–∞–Ω–Ω—ã–µ: 1, 2, 3"
‚Ä¢ "–ö–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–π: 5.1, 3.5, 1.4, 0.2"
‚Ä¢ "–°–¥–µ–ª–∞–π –ø—Ä–æ–≥–Ω–æ–∑ –¥–ª—è [—á–∏—Å–ª–∞]"

üíæ –°–û–•–†–ê–ù–ï–ù–ò–ï/–ó–ê–ì–†–£–ó–ö–ê:
‚Ä¢ "–°–æ—Ö—Ä–∞–Ω–∏ –º–æ–¥–µ–ª—å –∫–∞–∫ model1"
‚Ä¢ "–ó–∞–≥—Ä—É–∑–∏ –ø–æ—Å–ª–µ–¥–Ω—é—é –º–æ–¥–µ–ª—å"
‚Ä¢ "–≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–π –¥–∞–Ω–Ω—ã–µ"

üìà –ê–ù–ê–õ–ò–ó –î–ê–ù–ù–´–•:
‚Ä¢ "–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π –¥–∞–Ω–Ω—ã–µ"
‚Ä¢ "–ü–æ–∫–∞–∂–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É"
‚Ä¢ "–°–≥–µ–Ω–µ—Ä–∏—Ä—É–π –ø—Ä–∏–º–µ—Ä –¥–∞–Ω–Ω—ã—Ö"

üõ† –î–†–£–ì–ò–ï –ö–û–ú–ê–ù–î–´:
‚Ä¢ "–ü–æ–º–æ—â—å" - –ø–æ–∫–∞–∑–∞—Ç—å —ç—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ
‚Ä¢ "–°—Ç–∞—Ç—É—Å" - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –º–æ–¥–µ–ª—è—Ö
‚Ä¢ "–ü—Ä–∏–º–µ—Ä" - –∑–∞–ø—É—Å—Ç–∏—Ç—å –¥–µ–º–æ
‚Ä¢ "–û—á–∏—Å—Ç–∏ –≤—Å—ë" - —É–¥–∞–ª–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ

üìù –ü–†–ò–ú–ï–†–´ –ó–ê–ü–†–û–°–û–í:
‚Ä¢ "–û–±—É—á–∏ –Ω–µ–π—Ä–æ—Å–µ—Ç—å –Ω–∞ 100 –ø—Ä–∏–º–µ—Ä–æ–≤"
‚Ä¢ "–ü—Ä–µ–¥—Å–∫–∞–∂–∏ —Å –ø–æ–º–æ—â—å—é –º–æ–¥–µ–ª–∏ nn_model_0: 0.5, -0.2, 0.8"
‚Ä¢ "–°–æ—Ö—Ä–∞–Ω–∏ –≤—Å–µ –º–æ–¥–µ–ª–∏"
‚Ä¢ "–ü–æ–∫–∞–∂–∏ —á—Ç–æ —Ç—ã —É–º–µ–µ—à—å"
"""
        return help_text
    
    def run_demo(self) -> str:
        """–ó–∞–ø—É—Å–∫ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏"""
        demo_steps = [
            "1. –°–æ–∑–¥–∞—é –Ω–µ–π—Ä–æ—Å–µ—Ç—å –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏...",
            "2. –û–±—É—á–∞—é –Ω–∞ —Å–∏–Ω—Ç–µ—Ç–∏—á–µ—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö...",
            "3. –î–µ–ª–∞—é –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ...",
            "4. –°–æ—Ö—Ä–∞–Ω—è—é –º–æ–¥–µ–ª—å..."
        ]
        
        result = "üöÄ –ó–ê–ü–£–°–ö –î–ï–ú–û–ù–°–¢–†–ê–¶–ò–ò:\n\n"
        for step in demo_steps:
            result += step + "\n"
            time.sleep(0.5)
        
        # –î–µ–º–æ –æ–±—É—á–µ–Ω–∏–µ
        model_name = f"demo_model_{len(self.models)}"
        config = TrainingConfig(epochs=20, learning_rate=0.05)
        
        X, y = self.create_sample_data(50, 5, 3)
        
        model = EnhancedNeuralNetwork(
            layers=[5, 8, 3],
            activations=[ActivationFunction.RELU, ActivationFunction.SOFTMAX],
            config=config
        )
        
        history = model.fit(X, y, verbose=False)
        self.models[model_name] = model
        
        # –î–µ–º–æ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ
        test_sample = [random.uniform(-1, 1) for _ in range(5)]
        prediction = model.predict(test_sample)
        pred_class = prediction.index(max(prediction))
        
        result += f"\n‚úÖ –î–ï–ú–û –ó–ê–í–ï–†–®–ï–ù–û!\n"
        result += f"–ú–æ–¥–µ–ª—å: {model_name}\n"
        result += f"–¢–µ—Å—Ç–æ–≤—ã–π –æ–±—Ä–∞–∑–µ—Ü: {test_sample[:3]}...\n"
        result += f"–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ: –∫–ª–∞—Å—Å {pred_class}\n"
        result += f"–í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç–∏: {[f'{p:.2f}' for p in prediction]}\n"
        
        return result
    
    def show_status(self) -> str:
        """–ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã"""
        status = "üìä –°–¢–ê–¢–£–° –°–ò–°–¢–ï–ú–´:\n\n"
        
        # –ú–æ–¥–µ–ª–∏
        if self.models:
            status += f"ü§ñ –û–±—É—á–µ–Ω–æ –º–æ–¥–µ–ª–µ–π: {len(self.models)}\n"
            for name, model in self.models.items():
                status += f"  ‚Ä¢ {name}: {type(model).__name__}\n"
        else:
            status += "ü§ñ –ú–æ–¥–µ–ª–µ–π –ø–æ–∫–∞ –Ω–µ—Ç\n"
        
        # –î–∞–Ω–Ω—ã–µ
        if self.data_storage:
            status += f"\nüìÅ –•—Ä–∞–Ω–∏–º—ã—Ö –Ω–∞–±–æ—Ä–æ–≤ –¥–∞–Ω–Ω—ã—Ö: {len(self.data_storage)}\n"
        
        # –ò—Å—Ç–æ—Ä–∏—è
        if self.history:
            status += f"\nüìù –ü–æ—Å–ª–µ–¥–Ω–∏–µ –∑–∞–ø—Ä–æ—Å—ã: {min(3, len(self.history))}\n"
            for timestamp, query in self.history[-3:]:
                time_str = timestamp.strftime("%H:%M")
                status += f"  [{time_str}] {query[:30]}...\n"
        
        # –ö–æ–Ω—Ç–µ–∫—Å—Ç
        if self.context:
            status += f"\nüé≠ –ö–æ–Ω—Ç–µ–∫—Å—Ç: {len(self.context)} –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö\n"
        
        status += f"\n‚è∞ –í—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã: {len(self.history)} –∑–∞–ø—Ä–æ—Å–æ–≤ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–æ"
        
        return status
    
    def clear_data(self, query: str) -> str:
        """–û—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö"""
        if '–≤—Å—ë' in query or 'all' in query:
            self.models.clear()
            self.data_storage.clear()
            self.context.clear()
            return "‚úÖ –í—Å–µ –¥–∞–Ω–Ω—ã–µ –æ—á–∏—â–µ–Ω—ã!"
        elif '–º–æ–¥–µ–ª–∏' in query:
            count = len(self.models)
            self.models.clear()
            return f"‚úÖ –£–¥–∞–ª–µ–Ω–æ {count} –º–æ–¥–µ–ª–µ–π"
        elif '–¥–∞–Ω–Ω—ã–µ' in query:
            count = len(self.data_storage)
            self.data_storage.clear()
            return f"‚úÖ –£–¥–∞–ª–µ–Ω–æ {count} –Ω–∞–±–æ—Ä–æ–≤ –¥–∞–Ω–Ω—ã—Ö"
        else:
            return "–ß—Ç–æ –∏–º–µ–Ω–Ω–æ –æ—á–∏—Å—Ç–∏—Ç—å? –£–∫–∞–∂–∏—Ç–µ: '–º–æ–¥–µ–ª–∏', '–¥–∞–Ω–Ω—ã–µ' –∏–ª–∏ '–≤—Å—ë'"
    
    def analyze_data(self, query: str) -> str:
        """–ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö"""
        if not self.data_storage:
            return "–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞. –°–Ω–∞—á–∞–ª–∞ —Å–æ–∑–¥–∞–π—Ç–µ –∏–ª–∏ –∑–∞–≥—Ä—É–∑–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ."
        
        analysis = "üìà –ê–ù–ê–õ–ò–ó –î–ê–ù–ù–´–•:\n\n"
        
        for name, data in self.data_storage.items():
            analysis += f"üìÅ {name}:\n"
            
            if 'X_sample' in data and data['X_sample']:
                X = data['X_sample']
                n_samples = len(X)
                n_features = len(X[0]) if X else 0
                
                analysis += f"  ‚Ä¢ –û–±—Ä–∞–∑—Ü–æ–≤: {n_samples}\n"
                analysis += f"  ‚Ä¢ –ü—Ä–∏–∑–Ω–∞–∫–æ–≤: {n_features}\n"
                
                if n_samples > 0 and n_features > 0:
                    # –°—Ä–µ–¥–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è
                    means = []
                    for i in range(min(3, n_features)):  # –ü–µ—Ä–≤—ã–µ 3 –ø—Ä–∏–∑–Ω–∞–∫–∞
                        col_vals = [x[i] for x in X if i < len(x)]
                        if col_vals:
                            means.append(f"{sum(col_vals)/len(col_vals):.2f}")
                    
                    if means:
                        analysis += f"  ‚Ä¢ –°—Ä–µ–¥–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è: {', '.join(means)}\n"
            
            if 'history' in data and data['history']:
                hist = data['history']
                if 'accuracy' in hist and hist['accuracy']:
                    last_acc = hist['accuracy'][-1]
                    analysis += f"  ‚Ä¢ –¢–æ—á–Ω–æ—Å—Ç—å –º–æ–¥–µ–ª–∏: {last_acc:.2%}\n"
            
            analysis += "\n"
        
        analysis += "üí° –°–æ–≤–µ—Ç: –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ '–æ–±—É—á–∏ –º–æ–¥–µ–ª—å' –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤"
        return analysis

# ========== –£–õ–£–ß–®–ï–ù–ù–´–ô –ò–ò –ê–°–°–ò–°–¢–ï–ù–¢ ==========

class EnhancedAIAssistant(AIAssistantCore):
    def __init__(self):
        super().__init__()
        self.sentiment_analyzer = self.SentimentAnalyzer()
        self.recommender = self.RecommenderSystem()
        self.translator = self.Translator()
        self.code_generator = self.CodeGenerator()
        
    class SentimentAnalyzer:
        """–ê–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞"""
        def __init__(self):
            self.positive_words = {"—Ö–æ—Ä–æ—à–æ", "–æ—Ç–ª–∏—á–Ω–æ", "–ø—Ä–µ–∫—Ä–∞—Å–Ω–æ", "–∑–∞–º–µ—á–∞—Ç–µ–ª—å–Ω–æ", "—Å—É–ø–µ—Ä", "–∫–ª–∞—Å—Å", "–ª—é–±–ª—é", "–Ω—Ä–∞–≤–∏—Ç—Å—è", "—É–¥–æ–±–Ω–æ", "–ª–µ–≥–∫–æ", "–ø–æ–Ω—è—Ç–Ω–æ"}
            self.negative_words = {"–ø–ª–æ—Ö–æ", "—É–∂–∞—Å–Ω–æ", "–æ—Ç–≤—Ä–∞—Ç–∏—Ç–µ–ª—å–Ω–æ", "–Ω–µ–Ω–∞–≤–∏–∂—É", "–Ω–µ—É–¥–æ–±–Ω–æ", "—Å–ª–æ–∂–Ω–æ", "–Ω–µ–ø–æ–Ω—è—Ç–Ω–æ", "—Ä–∞–∑–¥—Ä–∞–∂–∞–µ—Ç", "–æ—à–∏–±–∫–∞", "—Å–ª–æ–º–∞–ª–æ—Å—å"}
            
        def analyze(self, text):
            words = set(text.lower().split())
            positive_count = len(words & self.positive_words)
            negative_count = len(words & self.negative_words)
            
            if positive_count > negative_count:
                return "positive", positive_count/(positive_count+negative_count+0.001)
            elif negative_count > positive_count:
                return "negative", negative_count/(positive_count+negative_count+0.001)
            else:
                return "neutral", 0.5
                
    class RecommenderSystem:
        """–°–∏—Å—Ç–µ–º–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π"""
        def __init__(self):
            self.user_preferences = {}
            self.recommendation_history = []
            
        def get_recommendation(self, user_id, category="general"):
            recommendations = {
                "general": ["–ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é –≥–æ–ª–æ—Å–æ–≤–æ–≥–æ –ø–æ–∏—Å–∫–∞", "–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –≤–Ω–µ—à–Ω–∏–π –≤–∏–¥ –ø–æ–¥ —Å–µ–±—è", 
                           "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –±—ã—Å—Ç—Ä—ã–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ –≤—Ä–µ–º–µ–Ω–∏"],
                "ai": ["–û–±—É—á–∏—Ç–µ –Ω–µ–π—Ä–æ—Å–µ—Ç—å –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –¥–∞–Ω–Ω—ã—Ö", "–ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–¥–µ–ª–∞—Ç—å –ø—Ä–æ–≥–Ω–æ–∑", 
                      "–≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ —Ñ–∞–π–ª"],
                "media": ["–ù–∞—Å—Ç—Ä–æ–π—Ç–µ —Ä–∞–¥–∏–æ—Å—Ç–∞–Ω—Ü–∏–∏", "–°–æ–∑–¥–∞–π—Ç–µ –ø–ª–µ–π–ª–∏—Å—Ç", "–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≥–æ–ª–æ—Å–æ–≤–æ–π –ø–æ–∏—Å–∫ –≤–∏–¥–µ–æ"],
                "tools": ["–í–æ—Å–ø–æ–ª—å–∑—É–π—Ç–µ—Å—å –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–æ–º", "–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –±–ª–æ–∫–Ω–æ—Ç", "–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—é"]
            }
            return random.choice(recommendations.get(category, recommendations["general"]))
            
    class Translator:
        """–ü—Ä–æ—Å—Ç–æ–π –ø–µ—Ä–µ–≤–æ–¥—á–∏–∫"""
        def __init__(self):
            self.dictionary = {
                "hello": "–ø—Ä–∏–≤–µ—Ç",
                "thank you": "—Å–ø–∞—Å–∏–±–æ",
                "goodbye": "–¥–æ —Å–≤–∏–¥–∞–Ω–∏—è",
                "how are you": "–∫–∞–∫ –¥–µ–ª–∞",
                "i need help": "–º–Ω–µ –Ω—É–∂–Ω–∞ –ø–æ–º–æ—â—å",
                "search": "–ø–æ–∏—Å–∫",
                "weather": "–ø–æ–≥–æ–¥–∞",
                "time": "–≤—Ä–µ–º—è"
            }
            
        def translate(self, text, target_lang="ru"):
            # –ü—Ä–æ—Å—Ç–æ–π –ø–µ—Ä–µ–≤–æ–¥ –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏
            text_lower = text.lower()
            for eng, rus in self.dictionary.items():
                if eng in text_lower:
                    return text_lower.replace(eng, rus)
            return text
            
    class CodeGenerator:
        """–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –∫–æ–¥–∞"""
        def __init__(self):
            self.templates = {
                "python_function": "def {function_name}({params}):\n    \"\"\"{docstring}\"\"\"\n    {body}\n    return {return_value}",
                "html_page": "<!DOCTYPE html>\n<html>\n<head>\n    <title>{title}</title>\n</head>\n<body>\n    <h1>{heading}</h1>\n    {content}\n</body>\n</html>",
                "sql_query": "SELECT {columns}\nFROM {table}\nWHERE {conditions};"
            }
            
        def generate(self, code_type, **kwargs):
            template = self.templates.get(code_type, "")
            return template.format(**kwargs)
    
    def enhanced_process_query(self, query: str) -> str:
        """–£–ª—É—á—à–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–ø—Ä–æ—Å–æ–≤"""
        # –ê–Ω–∞–ª–∏–∑ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è
        sentiment, score = self.sentiment_analyzer.analyze(query)
        
        # –î–æ–±–∞–≤–ª—è–µ–º –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
        if any(word in query.lower() for word in ['–∞–Ω–∞–ª–∏–∑ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è', '–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ', '—ç–º–æ—Ü–∏–∏']):
            return f"–ù–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞: {sentiment} (—É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å: {score:.2%})"
        
        elif any(word in query.lower() for word in ['—Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è', '—Å–æ–≤–µ—Ç', '–ø–æ—Å–æ–≤–µ—Ç—É–π']):
            category = "general"
            if '–∏–∏' in query.lower():
                category = "ai"
            elif '–º–µ–¥–∏–∞' in query.lower():
                category = "media"
            elif '–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç' in query.lower():
                category = "tools"
            return f"–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è: {self.recommender.get_recommendation('user', category)}"
        
        elif any(word in query.lower() for word in ['–ø–µ—Ä–µ–≤–µ–¥–∏', 'translation', 'translat']):
            text = query.lower().replace('–ø–µ—Ä–µ–≤–µ–¥–∏', '').replace('translation', '').replace('translat', '').strip()
            if text:
                translated = self.translator.translate(text)
                return f"–ü–µ—Ä–µ–≤–æ–¥: {translated}"
        
        elif any(word in query.lower() for word in ['—Å–≥–µ–Ω–µ—Ä–∏—Ä—É–π –∫–æ–¥', '–∫–æ–¥', '–ø—Ä–æ–≥—Ä–∞–º–º—É']):
            return self.generate_code_from_query(query)
        
        # –í—ã–∑–æ–≤ —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏
        response = super().process_query(query)
        
        # –î–æ–±–∞–≤–ª—è–µ–º —ç–º–æ—Ü–∏–æ–Ω–∞–ª—å–Ω—É—é –æ–∫—Ä–∞—Å–∫—É
        if sentiment == "positive":
            return f"üòä –°–ø–∞—Å–∏–±–æ –∑–∞ –ø–æ–∑–∏—Ç–∏–≤–Ω—ã–π –∑–∞–ø—Ä–æ—Å! {response}"
        elif sentiment == "negative":
            return f"üòî –ü–æ–Ω–∏–º–∞—é –≤–∞—à–µ —Ä–∞–∑–æ—á–∞—Ä–æ–≤–∞–Ω–∏–µ. {response}"
        else:
            return response
    
    def generate_code_from_query(self, query):
        """–ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–æ–¥–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ –∑–∞–ø—Ä–æ—Å–∞"""
        query_lower = query.lower()
        
        if any(word in query_lower for word in ['—Ñ—É–Ω–∫—Ü–∏—è', 'function']):
            return self.code_generator.generate(
                "python_function",
                function_name="example_function",
                params="param1, param2",
                docstring="–ü—Ä–∏–º–µ—Ä —Ñ—É–Ω–∫—Ü–∏–∏",
                body="# –í–∞—à –∫–æ–¥ –∑–¥–µ—Å—å",
                return_value="result"
            )
        
        elif any(word in query_lower for word in ['html', '—Å—Ç—Ä–∞–Ω–∏—Ü–∞', '–≤–µ–±']):
            return self.code_generator.generate(
                "html_page",
                title="–ü—Ä–∏–º–µ—Ä —Å—Ç—Ä–∞–Ω–∏—Ü—ã",
                heading="–ó–∞–≥–æ–ª–æ–≤–æ–∫",
                content="<p>–°–æ–¥–µ—Ä–∂–∏–º–æ–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã</p>"
            )
        
        elif any(word in query_lower for word in ['sql', '–∑–∞–ø—Ä–æ—Å', '–±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö']):
            return self.code_generator.generate(
                "sql_query",
                columns="*",
                table="users",
                conditions="age > 18"
            )
        
        return "–ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞ Python:\n\ndef hello_world():\n    print('Hello, World!')\n\nhello_world()"

# ========== –ì–†–ê–§–ò–ß–ï–°–ö–ò–ô –ò–ù–¢–ï–†–§–ï–ô–° ==========

class ModernButton(tk.Canvas):
    """–°–æ–≤—Ä–µ–º–µ–Ω–Ω–∞—è –∫–Ω–æ–ø–∫–∞ —Å –≥—Ä–∞–¥–∏–µ–Ω—Ç–∞–º–∏ –∏ —ç—Ñ—Ñ–µ–∫—Ç–∞–º–∏"""
    
    def __init__(self, parent, text="", command=None, width=120, height=40, 
                 bg_color="#3498db", hover_color="#2980b9", text_color="white",
                 radius=10, font_size=11, icon=None):
        super().__init__(parent, width=width, height=height, 
                        highlightthickness=0, bg=parent.cget("bg"))
        self.parent = parent
        self.text = text
        self.command = command
        self.width = width
        self.height = height
        self.bg_color = bg_color
        self.hover_color = hover_color
        self.text_color = text_color
        self.radius = radius
        self.font_size = font_size
        self.icon = icon
        self.is_hovered = False
        self.is_pressed = False
        
        self.bind("<Enter>", self.on_enter)
        self.bind("<Leave>", self.on_leave)
        self.bind("<Button-1>", self.on_press)
        self.bind("<ButtonRelease-1>", self.on_release)
        
        self.draw_button()
    
    def draw_button(self):
        self.delete("all")
        
        # –¶–≤–µ—Ç —Ñ–æ–Ω–∞
        color = self.hover_color if self.is_hovered else self.bg_color
        
        # –°–æ–∑–¥–∞–µ–º –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π —Ñ–æ–Ω
        for i in range(self.height):
            ratio = i / self.height
            r = int(int(color[1:3], 16) * (1 - ratio * 0.3))
            g = int(int(color[3:5], 16) * (1 - ratio * 0.3))
            b = int(int(color[5:7], 16) * (1 - ratio * 0.3))
            grad_color = f'#{r:02x}{g:02x}{b:02x}'
            
            if self.radius > 0:
                # –î–ª—è –∑–∞–∫—Ä—É–≥–ª–µ–Ω–Ω—ã—Ö —É–≥–ª–æ–≤
                if i < self.radius or i > self.height - self.radius:
                    continue
                self.create_line(0, i, self.width, i, fill=grad_color, width=1)
            else:
                self.create_line(0, i, self.width, i, fill=grad_color, width=1)
        
        # –û—Å–Ω–æ–≤–Ω–æ–π –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫
        if self.radius > 0:
            self.create_rounded_rect(0, 0, self.width-1, self.height-1, 
                                    self.radius, fill=color, outline="")
        else:
            self.create_rectangle(0, 0, self.width-1, self.height-1, 
                                 fill=color, outline="")
        
        # –î–æ–±–∞–≤–ª—è–µ–º –∏–∫–æ–Ω–∫—É –µ—Å–ª–∏ –µ—Å—Ç—å
        text_x = self.width // 2
        if self.icon:
            icon_text = self.icon + " "
            self.create_text(text_x - 10, self.height//2, 
                           text=icon_text, fill=self.text_color,
                           font=("Segoe UI Emoji", self.font_size), anchor="e")
            text_x += 15
        
        # –¢–µ–∫—Å—Ç –∫–Ω–æ–ø–∫–∏
        self.create_text(text_x, self.height//2, 
                        text=self.text, fill=self.text_color,
                        font=("Segoe UI", self.font_size, "bold"),
                        anchor="center")
        
        # –≠—Ñ—Ñ–µ–∫—Ç –Ω–∞–∂–∞—Ç–∏—è
        if self.is_pressed:
            press_effect = "#ffffff40"
            if self.radius > 0:
                self.create_rounded_rect(0, 0, self.width-1, self.height-1, 
                                        self.radius, fill=press_effect, outline="")
            else:
                self.create_rectangle(0, 0, self.width-1, self.height-1, 
                                     fill=press_effect, outline="")
    
    def create_rounded_rect(self, x1, y1, x2, y2, radius, **kwargs):
        """–°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä—è–º–æ—É–≥–æ–ª—å–Ω–∏–∫–∞ —Å –∑–∞–∫—Ä—É–≥–ª–µ–Ω–Ω—ã–º–∏ —É–≥–ª–∞–º–∏"""
        points = [
            x1 + radius, y1,
            x2 - radius, y1,
            x2, y1,
            x2, y1 + radius,
            x2, y2 - radius,
            x2, y2,
            x2 - radius, y2,
            x1 + radius, y2,
            x1, y2,
            x1, y2 - radius,
            x1, y1 + radius,
            x1, y1
        ]
        return self.create_polygon(points, smooth=True, **kwargs)
    
    def on_enter(self, event):
        self.is_hovered = True
        self.draw_button()
    
    def on_leave(self, event):
        self.is_hovered = False
        self.is_pressed = False
        self.draw_button()
    
    def on_press(self, event):
        self.is_pressed = True
        self.draw_button()
    
    def on_release(self, event):
        self.is_pressed = False
        self.draw_button()
        if self.command:
            self.command()

class TextAnimation:
    """–ö–ª–∞—Å—Å –¥–ª—è –ø–æ–∫–∞–∑–∞ –∞–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –ø–µ—Ä–µ—Ö–æ–¥–æ–≤"""
    
    def __init__(self, root):
        self.root = root
        self.animation_window = None
        self.playing = False
        
    def show_transition(self, title="–ü–µ—Ä–µ—Ö–æ–¥", duration=3):
        """–ü–æ–∫–∞–∑–∞—Ç—å —Ç–µ–∫—Å—Ç–æ–≤—ã–π –ø–µ—Ä–µ—Ö–æ–¥ —Å —Å–æ–≤—Ä–µ–º–µ–Ω–Ω–æ–π –∞–Ω–∏–º–∞—Ü–∏–µ–π"""
        try:
            # –°–æ–∑–¥–∞–µ–º –æ–∫–Ω–æ –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏
            self.animation_window = tk.Toplevel(self.root)
            self.animation_window.title(title)
            self.animation_window.geometry("800x600")
            self.animation_window.configure(bg="#0f172a")
            self.animation_window.overrideredirect(True)  # –ë–µ–∑ —Ä–∞–º–∫–∏
            
            # –¶–µ–Ω—Ç—Ä–∏—Ä—É–µ–º –æ–∫–Ω–æ
            self.center_window(self.animation_window)
            
            # Canvas –¥–ª—è –∞–Ω–∏–º–∞—Ü–∏–∏
            self.canvas = tk.Canvas(self.animation_window, bg="#0f172a", highlightthickness=0)
            self.canvas.pack(fill=tk.BOTH, expand=True)
            
            # –ß–∞—Å—Ç–∏—Ü—ã –¥–ª—è —Ñ–æ–Ω–∞
            self.particles = []
            for _ in range(50):
                x = random.randint(0, 800)
                y = random.randint(0, 600)
                size = random.randint(1, 3)
                speed = random.uniform(0.5, 2)
                color = random.choice(['#3b82f6', '#8b5cf6', '#10b981', '#f59e0b'])
                particle = self.canvas.create_oval(x, y, x+size, y+size, fill=color, outline="")
                self.particles.append((particle, speed))
            
            # –ê–Ω–∏–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∑–∞–≥–æ–ª–æ–≤–æ–∫
            self.title_text = self.canvas.create_text(
                400, 200,
                text="‚öõÔ∏è",
                fill="#60a5fa",
                font=('Segoe UI', 120, 'bold'),
                state='hidden'
            )
            
            # –ü–æ–¥–∑–∞–≥–æ–ª–æ–≤–æ–∫
            self.subtitle_text = self.canvas.create_text(
                400, 300,
                text=title,
                fill="#ffffff",
                font=('Segoe UI', 36, 'bold'),
                state='hidden'
            )
            
            # –ü—Ä–æ–≥—Ä–µ—Å—Å –±–∞—Ä
            self.progress_bg = self.canvas.create_rectangle(
                200, 450, 600, 470,
                fill="#1e293b",
                outline="",
                state='hidden'
            )
            
            self.progress_fill = self.canvas.create_rectangle(
                200, 450, 200, 470,
                fill="#3b82f6",
                outline="",
                state='hidden'
            )
            
            # –ó–∞–ø—É—Å–∫–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏–∏
            self.animate_particles()
            self.animate_title()
            
            # –ó–∞–∫—Ä—ã–≤–∞–µ–º –æ–∫–Ω–æ —á–µ—Ä–µ–∑ —É–∫–∞–∑–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è
            self.animation_window.after(duration * 1000, self.close_transition)
            
            self.playing = True
            
        except Exception as e:
            print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–∫–∞–∑–µ –∞–Ω–∏–º–∞—Ü–∏–∏: {e}")
            self.close_transition()
    
    def center_window(self, window):
        """–¶–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–∫–Ω–∞ –Ω–∞ —ç–∫—Ä–∞–Ω–µ"""
        window.update_idletasks()
        width = window.winfo_width()
        height = window.winfo_height()
        x = (window.winfo_screenwidth() // 2) - (width // 2)
        y = (window.winfo_screenheight() // 2) - (height // 2)
        window.geometry(f'{width}x{height}+{x}+{y}')
    
    def animate_particles(self):
        """–ê–Ω–∏–º–∞—Ü–∏—è —á–∞—Å—Ç–∏—Ü –Ω–∞ —Ñ–æ–Ω–µ"""
        if not self.playing or not self.animation_window:
            return
            
        for particle_id, speed in self.particles:
            try:
                coords = self.canvas.coords(particle_id)
                if coords[1] > 600:
                    self.canvas.move(particle_id, 0, -650)
                else:
                    self.canvas.move(particle_id, 0, speed)
            except:
                pass
        
        if self.playing:
            self.animation_window.after(30, self.animate_particles)
    
    def animate_title(self):
        """–ê–Ω–∏–º–∞—Ü–∏—è –ø–æ—è–≤–ª–µ–Ω–∏—è –∑–∞–≥–æ–ª–æ–≤–∫–∞"""
        if not self.playing or not self.animation_window:
            return
            
        try:
            # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã
            self.canvas.itemconfig(self.title_text, state='normal')
            self.animation_window.after(500, lambda: self.canvas.itemconfig(self.subtitle_text, state='normal'))
            self.animation_window.after(1000, lambda: self.canvas.itemconfig(self.progress_bg, state='normal'))
            self.animation_window.after(1000, lambda: self.canvas.itemconfig(self.progress_fill, state='normal'))
            
            # –ê–Ω–∏–º–∞—Ü–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å –±–∞—Ä–∞
            self.animate_progress(200, 0)
            
            # –ê–Ω–∏–º–∞—Ü–∏—è –ø—É–ª—å—Å–∞—Ü–∏–∏ —ç–º–æ–¥–∑–∏
            self.pulse_emoji(0)
            
        except:
            pass
    
    def animate_progress(self, x, step):
        """–ê–Ω–∏–º–∞—Ü–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å –±–∞—Ä–∞"""
        if not self.playing or not self.animation_window:
            return
            
        if x < 600:
            self.canvas.coords(self.progress_fill, 200, 450, x, 470)
            self.animation_window.after(20, lambda: self.animate_progress(x + 8, step + 1))
    
    def pulse_emoji(self, step):
        """–ü—É–ª—å—Å–∞—Ü–∏—è —ç–º–æ–¥–∑–∏"""
        if not self.playing or not self.animation_window:
            return
            
        try:
            size = 120 + 10 * math.sin(step * 0.2)
            self.canvas.itemconfig(self.title_text, font=('Segoe UI', int(size), 'bold'))
            
            # –ú–µ–Ω—è–µ–º —Ü–≤–µ—Ç
            colors = ['#60a5fa', '#8b5cf6', '#10b981', '#f59e0b']
            color = colors[step % len(colors)]
            self.canvas.itemconfig(self.title_text, fill=color)
            
            if self.playing:
                self.animation_window.after(100, lambda: self.pulse_emoji(step + 1))
        except:
            pass
    
    def close_transition(self):
        """–ó–∞–∫—Ä—ã—Ç—å –∞–Ω–∏–º–∞—Ü–∏—é"""
        self.playing = False
        if self.animation_window and self.animation_window.winfo_exists():
            try:
                self.animation_window.destroy()
            except:
                pass
        self.animation_window = None

class ParticleSystem:
    """–°–∏—Å—Ç–µ–º–∞ —á–∞—Å—Ç–∏—Ü –¥–ª—è —Ñ–æ–Ω–∞"""
    def __init__(self, canvas, width, height, particle_count=100):
        self.canvas = canvas
        self.width = width
        self.height = height
        self.particles = []
        self.colors = ['#3b82f6', '#8b5cf6', '#10b981', '#f59e0b', '#ef4444']
        
        for _ in range(particle_count):
            self.create_particle()
    
    def create_particle(self):
        x = random.randint(0, self.width)
        y = random.randint(0, self.height)
        size = random.randint(1, 4)
        speed = random.uniform(0.2, 1.5)
        color = random.choice(self.colors)
        direction = random.choice([-1, 1])
        
        particle = self.canvas.create_oval(
            x, y, x + size, y + size,
            fill=color, outline="", tags="particle"
        )
        
        self.particles.append({
            'id': particle,
            'x': x, 'y': y,
            'size': size,
            'speed': speed,
            'direction': direction
        })
    
    def update(self):
        for particle in self.particles:
            # –î–≤–∏–∂–µ–Ω–∏–µ
            particle['x'] += particle['speed'] * particle['direction']
            particle['y'] += particle['speed'] * 0.5
            
            # –û—Ç—Å–∫–æ–∫ –æ—Ç –≥—Ä–∞–Ω–∏—Ü
            if particle['x'] > self.width or particle['x'] < 0:
                particle['direction'] *= -1
            
            if particle['y'] > self.height:
                particle['y'] = -particle['size']
            
            # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–∏
            self.canvas.coords(
                particle['id'],
                particle['x'], particle['y'],
                particle['x'] + particle['size'], 
                particle['y'] + particle['size']
            )

class TypewriterLabel:
    """–¢–µ–∫—Å—Ç —Å —ç—Ñ—Ñ–µ–∫—Ç–æ–º –ø–µ—á–∞—Ç–Ω–æ–π –º–∞—à–∏–Ω–∫–∏"""
    def __init__(self, parent, text, **kwargs):
        self.parent = parent
        self.full_text = text
        self.current_text = ""
        self.index = 0
        self.speed = kwargs.pop('speed', 50)
        self.on_complete = kwargs.pop('on_complete', None)
        
        self.label = tk.Label(parent, **kwargs)
        self.label.pack()
        
    def start(self):
        self.type_next_char()
    
    def type_next_char(self):
        if self.index < len(self.full_text):
            self.current_text += self.full_text[self.index]
            self.label.config(text=self.current_text)
            self.index += 1
            self.parent.after(self.speed, self.type_next_char)
        elif self.on_complete:
            self.on_complete()

# ========== –û–°–ù–û–í–ù–û–ô –ö–õ–ê–°–° –ü–†–ò–õ–û–ñ–ï–ù–ò–Ø ==========

class EnhancedVoiceAssistantGUI:
    def __init__(self, root):
        self.root = root
        self.root.title("–ê—Ç–æ–º v4.0 PRO")
        self.root.geometry("1200x800")
        self.root.configure(bg="#0f172a")
        
        # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —É–ª—É—á—à–µ–Ω–Ω–æ–≥–æ –ò–ò-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞
        self.ai_assistant = EnhancedAIAssistant()
        
        # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–µ—Ç–æ–¥–æ–≤ –≥–æ–ª–æ—Å–æ–≤–æ–≥–æ –≤–≤–æ–¥–∞
        self.voice_methods = VOICE_METHODS
        self.voice_input_method = VOICE_INPUT_METHOD
        
        # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∏–∫–æ–Ω–∫—É –æ–∫–Ω–∞
        try:
            self.root.iconbitmap('atom_icon.ico')
        except:
            pass
        
        # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä –æ–∫–Ω–∞
        self.root.minsize(1000, 700)
        
        # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ–∫—Å—Ç–æ–≤–æ–π –∞–Ω–∏–º–∞—Ü–∏–∏
        self.text_anim = TextAnimation(root)
        
        # –§–ª–∞–≥ –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è —Ä–∞–±–æ—Ç—ã —Ñ–æ–Ω–æ–≤—ã—Ö –∑–∞–¥–∞—á
        self.running = True
        self.after_ids = []  # –°–ø–∏—Å–æ–∫ ID –∑–∞–¥–∞—á after
        
        # –§–ª–∞–≥–∏ –¥–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –ø–æ —Ñ—Ä–∞–∑–µ
        self.voice_wake_word = "–∞—Ç–æ–º"
        self.wake_word_detection = False  # –§–ª–∞–≥ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∫–ª—é—á–µ–≤–æ–≥–æ —Å–ª–æ–≤–∞
        self.background_listening = False  # –§–æ–Ω–æ–≤–∞—è –∞–∫—Ç–∏–≤–∞—Ü–∏—è
        self.last_wake_time = 0  # –í—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–π –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ (–¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –¥–≤–æ–π–Ω—ã—Ö —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏–π)
        self.activation_phrases = ["–∞—Ç–æ–º", "–∞—Ç–æ", "—Ç–æ–º", "–∞—Ç–∞", "–∞—Ç–æ–º–µ", "–∞—Ç–æ–º–∞", "–∞–¥–æ–Ω", "–∞—Ç–æ–Ω"]  # –í–∞—Ä–∏–∞–Ω—Ç—ã –∫–ª—é—á–µ–≤–æ–≥–æ —Å–ª–æ–≤–∞
        
        # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≥–æ–ª–æ—Å–æ–≤–æ–≥–æ –¥–≤–∏–∂–∫–∞ –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω
        self.speech_engine = None
        self.recognizer = None
        self.speech_queue = queue.Queue()  # –û—á–µ—Ä–µ–¥—å –¥–ª—è —Å–∏–Ω—Ç–µ–∑–∞ —Ä–µ—á–∏
        self.speech_thread = None
        self.speech_processing = False
        
        # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≥–æ–ª–æ—Å–æ–≤—ã—Ö –¥–≤–∏–∂–∫–æ–≤ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏
        if SPEECH_AVAILABLE:
            try:
                self.speech_engine = pyttsx3.init()
                # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –≥–æ–ª–æ—Å–∞
                voices = self.speech_engine.getProperty('voices')
                # –ü—ã—Ç–∞–µ–º—Å—è –Ω–∞–π—Ç–∏ —Ä—É—Å—Å–∫–∏–π –≥–æ–ª–æ—Å
                for voice in voices:
                    if 'russian' in voice.name.lower() or 'russian' in voice.id.lower():
                        self.speech_engine.setProperty('voice', voice.id)
                        break
                # –°–∫–æ—Ä–æ—Å—Ç—å —Ä–µ—á–∏
                self.speech_engine.setProperty('rate', 150)
                # –ì—Ä–æ–º–∫–æ—Å—Ç—å
                self.speech_engine.setProperty('volume', 0.9)
                
                self.recognizer = sr.Recognizer()
                # –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è –ª—É—á—à–µ–≥–æ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è
                self.recognizer.energy_threshold = 200
                self.recognizer.dynamic_energy_threshold = True
                self.recognizer.dynamic_energy_adjustment_damping = 0.15
                self.recognizer.dynamic_energy_ratio = 1.5
                self.recognizer.pause_threshold = 0.8
                
                # –ó–∞–ø—É—Å–∫–∞–µ–º –ø–æ—Ç–æ–∫ –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ä–µ—á–∏
                self.start_speech_processor()
                
            except Exception as e:
                print(f"–û—à–∏–±–∫–∞ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –≥–æ–ª–æ—Å–æ–≤–æ–≥–æ –¥–≤–∏–∂–∫–∞: {e}")
        elif self.voice_input_method == 'windows_sapi':
            # –ü—ã—Ç–∞–µ–º—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å Windows SAPI
            try:
                import win32com.client
                self.speech_engine_win = win32com.client.Dispatch("SAPI.SpVoice")
                print("–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è Windows SAPI –¥–ª—è —Å–∏–Ω—Ç–µ–∑–∞ —Ä–µ—á–∏")
            except Exception as e:
                print(f"–ù–µ —É–¥–∞–ª–æ—Å—å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å Windows SAPI: {e}")
        
        # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫ –î–û –∏—Ö –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
        self.settings = {}
        
        # –û—á–µ—Ä–µ–¥—å –¥–ª—è —Å–æ–æ–±—â–µ–Ω–∏–π
        self.message_queue = queue.Queue()
        
        # –§–ª–∞–≥–∏
        self.demo_mode = None  # –ë—É–¥–µ—Ç –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–æ –ø—Ä–∏ –≤—ã–±–æ—Ä–µ
        self.listening = False
        self.video_playing = False
        self.logged_in = False  # –§–ª–∞–≥ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
        self.current_user = None  # –¢–µ–∫—É—â–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
        self.voice_assistant_active = False  # –§–ª–∞–≥ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –≥–æ–ª–æ—Å–æ–≤–æ–≥–æ –ø–æ–º–æ—â–Ω–∏–∫–∞
        
        # –ù–æ–≤—ã–µ –∞—Ç—Ä–∏–±—É—Ç—ã –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏
        self.automation_tasks = []
        self.screenshots = []
        self.clipboard_history = []
        self.gesture_recognition = False
        
        # –ù–∞—Å—Ç—Ä–æ–π–∫–∏
        self.settings_file = "atom_settings.json"
        self.users_file = "atom_users.json"
        self.default_settings = {
            "search_engine": "https://www.google.com/search?q=",
            "search_engines": {
                "Google": "https://www.google.com/search?q=",
                "–Ø–Ω–¥–µ–∫—Å": "https://yandex.ru/search/?text=",
                "DuckDuckGo": "https://duckduckgo.com/?q=",
                "Bing": "https://www.bing.com/search?q=",
                "DeepSeek": "https://www.deepseek.com/"
            },
            "social_networks": {
                "–í–ö–æ–Ω—Ç–∞–∫—Ç–µ": "https://vk.com",
                "–û–¥–Ω–æ–∫–ª–∞—Å—Å–Ω–∏–∫–∏": "https://ok.ru",
                "Telegram": "https://web.telegram.org",
                "WhatsApp Web": "https://web.whatsapp.com",
                "Discord": "https://discord.com/app",
                "Twitter": "https://twitter.com",
                "Facebook": "https://facebook.com",
                "Instagram": "https://instagram.com",
                "YouTube": "https://youtube.com",
                "Twitch": "https://twitch.tv",
                "DeepSeek AI": "https://chat.deepseek.com/"
            },
            "theme": "dark",
            "theme_color": "#3b82f6",
            "auto_start": True,
            "notifications": True,
            "demo_mode": True,
            "history_limit": 100,
            "weather_city": "–ú–æ—Å–∫–≤–∞",
            "video_player": "browser",
            "voice_enabled": True,  # –ì–æ–ª–æ—Å–æ–≤–æ–π –ø–æ–º–æ—â–Ω–∏–∫ –≤–∫–ª—é—á–µ–Ω
            "voice_feedback": True,  # –û–∑–≤—É—á–∫–∞ –≤—Å–µ—Ö –¥–µ–π—Å—Ç–≤–∏–π
            "voice_language": "ru-RU",  # –Ø–∑—ã–∫ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è
            "voice_speed": 150,  # –°–∫–æ—Ä–æ—Å—Ç—å —Ä–µ—á–∏
            "voice_volume": 0.9,  # –ì—Ä–æ–º–∫–æ—Å—Ç—å
            "default_browser": "default",  # –ë—Ä–∞—É–∑–µ—Ä –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
            "browsers": {
                "–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é": "default",
                "Chrome": "chrome",
                "Firefox": "firefox",
                "Edge": "msedge",
                "Opera": "opera"
            },
            "font_size": "normal",
            "animations": True,
            "wake_word": "–∞—Ç–æ–º",  # –ö–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ –¥–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏
            "wake_word_sensitivity": 0.3,
            "wake_word_variants": ["–∞—Ç–æ–º", "–∞—Ç–æ", "—Ç–æ–º", "–∞—Ç–∞", "–∞—Ç–æ–º–µ", "–∞—Ç–æ–º–∞", "–∞–¥–æ–Ω", "–∞—Ç–æ–Ω"]
        }
        
        # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∑–Ω–∞—á–µ–Ω–∏—è–º–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
        self.settings = self.default_settings.copy()
        
        # –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
        self.users = {}
        self.load_users()
        
        # –ó–∞–≥—Ä—É–∂–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
        self.load_settings()
        
        # –û–±–Ω–æ–≤–ª—è–µ–º –∫–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ –∏–∑ –Ω–∞—Å—Ç—Ä–æ–µ–∫
        self.voice_wake_word = self.settings.get("wake_word", "–∞—Ç–æ–º")
        self.wake_sensitivity = self.settings.get("wake_word_sensitivity", 0.3)
        self.activation_phrases = self.settings.get("wake_word_variants", ["–∞—Ç–æ–º", "–∞—Ç–æ", "—Ç–æ–º", "–∞—Ç–∞", "–∞—Ç–æ–º–µ", "–∞—Ç–æ–º–∞", "–∞–¥–æ–Ω", "–∞—Ç–æ–Ω"])
        
        # –°–Ω–∞—á–∞–ª–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –æ–∫–Ω–æ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
        self.show_auth_window()
    
    # ========== –ù–û–í–´–ï –ú–ï–¢–û–î–´ –î–õ–Ø –ì–û–õ–û–°–û–í–û–ì–û –í–í–û–î–ê –ë–ï–ó –ë–ò–ë–õ–ò–û–¢–ï–ö ==========
    
    def listen_without_speech_recognition(self, timeout=5):
        """
        –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –º–µ—Ç–æ–¥ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è —Ä–µ—á–∏ –±–µ–∑ speech_recognition
        –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã–µ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏
        """
        if not VOICE_INPUT_AVAILABLE:
            return None, 0.0
        
        try:
            if self.voice_input_method == 'speech_recognition' and SPEECH_AVAILABLE:
                # –ò—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –º–µ—Ç–æ–¥ –µ—Å–ª–∏ speech_recognition –¥–æ—Å—Ç—É–ø–µ–Ω
                return self.listen_with_speech_recognition(timeout)
            elif self.voice_input_method == 'windows_sapi':
                return self.listen_with_windows_sapi(timeout)
            else:
                return self.listen_with_simple_dialog(timeout)
        except Exception as e:
            print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–∏ —Ä–µ—á–∏: {e}")
            return None, 0.0
    
    def listen_with_speech_recognition(self, timeout):
        """–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ speech_recognition –µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω"""
        try:
            with sr.Microphone() as source:
                self.recognizer.adjust_for_ambient_noise(source, duration=0.5)
                audio = self.recognizer.listen(source, timeout=timeout, phrase_time_limit=4)
                
            text = self.recognizer.recognize_google(audio, language='ru-RU')
            return text, 0.8
        except sr.WaitTimeoutError:
            return None, 0.0
        except sr.UnknownValueError:
            return None, 0.0
        except Exception as e:
            print(f"–û—à–∏–±–∫–∞ speech_recognition: {e}")
            return None, 0.0
    
    def listen_with_windows_sapi(self, timeout):
        """
        –†–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ —Ä–µ—á–∏ —Å –ø–æ–º–æ—â—å—é Windows Speech API
        –¢—Ä–µ–±—É–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è —Ä–µ—á–∏ –≤ Windows
        """
        try:
            # –î–ª—è Windows SAPI –Ω—É–∂–Ω–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–∏—Å—Ç–µ–º—ã
            # –í–æ–∑–≤—Ä–∞—â–∞–µ–º —É–ø—Ä–æ—â–µ–Ω–Ω—ã–π –¥–∏–∞–ª–æ–≥
            return self.listen_with_simple_dialog(timeout)
        except Exception as e:
            print(f"–û—à–∏–±–∫–∞ Windows SAPI: {e}")
            return self.listen_with_simple_dialog(timeout)
    
    def listen_with_simple_dialog(self, timeout):
        """
        –ü—Ä–æ—Å—Ç–æ–π fallback –º–µ—Ç–æ–¥ - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –¥–∏–∞–ª–æ–≥ –¥–ª—è —Ä—É—á–Ω–æ–≥–æ –≤–≤–æ–¥–∞
        """
        try:
            dialog = tk.Toplevel(self.root)
            dialog.title("–ì–æ–ª–æ—Å–æ–≤–æ–π –≤–≤–æ–¥")
            dialog.geometry("400x250")
            dialog.configure(bg=self.colors['bg'])
            dialog.resizable(False, False)
            dialog.transient(self.root)
            dialog.grab_set()
            
            # –¶–µ–Ω—Ç—Ä–∏—Ä—É–µ–º –¥–∏–∞–ª–æ–≥
            dialog.update_idletasks()
            x = self.root.winfo_x() + (self.root.winfo_width() // 2) - (400 // 2)
            y = self.root.winfo_y() + (self.root.winfo_height() // 2) - (250 // 2)
            dialog.geometry(f"400x250+{x}+{y}")
            
            # –ó–∞–≥–æ–ª–æ–≤–æ–∫
            label = tk.Label(dialog, text="üó£Ô∏è –ì–æ–ª–æ—Å–æ–≤–æ–π –≤–≤–æ–¥", 
                           bg=self.colors['bg'], fg=self.colors['primary_light'],
                           font=('Segoe UI', 16, 'bold'))
            label.pack(pady=20)
            
            # –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è
            instruction = tk.Label(dialog, 
                                 text="–ü—Ä–æ–∏–∑–Ω–µ—Å–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É, –∑–∞—Ç–µ–º –≤–≤–µ–¥–∏—Ç–µ –µ—ë –Ω–∏–∂–µ:",
                                 bg=self.colors['bg'], fg=self.colors['text'],
                                 font=('Segoe UI', 11))
            instruction.pack(pady=10)
            
            # –ü–æ–ª–µ –≤–≤–æ–¥–∞
            result_var = tk.StringVar()
            entry = tk.Entry(dialog, textvariable=result_var,
                           font=('Segoe UI', 12), width=40,
                           bg=self.colors['bg_lighter'], fg=self.colors['text'])
            entry.pack(pady=10, padx=20)
            entry.focus_set()
            
            result_text = None
            confidence = 0.7
            
            def on_ok():
                nonlocal result_text
                result_text = result_var.get().strip()
                dialog.destroy()
            
            def on_cancel():
                nonlocal result_text
                result_text = None
                dialog.destroy()
            
            # –ö–Ω–æ–ø–∫–∏
            button_frame = tk.Frame(dialog, bg=self.colors['bg'])
            button_frame.pack(pady=20)
            
            ok_btn = tk.Button(button_frame, text="‚úÖ –ü—Ä–∏–Ω—è—Ç—å", 
                             bg=self.colors['success'], fg='white',
                             font=('Segoe UI', 10, 'bold'), 
                             padx=20, pady=8, command=on_ok)
            ok_btn.pack(side=tk.LEFT, padx=10)
            
            cancel_btn = tk.Button(button_frame, text="‚ùå –û—Ç–º–µ–Ω–∞",
                                 bg=self.colors['danger'], fg='white',
                                 font=('Segoe UI', 10),
                                 padx=20, pady=8, command=on_cancel)
            cancel_btn.pack(side=tk.LEFT, padx=10)
            
            # –û–±—Ä–∞–±–æ—Ç–∫–∞ Enter –∏ Escape
            entry.bind('<Return>', lambda e: on_ok())
            dialog.bind('<Escape>', lambda e: on_cancel())
            
            # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–∞–π–º–∞—É—Ç
            def close_after_timeout():
                if dialog.winfo_exists():
                    on_cancel()
            
            dialog.after(timeout * 1000, close_after_timeout)
            
            # –ñ–¥–µ–º –∑–∞–∫—Ä—ã—Ç–∏—è –¥–∏–∞–ª–æ–≥–∞
            self.root.wait_window(dialog)
            
            return result_text, confidence if result_text else 0.0
            
        except Exception as e:
            print(f"–û—à–∏–±–∫–∞ simple_dialog –º–µ—Ç–æ–¥–∞: {e}")
            return None, 0.0
    
    def improved_background_listening_no_libs(self):
        """
        –£–ª—É—á—à–µ–Ω–Ω–æ–µ —Ñ–æ–Ω–æ–≤–æ–µ –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏–µ –±–µ–∑ –≤–Ω–µ—à–Ω–∏—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫
        """
        if not self.background_listening or not self.running:
            return
        
        def simple_listener():
            print("–§–æ–Ω–æ–≤–æ–µ –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏–µ –∑–∞–ø—É—â–µ–Ω–æ (—É–ø—Ä–æ—â–µ–Ω–Ω–∞—è –≤–µ—Ä—Å–∏—è)")
            
            while self.background_listening and self.running:
                try:
                    # –≠–º—É–ª–∏—Ä—É–µ–º –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏–µ —Å —Å–ª—É—á–∞–π–Ω—ã–º–∏ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è–º–∏
                    time.sleep(3)  # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–∞–∂–¥—ã–µ 3 —Å–µ–∫—É–Ω–¥—ã
                    
                    # –î–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ - —ç–º—É–ª—è—Ü–∏—è —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è
                    # –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—ã–ª–∞ –±—ã —Ä–∞–±–æ—Ç–∞ —Å –º–∏–∫—Ä–æ—Ñ–æ–Ω–æ–º
                    if random.random() < 0.05:  # 5% —à–∞–Ω—Å —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è –¥–ª—è –¥–µ–º–æ
                        print("‚úì –î–µ–º–æ: –≠–º—É–ª—è—Ü–∏—è –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∫–ª—é—á–µ–≤–æ–≥–æ —Å–ª–æ–≤–∞")
                        self.wake_word_detected()
                        
                except Exception as e:
                    print(f"–û—à–∏–±–∫–∞ –≤ —Ñ–æ–Ω–æ–≤–æ–º –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏–∏: {e}")
                    time.sleep(1)
        
        if not hasattr(self, 'background_listener_thread') or not self.background_listener_thread.is_alive():
            self.background_listener_thread = threading.Thread(target=simple_listener, daemon=True)
            self.background_listener_thread.start()
    
    def voice_search_simple(self):
        """–£–ø—Ä–æ—â–µ–Ω–Ω—ã–π –≥–æ–ª–æ—Å–æ–≤–æ–π –ø–æ–∏—Å–∫"""
        self.speak("–°–∫–∞–∂–∏—Ç–µ –≤–∞—à –ø–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å")
        
        text, confidence = self.listen_without_speech_recognition(10)
        
        if text and confidence > 0.5:
            self.search_query.set(text)
            self.perform_search()
            self.message_queue.put(f"–ì–æ–ª–æ—Å–æ–≤–æ–π –ø–æ–∏—Å–∫: {text}")
            return True
        else:
            self.speak("–ù–µ —É–¥–∞–ª–æ—Å—å —Ä–∞—Å–ø–æ–∑–Ω–∞—Ç—å –∑–∞–ø—Ä–æ—Å")
            self.message_queue.put("–ù–µ —É–¥–∞–ª–æ—Å—å —Ä–∞—Å–ø–æ–∑–Ω–∞—Ç—å –≥–æ–ª–æ—Å–æ–≤–æ–π –∑–∞–ø—Ä–æ—Å")
            return False
    
    def process_voice_command_simple(self, command):
        """
        –£–ø—Ä–æ—â–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≥–æ–ª–æ—Å–æ–≤—ã—Ö –∫–æ–º–∞–Ω–¥
        """
        command_lower = command.lower()
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏
        if "–¥–æ–±–∞–≤—å –∑–∞–¥–∞—á—É" in command_lower:
            task = command_lower.replace("–¥–æ–±–∞–≤—å –∑–∞–¥–∞—á—É", "").strip()
            if task:
                self.automation_tasks.append(task)
                self.message_queue.put(f"–ó–∞–¥–∞—á–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞: {task}")
                self.speak(f"–ó–∞–¥–∞—á–∞ '{task}' –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤ —Å–ø–∏—Å–æ–∫ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏")
                return True
        
        elif "–ø–æ–∫–∞–∂–∏ –∑–∞–¥–∞—á–∏" in command_lower or "—Å–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á" in command_lower:
            if self.automation_tasks:
                tasks_text = ", ".join(self.automation_tasks[:5])
                self.speak(f"–£ –≤–∞—Å {len(self.automation_tasks)} –∑–∞–¥–∞—á: {tasks_text}")
            else:
                self.speak("–°–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á –ø—É—Å—Ç")
            return True
        
        elif "–≤—ã–ø–æ–ª–Ω–∏ –∑–∞–¥–∞—á–∏" in command_lower or "–∑–∞–ø—É—Å—Ç–∏ –∑–∞–¥–∞—á–∏" in command_lower:
            self.run_automation_tasks()
            return True
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ–º–∞–Ω–¥—ã –¥–ª—è —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ –∫–æ–¥–∞
        elif "–Ω–æ–≤—ã–π –∫–æ–¥" in command_lower or "—á–∏—Å—Ç—ã–π —Ä–µ–¥–∞–∫—Ç–æ—Ä" in command_lower:
            self.code_text.delete(1.0, tk.END)
            self.speak("–†–µ–¥–∞–∫—Ç–æ—Ä –∫–æ–¥–∞ –æ—á–∏—â–µ–Ω")
            return True
        
        elif "—Å–æ—Ö—Ä–∞–Ω–∏ –∫–æ–¥" in command_lower:
            self.save_code()
            return True
        
        # –°–∏—Å—Ç–µ–º–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã
        elif "—Å–∫—Ä–∏–Ω—à–æ—Ç" in command_lower:
            self.take_screenshot()
            return True
        
        # –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã
        command_mappings = [
            (["–ø–æ–∏—Å–∫", "–Ω–∞–π–¥–∏", "–Ω–∞–π—Ç–∏", "–∏—â–∏", "–∏—Å–∫–∞—Ç—å"], self.handle_search_command),
            (["–æ—Ç–∫—Ä–æ–π", "–æ—Ç–∫—Ä—ã—Ç—å", "–∑–∞–π–¥–∏", "–∑–∞–π—Ç–∏", "–ø–µ—Ä–µ–π–¥–∏", "–ø–µ—Ä–µ–π—Ç–∏"], self.handle_open_command),
            (["–ø–æ–≥–æ–¥–∞", "–ø–æ–≥–æ–¥—É", "–ø–æ–≥–æ–¥–µ", "—Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞", "—Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—É"], self.handle_weather_command),
            (["–∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä", "–ø–æ—Å—á–∏—Ç–∞–π", "–≤—ã—á–∏—Å–ª–∏", "—Å—á–∏—Ç–∞–π"], self.handle_calculator_command),
            (["–≤—Ä–µ–º—è", "—á–∞—Å", "—Å–∫–æ–ª—å–∫–æ –≤—Ä–µ–º–µ–Ω–∏", "–∫–æ—Ç–æ—Ä—ã–π —á–∞—Å"], self.handle_time_command),
            (["–±—Ä–∞—É–∑–µ—Ä", "–∏–Ω—Ç–µ—Ä–Ω–µ—Ç", "—Å–µ—Ç—å"], self.handle_browser_command),
            (["–±–ª–æ–∫–Ω–æ—Ç", "–∑–∞–º–µ—Ç–∫–∞", "–∑–∞–º–µ—Ç–∫–∏", "—Ç–µ–∫—Å—Ç"], self.handle_notepad_command),
            (["–¥–∏–ø—Å–∏–∫", "deepseek", "–∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç", "–∏–∏", "–∞–π", "ai"], self.handle_deepseek_command),
            (["–ø–æ–º–æ—â—å", "—Å–ø—Ä–∞–≤–∫–∞", "—á—Ç–æ —Ç—ã —É–º–µ–µ—à—å", "–∫–æ–º–∞–Ω–¥—ã"], self.handle_help_command),
            (["–Ω–∞—Å—Ç—Ä–æ–π–∫–∏", "–æ–ø—Ü–∏–∏", "–ø–∞—Ä–∞–º–µ—Ç—Ä—ã"], self.handle_settings_command),
            (["—Ä–µ–∂–∏–º", "–¥–µ–º–æ", "—Ä–∞–±–æ—á–∏–π"], self.handle_mode_command),
            (["—Å—Ç–æ–ø", "—Ö–≤–∞—Ç–∏—Ç", "–≤—ã–π—Ç–∏", "–∑–∞–∫–æ–Ω—á–∏", "–æ—Ç–∫–ª—é—á–∏—Å—å", "–≤—ã–∫–ª—é—á–∏—Å—å"], self.handle_stop_command),
            (["—Å–ø–∞—Å–∏–±–æ", "–±–ª–∞–≥–æ–¥–∞—Ä—é", "—Å–ø—Å", "thanks", "thank you"], self.handle_thanks_command),
            (["–∏–∏", "–∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç", "–æ–±—É—á–∏", "—Ç—Ä–µ–Ω–∏—Ä—É–π", "—Å–æ–∑–¥–∞–π –º–æ–¥–µ–ª—å", "–ø—Ä–µ–¥—Å–∫–∞–∂–∏", "–ø—Ä–æ–≥–Ω–æ–∑", "–∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–π", "—Ä–∞—Å–ø–æ–∑–Ω–∞–π"], self.handle_ai_command)
        ]
        
        for keywords, handler in command_mappings:
            for keyword in keywords:
                if keyword in command_lower:
                    print(f"‚úì –ù–∞–π–¥–µ–Ω–æ –∫–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ: '{keyword}'")
                    handler(command_lower, keyword)
                    return True
        
        # –ï—Å–ª–∏ –∫–æ–º–∞–Ω–¥–∞ –Ω–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–∞, –¥–µ–ª–∞–µ–º –ø–æ–∏—Å–∫
        question_words = ["—á—Ç–æ", "–∫–∞–∫", "–≥–¥–µ", "–∫—Ç–æ", "–ø–æ—á–µ–º—É", "–∑–∞—á–µ–º", "–∫–æ–≥–¥–∞", "—Å–∫–æ–ª—å–∫–æ"]
        words = command_lower.split()
        if any(word in words[:2] for word in question_words) or len(words) <= 4:
            self.search_query.set(command)
            self.perform_search()
            return True
        
        # –û—Ç–∫—Ä—ã–≤–∞–µ–º –∫–∞–∫ —Å–∞–π—Ç
        self.open_site_by_voice(command)
        return True
    
    # ========== –û–ë–ù–û–í–õ–ï–ù–ù–´–ï –ú–ï–¢–û–î–´ –î–õ–Ø –†–ê–ë–û–¢–´ –° –ù–û–í–´–ú–ò –§–£–ù–ö–¶–ò–Ø–ú–ò ==========
    
    def start_speech_processor(self):
        """–ó–∞–ø—É—Å–∫ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ —Ä–µ—á–∏"""
        def speech_processor():
            while self.running:
                try:
                    text = self.speech_queue.get(timeout=0.5)
                    if text and self.speech_engine:
                        try:
                            # –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ç–µ–∫—É—â–µ–µ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ
                            self.speech_engine.stop()
                            # –ü—Ä–æ–∏–∑–Ω–æ—Å–∏–º —Ç–µ–∫—Å—Ç
                            self.speech_engine.say(text)
                            self.speech_engine.runAndWait()
                        except Exception as e:
                            print(f"–û—à–∏–±–∫–∞ —Å–∏–Ω—Ç–µ–∑–∞ —Ä–µ—á–∏: {e}")
                            # –ü–µ—Ä–µ—Å–æ–∑–¥–∞–µ–º –¥–≤–∏–∂–æ–∫ –ø—Ä–∏ –æ—à–∏–±–∫–µ
                            try:
                                self.speech_engine = pyttsx3.init()
                                self.speech_engine.setProperty('rate', self.settings.get("voice_speed", 150))
                                self.speech_engine.setProperty('volume', self.settings.get("voice_volume", 0.9))
                            except:
                                pass
                except queue.Empty:
                    continue
                except Exception as e:
                    print(f"–û—à–∏–±–∫–∞ –≤ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–µ —Ä–µ—á–∏: {e}")
        
        if (SPEECH_AVAILABLE or self.voice_input_method == 'windows_sapi') and not self.speech_thread:
            self.speech_thread = threading.Thread(target=speech_processor, daemon=True)
            self.speech_thread.start()
    
    def speak(self, text, priority=False):
        """–ü—Ä–æ–∏–∑–Ω–µ—Å–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞"""
        if not self.running:
            return
        
        if not self.settings.get("voice_feedback", True) and not priority:
            return
        
        if not text or not text.strip():
            return
        
        try:
            # –ï—Å–ª–∏ –µ—Å—Ç—å speech_engine (pyttsx3)
            if self.speech_engine:
                self.speech_queue.put(text.strip())
            # –ò–Ω–∞—á–µ –µ—Å–ª–∏ –µ—Å—Ç—å Windows SAPI
            elif hasattr(self, 'speech_engine_win'):
                try:
                    self.speech_engine_win.Speak(text.strip(), 0)
                except:
                    print(f"–ù–µ —É–¥–∞–ª–æ—Å—å –ø—Ä–æ–∏–∑–Ω–µ—Å—Ç–∏ —Ç–µ–∫—Å—Ç: {text[:50]}...")
            else:
                # –í—ã–≤–æ–¥–∏–º –≤ –∫–æ–Ω—Å–æ–ª—å
                print(f"–ì–æ–ª–æ—Å: {text}")
        except Exception as e:
            print(f"–û—à–∏–±–∫–∞ —Å–∏–Ω—Ç–µ–∑–∞ —Ä–µ—á–∏: {e}")
    
    def voice_search(self):
        """–ì–æ–ª–æ—Å–æ–≤–æ–π –ø–æ–∏—Å–∫"""
        if SPEECH_AVAILABLE:
            # –ò—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –º–µ—Ç–æ–¥ —Å speech_recognition
            self.original_voice_search()
        elif VOICE_INPUT_AVAILABLE:
            # –ò—Å–ø–æ–ª—å–∑—É–µ–º –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –º–µ—Ç–æ–¥
            self.voice_search_simple()
        else:
            self.speak("–ì–æ–ª–æ—Å–æ–≤–æ–π –ø–æ–∏—Å–∫ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω")
            self.message_queue.put("–ì–æ–ª–æ—Å–æ–≤–æ–π –ø–æ–∏—Å–∫ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω")
    
    def original_voice_search(self):
        """–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –º–µ—Ç–æ–¥ –≥–æ–ª–æ—Å–æ–≤–æ–≥–æ –ø–æ–∏—Å–∫–∞"""
        if not SPEECH_AVAILABLE:
            return
        
        self.speak("–°–∫–∞–∂–∏—Ç–µ –≤–∞—à –ø–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å")
        
        try:
            with sr.Microphone() as source:
                self.status_label.config(text="–°–ª—É—à–∞—é...", fg=self.colors['primary_light'])
                self.recognizer.adjust_for_ambient_noise(source, duration=0.5)
                audio = self.recognizer.listen(source, timeout=5, phrase_time_limit=5)
                
            query = self.recognizer.recognize_google(audio, language='ru-RU')
            self.search_query.set(query)
            self.perform_search()
            self.status_label.config(text="–ü–æ–∏—Å–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω", fg=self.colors['success'])
            
        except sr.WaitTimeoutError:
            self.speak("–í—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è –∏—Å—Ç–µ–∫–ª–æ")
            self.message_queue.put("–í—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è –∏—Å—Ç–µ–∫–ª–æ")
            self.status_label.config(text="–ì–æ—Ç–æ–≤", fg=self.colors['text_secondary'])
        except sr.UnknownValueError:
            self.speak("–ù–µ —É–¥–∞–ª–æ—Å—å —Ä–∞—Å–ø–æ–∑–Ω–∞—Ç—å —Ä–µ—á—å")
            self.message_queue.put("–ù–µ —É–¥–∞–ª–æ—Å—å —Ä–∞—Å–ø–æ–∑–Ω–∞—Ç—å —Ä–µ—á—å")
            self.status_label.config(text="–ì–æ—Ç–æ–≤", fg=self.colors['text_secondary'])
        except Exception as e:
            self.speak(f"–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞: {str(e)[:30]}")
            self.message_queue.put(f"–û—à–∏–±–∫–∞: {e}")
            self.status_label.config(text="–ì–æ—Ç–æ–≤", fg=self.colors['text_secondary'])
    
    def start_voice_assistant(self):
        """–ó–∞–ø—É—Å–∫ –≥–æ–ª–æ—Å–æ–≤–æ–≥–æ –ø–æ–º–æ—â–Ω–∏–∫–∞"""
        if SPEECH_AVAILABLE and self.settings.get("voice_enabled", True) and not self.demo_mode:
            # –ò—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –º–µ—Ç–æ–¥
            self.voice_assistant_active = True
            self.root.after(1000, self.start_original_voice_assistant)
        elif VOICE_INPUT_AVAILABLE and self.settings.get("voice_enabled", True) and not self.demo_mode:
            # –ò—Å–ø–æ–ª—å–∑—É–µ–º —É–ø—Ä–æ—â–µ–Ω–Ω—ã–π –º–µ—Ç–æ–¥
            self.voice_assistant_active = True
            self.root.after(1000, self.start_simple_voice_assistant)
        else:
            print("–ì–æ–ª–æ—Å–æ–≤–æ–π –ø–æ–º–æ—â–Ω–∏–∫ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω")
    
    def start_original_voice_assistant(self):
        """–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ –≥–æ–ª–æ—Å–æ–≤–æ–≥–æ –ø–æ–º–æ—â–Ω–∏–∫–∞"""
        if not SPEECH_AVAILABLE:
            return
        
        self.background_listening = True
        self.speak(f"–ì–æ–ª–æ—Å–æ–≤–æ–π –ø–æ–º–æ—â–Ω–∏–∫ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω. –°–∫–∞–∂–∏—Ç–µ '{self.voice_wake_word}' –¥–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏.")
        self.message_queue.put(f"–ì–æ–ª–æ—Å–æ–≤–æ–π –ø–æ–º–æ—â–Ω–∏–∫ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω. –°–∫–∞–∂–∏—Ç–µ '{self.voice_wake_word}' –¥–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏.")
        self.status_label.config(text=f"üé§ –û–∂–∏–¥–∞–Ω–∏–µ: '{self.voice_wake_word}'", fg=self.colors['primary_light'])
        
        self.start_improved_background_listening()
    
    def start_simple_voice_assistant(self):
        """–£–ø—Ä–æ—â–µ–Ω–Ω—ã–π –∑–∞–ø—É—Å–∫ –≥–æ–ª–æ—Å–æ–≤–æ–≥–æ –ø–æ–º–æ—â–Ω–∏–∫–∞"""
        if not VOICE_INPUT_AVAILABLE:
            return
        
        self.background_listening = True
        self.speak(f"–£–ø—Ä–æ—â–µ–Ω–Ω—ã–π –≥–æ–ª–æ—Å–æ–≤–æ–π –ø–æ–º–æ—â–Ω–∏–∫ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω")
        self.message_queue.put("–£–ø—Ä–æ—â–µ–Ω–Ω—ã–π –≥–æ–ª–æ—Å–æ–≤–æ–π –ø–æ–º–æ—â–Ω–∏–∫ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω")
        self.status_label.config(text="üé§ –£–ø—Ä–æ—â–µ–Ω–Ω—ã–π —Ä–µ–∂–∏–º", fg=self.colors['primary_light'])
        
        # –ó–∞–ø—É—Å–∫–∞–µ–º —É–ø—Ä–æ—â–µ–Ω–Ω–æ–µ –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏–µ
        self.improved_background_listening_no_libs()
    
    def start_improved_background_listening(self):
        """–£–ª—É—á—à–µ–Ω–Ω–æ–µ —Ñ–æ–Ω–æ–≤–æ–µ –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏–µ –¥–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –ø–æ —Ñ—Ä–∞–∑–µ"""
        if not self.background_listening or not self.running:
            return
        
        def background_listener():
            print(f"–§–æ–Ω–æ–≤–æ–µ –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏–µ –∑–∞–ø—É—â–µ–Ω–æ. –û–∂–∏–¥–∞–Ω–∏–µ: {self.activation_phrases}")
            
            microphone_errors = 0
            
            while self.background_listening and self.running:
                try:
                    with sr.Microphone() as source:
                        self.recognizer.energy_threshold = 200
                        self.recognizer.dynamic_energy_adjustment_damping = 0.15
                        self.recognizer.dynamic_energy_ratio = 1.5
                        self.recognizer.pause_threshold = 0.8
                        
                        if microphone_errors == 0:
                            print("–ö–∞–ª–∏–±—Ä—É—é –º–∏–∫—Ä–æ—Ñ–æ–Ω...")
                            self.recognizer.adjust_for_ambient_noise(source, duration=0.5)
                            print("–ú–∏–∫—Ä–æ—Ñ–æ–Ω –æ—Ç–∫–∞–ª–∏–±—Ä–æ–≤–∞–Ω")
                        
                        print("–°–ª—É—à–∞—é...")
                        audio = self.recognizer.listen(
                            source, 
                            timeout=2,
                            phrase_time_limit=1.5
                        )
                        
                        microphone_errors = 0
                        
                        try:
                            text = self.recognizer.recognize_google(
                                audio, 
                                language='ru-RU',
                                show_all=True
                            )
                            
                            print(f"–†–∞—Å–ø–æ–∑–Ω–∞–Ω–æ: {text}")
                            
                            if text and 'alternative' in text:
                                for alternative in text['alternative']:
                                    recognized_text = alternative['transcript'].lower().strip()
                                    confidence = alternative.get('confidence', 0.2)
                                    
                                    print(f"–í–∞—Ä–∏–∞–Ω—Ç: '{recognized_text}' (—É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å: {confidence:.2f})")
                                    
                                    for phrase in self.activation_phrases:
                                        if (phrase in recognized_text or 
                                            recognized_text in phrase or 
                                            self.is_similar(phrase, recognized_text)):
                                            
                                            if confidence >= self.wake_sensitivity:
                                                current_time = time.time()
                                                if current_time - self.last_wake_time > 2:
                                                    self.last_wake_time = current_time
                                                    print(f"‚úì –†–∞—Å–ø–æ–∑–Ω–∞–Ω–æ –∫–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ: '{phrase}' (—É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å: {confidence:.2f})")
                                                    self.wake_word_detected()
                                                    break
                                    
                        except sr.UnknownValueError:
                            pass
                        except Exception as e:
                            print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±—Ä–∞–±–æ—Ç–∫–µ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è: {e}")
                            
                except sr.WaitTimeoutError:
                    continue
                except Exception as e:
                    microphone_errors += 1
                    print(f"–û—à–∏–±–∫–∞ –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞ (#{microphone_errors}): {e}")
                    
                    if microphone_errors > 3:
                        print("–ú–Ω–æ–≥–æ –æ—à–∏–±–æ–∫ –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞, –¥–µ–ª–∞—é –ø–∞—É–∑—É...")
                        time.sleep(2)
                        microphone_errors = 0
        
        if not hasattr(self, 'background_listener_thread') or not self.background_listener_thread.is_alive():
            self.background_listener_thread = threading.Thread(target=background_listener, daemon=True)
            self.background_listener_thread.start()
    
    def wake_word_detected(self):
        """–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è –∫–ª—é—á–µ–≤–æ–≥–æ —Å–ª–æ–≤–∞"""
        if not self.running:
            return
        
        print("‚úì –ö–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ!")
        
        self.root.after(0, self.update_status_for_wake_word)
        
        self.root.after(0, lambda: self.play_activation_sound())
        
        self.root.after(100, lambda: self.speak("–°–ª—É—à–∞—é –≤–∞—Å", priority=True))
        
        self.root.after(800, self.process_voice_command_after_wake_word)
    
    def process_voice_command_after_wake_word(self):
        """–û–±—Ä–∞–±–æ—Ç–∫–∞ –≥–æ–ª–æ—Å–æ–≤–æ–π –∫–æ–º–∞–Ω–¥—ã –ø–æ—Å–ª–µ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏"""
        if not self.running:
            return
        
        print("‚úì –ù–∞—á–∏–Ω–∞—é —Å–ª—É—à–∞—Ç—å –∫–æ–º–∞–Ω–¥—É...")
        
        if SPEECH_AVAILABLE:
            # –ò—Å–ø–æ–ª—å–∑—É–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –º–µ—Ç–æ–¥
            self.process_voice_command_original()
        elif VOICE_INPUT_AVAILABLE:
            # –ò—Å–ø–æ–ª—å–∑—É–µ–º —É–ø—Ä–æ—â–µ–Ω–Ω—ã–π –º–µ—Ç–æ–¥
            self.process_voice_command_simple_mode()
        else:
            self.speak("–ì–æ–ª–æ—Å–æ–≤–æ–π –≤–≤–æ–¥ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω")
            self.status_label.config(text="–ì–æ–ª–æ—Å–æ–≤–æ–π –≤–≤–æ–¥ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω", fg=self.colors['danger'])
    
    def process_voice_command_original(self):
        """–û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≥–æ–ª–æ—Å–æ–≤–æ–π –∫–æ–º–∞–Ω–¥—ã"""
        try:
            with sr.Microphone() as source:
                self.status_label.config(text="üé§ –°–ª—É—à–∞—é –∫–æ–º–∞–Ω–¥—É...", fg=self.colors['primary_light'])
                
                print("–ö–∞–ª–∏–±—Ä—É—é –º–∏–∫—Ä–æ—Ñ–æ–Ω –¥–ª—è –∫–æ–º–∞–Ω–¥—ã...")
                self.recognizer.adjust_for_ambient_noise(source, duration=0.5)
                print("–ú–∏–∫—Ä–æ—Ñ–æ–Ω –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω –¥–ª—è –∫–æ–º–∞–Ω–¥—ã")
                
                print("–û–∂–∏–¥–∞—é –∫–æ–º–∞–Ω–¥—É...")
                
                try:
                    audio = self.recognizer.listen(
                        source, 
                        timeout=5,
                        phrase_time_limit=4
                    )
                    
                    print("–ê—É–¥–∏–æ –∑–∞–ø–∏—Å–∞–Ω–æ, –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é...")
                    
                    try:
                        result = self.recognizer.recognize_google(
                            audio, 
                            language='ru-RU',
                            show_all=True
                        )
                        
                        print(f"–†–µ–∑—É–ª—å—Ç–∞—Ç —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è: {result}")
                        
                        if result and 'alternative' in result and len(result['alternative']) > 0:
                            best_result = result['alternative'][0]
                            command = best_result['transcript'].lower()
                            confidence = best_result.get('confidence', 0)
                            
                            print(f"‚úì –ö–æ–º–∞–Ω–¥–∞ —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–∞: '{command}' (—É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å: {confidence:.2f})")
                            self.message_queue.put(f"–ö–æ–º–∞–Ω–¥–∞: {command} (—É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å: {confidence:.2f})")
                            
                            if confidence > 0.2:
                                self.speak(f"–í—ã —Å–∫–∞–∑–∞–ª–∏: {command[:40]}")
                                self.process_enhanced_command(command)
                            else:
                                if len(result['alternative']) > 1:
                                    second_result = result['alternative'][1]
                                    command2 = second_result['transcript'].lower()
                                    confidence2 = second_result.get('confidence', 0)
                                    
                                    if confidence2 > 0.2:
                                        print(f"‚úì –ò—Å–ø–æ–ª—å–∑—É—é –≤—Ç–æ—Ä–æ–π –≤–∞—Ä–∏–∞–Ω—Ç: '{command2}' (—É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å: {confidence2:.2f})")
                                        self.speak(f"–í—ã —Å–∫–∞–∑–∞–ª–∏: {command2[:40]}")
                                        self.process_enhanced_command(command2)
                                    else:
                                        print("‚úó –£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å —Å–ª–∏—à–∫–æ–º –Ω–∏–∑–∫–∞—è –¥–ª—è –≤—Å–µ—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤")
                                        self.speak("–ù–µ —É–¥–∞–ª–æ—Å—å —á–µ—Ç–∫–æ —Ä–∞—Å–ø–æ–∑–Ω–∞—Ç—å –∫–æ–º–∞–Ω–¥—É. –ü–æ–≤—Ç–æ—Ä–∏—Ç–µ, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞.")
                                        self.status_label.config(text=f"üé§ –û–∂–∏–¥–∞–Ω–∏–µ: '{self.voice_wake_word}'", fg=self.colors['primary_light'])
                                else:
                                    print("‚úó –£–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å —Å–ª–∏—à–∫–æ–º –Ω–∏–∑–∫–∞—è")
                                    self.speak("–ù–µ —É–¥–∞–ª–æ—Å—å —á–µ—Ç–∫–æ —Ä–∞—Å–ø–æ–∑–Ω–∞—Ç—å –∫–æ–º–∞–Ω–¥—É. –ü–æ–≤—Ç–æ—Ä–∏—Ç–µ, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞.")
                                    self.status_label.config(text=f"üé§ –û–∂–∏–¥–∞–Ω–∏–µ: '{self.voice_wake_word}'", fg=self.colors['primary_light'])
                        else:
                            print("‚úó –ù–µ—Ç –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤ –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ")
                            self.speak("–ù–µ —É–¥–∞–ª–æ—Å—å —Ä–∞—Å–ø–æ–∑–Ω–∞—Ç—å –∫–æ–º–∞–Ω–¥—É")
                            self.status_label.config(text=f"üé§ –û–∂–∏–¥–∞–Ω–∏–µ: '{self.voice_wake_word}'", fg=self.colors['primary_light'])
                            
                    except sr.UnknownValueError:
                        print("‚úó –ù–µ —É–¥–∞–ª–æ—Å—å —Ä–∞—Å–ø–æ–∑–Ω–∞—Ç—å –∫–æ–º–∞–Ω–¥—É (UnknownValueError)")
                        self.speak("–ù–µ —É–¥–∞–ª–æ—Å—å —Ä–∞—Å–ø–æ–∑–Ω–∞—Ç—å –∫–æ–º–∞–Ω–¥—É")
                        self.status_label.config(text=f"üé§ –û–∂–∏–¥–∞–Ω–∏–µ: '{self.voice_wake_word}'", fg=self.colors['primary_light'])
                        
                    except Exception as e:
                        print(f"‚úó –û—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–∏ –∫–æ–º–∞–Ω–¥—ã: {e}")
                        self.speak(f"–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–∏: {str(e)[:30]}")
                        self.status_label.config(text=f"üé§ –û–∂–∏–¥–∞–Ω–∏–µ: '{self.voice_wake_word}'", fg=self.colors['primary_light'])
                        
                except sr.WaitTimeoutError:
                    print("‚úó –í—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è –∫–æ–º–∞–Ω–¥—ã –∏—Å—Ç–µ–∫–ª–æ")
                    self.speak("–í—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è –∫–æ–º–∞–Ω–¥—ã –∏—Å—Ç–µ–∫–ª–æ")
                    self.status_label.config(text=f"üé§ –û–∂–∏–¥–∞–Ω–∏–µ: '{self.voice_wake_word}'", fg=self.colors['primary_light'])
                    
        except Exception as e:
            print(f"‚úó –û—à–∏–±–∫–∞ –ø—Ä–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞: {e}")
            self.speak("–û—à–∏–±–∫–∞ –ø—Ä–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞")
            self.status_label.config(text=f"üé§ –û–∂–∏–¥–∞–Ω–∏–µ: '{self.voice_wake_word}'", fg=self.colors['primary_light'])
    
    def process_voice_command_simple_mode(self):
        """–£–ø—Ä–æ—â–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≥–æ–ª–æ—Å–æ–≤–æ–π –∫–æ–º–∞–Ω–¥—ã"""
        self.speak("–°–∫–∞–∂–∏—Ç–µ –∫–æ–º–∞–Ω–¥—É")
        
        # –ò—Å–ø–æ–ª—å–∑—É–µ–º —É–ø—Ä–æ—â–µ–Ω–Ω—ã–π –º–µ—Ç–æ–¥ —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è
        command, confidence = self.listen_without_speech_recognition(10)
        
        if command and confidence > 0.5:
            self.speak(f"–í—ã —Å–∫–∞–∑–∞–ª–∏: {command[:40]}")
            self.process_voice_command_simple(command)
            self.status_label.config(text=f"üé§ –û–∂–∏–¥–∞–Ω–∏–µ: '{self.voice_wake_word}'", fg=self.colors['primary_light'])
        else:
            self.speak("–ù–µ —É–¥–∞–ª–æ—Å—å —Ä–∞—Å–ø–æ–∑–Ω–∞—Ç—å –∫–æ–º–∞–Ω–¥—É")
            self.status_label.config(text=f"üé§ –û–∂–∏–¥–∞–Ω–∏–µ: '{self.voice_wake_word}'", fg=self.colors['primary_light'])
    
    # ========== –°–£–©–ï–°–¢–í–£–Æ–©–ò–ï –ú–ï–¢–û–î–´ (–ë–ï–ó –ò–ó–ú–ï–ù–ï–ù–ò–ô) ==========
    
    def safe_after(self, delay_ms, callback, *args):
        """–ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ after —Å –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ–º ID"""
        if not self.running:
            return None
        
        def safe_callback():
            if self.running and self.root.winfo_exists():
                try:
                    callback(*args)
                except (tk.TclError, AttributeError, RuntimeError):
                    pass  # –û–∫–Ω–æ —É–∂–µ —É–Ω–∏—á—Ç–æ–∂–µ–Ω–æ –∏–ª–∏ –≤–∏–¥–∂–µ—Ç –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç
        
        after_id = self.root.after(delay_ms, safe_callback)
        self.after_ids.append(after_id)
        return after_id
    
    def cancel_all_after(self):
        """–û—Ç–º–µ–Ω–∞ –≤—Å–µ—Ö –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∑–∞–¥–∞—á"""
        self.running = False
        for after_id in self.after_ids:
            try:
                self.root.after_cancel(after_id)
            except:
                pass
        self.after_ids.clear()
    
    def load_users(self):
        """–ó–∞–≥—Ä—É–∑–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏–∑ —Ñ–∞–π–ª–∞"""
        try:
            if os.path.exists(self.users_file):
                with open(self.users_file, 'r', encoding='utf-8') as f:
                    content = f.read().strip()
                    if content:  # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ —Ñ–∞–π–ª –Ω–µ –ø—É—Å—Ç–æ–π
                        self.users = json.loads(content)
                    else:
                        self.users = {}
            else:
                self.users = {}
        except json.JSONDecodeError as e:
            print(f"–û—à–∏–±–∫–∞ –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è JSON –≤ —Ñ–∞–π–ª–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: {e}")
            self.users = {}
        except Exception as e:
            print(f"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: {e}")
            self.users = {}
    
    def save_users(self):
        """–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ —Ñ–∞–π–ª"""
        try:
            with open(self.users_file, 'w', encoding='utf-8') as f:
                json.dump(self.users, f, ensure_ascii=False, indent=2)
        except Exception as e:
            print(f"–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: {e}")
    
    def hash_password(self, password):
        """–•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª—è"""
        return hashlib.sha256(password.encode()).hexdigest()
    
    def show_auth_window(self):
        """–û–∫–Ω–æ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏/—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ —Å —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º –¥–∏–∑–∞–π–Ω–æ–º"""
        # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ
        self.text_anim.show_transition("–ê—Ç–æ–º v4.0 PRO", 2)
        
        self.auth_window = tk.Toplevel(self.root)
        self.auth_window.title("–ê—Ç–æ–º v4.0 PRO - –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è")
        self.auth_window.geometry("500x650")
        self.auth_window.configure(bg="#0f172a")
        self.auth_window.resizable(False, False)
        self.auth_window.attributes('-topmost', True)
        
        # –¶–µ–Ω—Ç—Ä–∏—Ä—É–µ–º –æ–∫–Ω–æ
        self.center_window(self.auth_window)
        
        # Canvas –¥–ª—è –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω–æ–≥–æ —Ñ–æ–Ω–∞
        canvas = tk.Canvas(self.auth_window, bg="#0f172a", highlightthickness=0)
        canvas.pack(fill=tk.BOTH, expand=True)
        
        # –†–∏—Å—É–µ–º –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π —Ñ–æ–Ω
        width, height = 500, 650
        for i in range(height):
            ratio = i / height
            r = int(15 + (30 * ratio))
            g = int(23 + (42 * ratio))
            b = int(42 + (58 * ratio))
            color = f'#{r:02x}{g:02x}{b:02x}'
            canvas.create_line(0, i, width, i, fill=color, width=1)
        
        # –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å —ç—Ñ—Ñ–µ–∫—Ç–æ–º
        canvas.create_text(250, 80,
                          text="‚öõÔ∏è",
                          fill="#60a5fa",
                          font=('Segoe UI', 72, 'bold'))
        
        canvas.create_text(250, 150,
                          text="–ê—Ç–æ–º v4.0 PRO",
                          fill="#ffffff",
                          font=('Segoe UI', 28, 'bold'))
        
        canvas.create_text(250, 180,
                          text="–£–º–Ω—ã–π –≥–æ–ª–æ—Å–æ–≤–æ–π –ø–æ–º–æ—â–Ω–∏–∫ —Å –ò–ò",
                          fill="#94a3b8",
                          font=('Segoe UI', 12))
        
        # –§—Ä–µ–π–º –¥–ª—è –≤–∫–ª–∞–¥–æ–∫ —Å —Ç–µ–º–Ω—ã–º —Ñ–æ–Ω–æ–º (–±–µ–∑ –ø—Ä–æ–∑—Ä–∞—á–Ω–æ—Å—Ç–∏)
        notebook_frame = tk.Frame(canvas, bg='#1e293b')
        canvas.create_window(250, 350, window=notebook_frame, width=400, height=350)
        
        # –í–∫–ª–∞–¥–∫–∏
        notebook = ttk.Notebook(notebook_frame)
        notebook.pack(fill=tk.BOTH, expand=True, padx=10, pady=10)
        
        # –ù–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º —Å—Ç–∏–ª—å –≤–∫–ª–∞–¥–æ–∫
        style = ttk.Style()
        style.configure('Modern.TNotebook', background='#1e293b', borderwidth=0)
        style.configure('Modern.TNotebook.Tab', 
                       background='#334155', 
                       foreground='#cbd5e1',
                       padding=[20, 10],
                       font=('Segoe UI', 10))
        style.map('Modern.TNotebook.Tab', 
                 background=[('selected', '#3b82f6')],
                 foreground=[('selected', 'white')])
        
        notebook.configure(style='Modern.TNotebook')
        
        # –í–∫–ª–∞–¥–∫–∞ –≤—Ö–æ–¥–∞
        login_frame = tk.Frame(notebook, bg='#1e293b')
        notebook.add(login_frame, text="–í—Ö–æ–¥")
        
        # –í–∫–ª–∞–¥–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
        register_frame = tk.Frame(notebook, bg='#1e293b')
        notebook.add(register_frame, text="–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è")
        
        # ===== –í–ö–õ–ê–î–ö–ê –í–•–û–î–ê =====
        tk.Label(login_frame,
                text="–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:",
                bg='#1e293b',
                fg='#cbd5e1',
                font=('Segoe UI', 11)).place(x=30, y=30)
        
        self.login_username = tk.StringVar()
        login_user_entry = tk.Entry(
            login_frame,
            textvariable=self.login_username,
            font=("Segoe UI", 12),
            bg='#0f172a',
            fg='white',
            insertbackground='white',
            relief=tk.FLAT,
            width=25
        )
        login_user_entry.place(x=30, y=60)
        
        tk.Label(login_frame,
                text="–ü–∞—Ä–æ–ª—å:",
                bg='#1e293b',
                fg='#cbd5e1',
                font=('Segoe UI', 11)).place(x=30, y=100)
        
        self.login_password = tk.StringVar()
        login_pass_entry = tk.Entry(
            login_frame,
            textvariable=self.login_password,
            font=("Segoe UI", 12),
            bg='#0f172a',
            fg='white',
            insertbackground='white',
            relief=tk.FLAT,
            width=25,
            show="‚Ä¢"
        )
        login_pass_entry.place(x=30, y=130)
        
        # –ß–µ–∫–±–æ–∫—Å "–ó–∞–ø–æ–º–Ω–∏—Ç—å –º–µ–Ω—è"
        self.login_remember = tk.BooleanVar(value=True)
        remember_check = tk.Checkbutton(
            login_frame,
            text="–ó–∞–ø–æ–º–Ω–∏—Ç—å –º–µ–Ω—è",
            variable=self.login_remember,
            bg='#1e293b',
            fg='#cbd5e1',
            selectcolor='#3b82f6',
            activebackground='#1e293b',
            activeforeground='#cbd5e1',
            font=('Segoe UI', 10)
        )
        remember_check.place(x=30, y=170)
        
        # –ö–Ω–æ–ø–∫–∞ –≤—Ö–æ–¥–∞
        def create_login_button():
            btn_canvas = tk.Canvas(login_frame, bg='#1e293b', highlightthickness=0, width=200, height=45)
            btn_canvas.place(x=100, y=220)
            
            # –ì—Ä–∞–¥–∏–µ–Ω—Ç–Ω–∞—è –∫–Ω–æ–ø–∫–∞
            for i in range(45):
                ratio = i / 45
                r = int(59 * (1 - ratio * 0.3))
                g = int(130 * (1 - ratio * 0.3))
                b = int(246 * (1 - ratio * 0.3))
                color = f'#{r:02x}{g:02x}{b:02x}'
                btn_canvas.create_line(0, i, 200, i, fill=color, width=1)
            
            btn_canvas.create_text(100, 22,
                                  text="üö™ –í–æ–π—Ç–∏",
                                  fill="white",
                                  font=('Segoe UI', 12, 'bold'))
            
            btn_canvas.bind("<Button-1>", lambda e: self.login_user())
            btn_canvas.bind("<Enter>", lambda e: btn_canvas.config(cursor="hand2"))
            btn_canvas.bind("<Leave>", lambda e: btn_canvas.config(cursor=""))
        
        create_login_button()
        
        # –ì–æ—Å—Ç–µ–≤–æ–π –¥–æ—Å—Ç—É–ø
        guest_btn = tk.Label(login_frame,
                           text="üë§ –ì–æ—Å—Ç–µ–≤–æ–π –¥–æ—Å—Ç—É–ø",
                           bg='#1e293b',
                           fg='#60a5fa',
                           font=('Segoe UI', 10),
                           cursor="hand2")
        guest_btn.place(x=140, y=280)
        guest_btn.bind("<Button-1>", lambda e: self.guest_login())
        
        # ===== –í–ö–õ–ê–î–ö–ê –†–ï–ì–ò–°–¢–†–ê–¶–ò–ò =====
        tk.Label(register_frame,
                text="–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:",
                bg='#1e293b',
                fg='#cbd5e1',
                font=('Segoe UI', 11)).place(x=30, y=30)
        
        self.reg_username = tk.StringVar()
        reg_user_entry = tk.Entry(
            register_frame,
            textvariable=self.reg_username,
            font=("Segoe UI", 12),
            bg='#0f172a',
            fg='white',
            insertbackground='white',
            relief=tk.FLAT,
            width=25
        )
        reg_user_entry.place(x=30, y=60)
        
        tk.Label(register_frame,
                text="–ü–∞—Ä–æ–ª—å:",
                bg='#1e293b',
                fg='#cbd5e1',
                font=('Segoe UI', 11)).place(x=30, y=100)
        
        self.reg_password = tk.StringVar()
        reg_pass_entry = tk.Entry(
            register_frame,
            textvariable=self.reg_password,
            font=("Segoe UI", 12),
            bg='#0f172a',
            fg='white',
            insertbackground='white',
            relief=tk.FLAT,
            width=25,
            show="‚Ä¢"
        )
        reg_pass_entry.place(x=30, y=130)
        
        tk.Label(register_frame,
                text="–ü–æ–≤—Ç–æ—Ä–∏—Ç–µ –ø–∞—Ä–æ–ª—å:",
                bg='#1e293b',
                fg='#cbd5e1',
                font=('Segoe UI', 11)).place(x=30, y=170)
        
        self.reg_password_confirm = tk.StringVar()
        reg_pass_confirm_entry = tk.Entry(
            register_frame,
            textvariable=self.reg_password_confirm,
            font=("Segoe UI", 12),
            bg='#0f172a',
            fg='white',
            insertbackground='white',
            relief=tk.FLAT,
            width=25,
            show="‚Ä¢"
        )
        reg_pass_confirm_entry.place(x=30, y=200)
        
        # –ß–µ–∫–±–æ–∫—Å —Å–æ–≥–ª–∞—Å–∏—è
        self.reg_terms = tk.BooleanVar(value=False)
        terms_check = tk.Checkbutton(
            register_frame,
            text="–Ø —Å–æ–≥–ª–∞—Å–µ–Ω —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º —Å–æ–≥–ª–∞—à–µ–Ω–∏–µ–º",
            variable=self.reg_terms,
            bg='#1e293b',
            fg='#cbd5e1',
            selectcolor='#3b82f6',
            activebackground='#1e293b',
            activeforeground='#cbd5e1',
            font=('Segoe UI', 9)
        )
        terms_check.place(x=30, y=240)
        
        # –ö–Ω–æ–ø–∫–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
        def create_register_button():
            btn_canvas = tk.Canvas(register_frame, bg='#1e293b', highlightthickness=0, width=200, height=45)
            btn_canvas.place(x=100, y=280)
            
            # –ì—Ä–∞–¥–∏–µ–Ω—Ç–Ω–∞—è –∫–Ω–æ–ø–∫–∞
            for i in range(45):
                ratio = i / 45
                r = int(139 * (1 - ratio * 0.3))
                g = int(92 * (1 - ratio * 0.3))
                b = int(246 * (1 - ratio * 0.3))
                color = f'#{r:02x}{g:02x}{b:02x}'
                btn_canvas.create_line(0, i, 200, i, fill=color, width=1)
            
            btn_canvas.create_text(100, 22,
                                  text="üìù –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è",
                                  fill="white",
                                  font=('Segoe UI', 12, 'bold'))
            
            btn_canvas.bind("<Button-1>", lambda e: self.register_user())
            btn_canvas.bind("<Enter>", lambda e: btn_canvas.config(cursor="hand2"))
            btn_canvas.bind("<Leave>", lambda e: btn_canvas.config(cursor=""))
        
        create_register_button()
        
        # –°–∫—Ä—ã–≤–∞–µ–º –≥–ª–∞–≤–Ω–æ–µ –æ–∫–Ω–æ
        self.root.withdraw()
        self.auth_window.grab_set()
        self.auth_window.focus_set()
        
        # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Ñ–æ–∫—É—Å –Ω–∞ –ø–µ—Ä–≤–æ–µ –ø–æ–ª–µ
        login_user_entry.focus_set()
        
        # –û–±—Ä–∞–±–æ—Ç–∫–∞ Enter
        login_pass_entry.bind('<Return>', lambda e: self.login_user())
        reg_pass_confirm_entry.bind('<Return>', lambda e: self.register_user())
        
        # –í–µ—Ä—Å–∏—è –≤–Ω–∏–∑—É
        version_label = tk.Label(canvas,
                                text="–í–µ—Ä—Å–∏—è 4.0 PRO | ¬© 2024 | –° —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏ –ò–ò",
                                bg='#0f172a',
                                fg='#64748b',
                                font=('Segoe UI', 9))
        canvas.create_window(250, 620, window=version_label)
        
        # –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è –æ–∫–Ω–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
        self.auth_window.protocol("WM_DELETE_WINDOW", self.on_auth_window_close)
    
    def on_auth_window_close(self):
        """–û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è –æ–∫–Ω–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏"""
        if self.auth_window and self.auth_window.winfo_exists():
            self.auth_window.destroy()
        self.on_closing()
    
    def center_window(self, window):
        """–¶–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–∫–Ω–∞ –Ω–∞ —ç–∫—Ä–∞–Ω–µ"""
        window.update_idletasks()
        width = window.winfo_width()
        height = window.winfo_height()
        x = (window.winfo_screenwidth() // 2) - (width // 2)
        y = (window.winfo_screenheight() // 2) - (height // 2)
        window.geometry(f'{width}x{height}+{x}+{y}')
    
    def login_user(self):
        """–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"""
        username = self.login_username.get().strip()
        password = self.login_password.get().strip()
        
        if not username or not password:
            self.speak("–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è", priority=True)
            messagebox.showerror("–û—à–∏–±–∫–∞", "–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è")
            return
        
        if username in self.users:
            hashed_password = self.hash_password(password)
            if self.users[username]["password"] == hashed_password:
                self.logged_in = True
                self.current_user = username
                
                # –û–±–Ω–æ–≤–ª—è–µ–º –≤—Ä–µ–º—è –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ –≤—Ö–æ–¥–∞
                self.users[username]["last_login"] = datetime.now().strftime("%Y-%m-%d %H:%M:%S")
                self.save_users()
                
                # –ó–∞–≥—Ä—É–∂–∞–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
                self.load_settings()
                
                # –ó–∞–∫—Ä—ã–≤–∞–µ–º –æ–∫–Ω–æ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
                if hasattr(self, 'auth_window') and self.auth_window.winfo_exists():
                    self.auth_window.destroy()
                
                # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
                self.text_anim.show_transition(f"–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, {username}!", 2)
                self.speak(f"–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, {username}!")
                
                # –ù–µ–±–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –ø–µ—Ä–µ–¥ –ø–æ–∫–∞–∑–æ–º –≤—ã–±–æ—Ä–∞ —Ä–µ–∂–∏–º–∞
                self.root.after(2500, self.show_mode_selection)
                return
        
        self.speak("–ù–µ–≤–µ—Ä–Ω–æ–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–ª–∏ –ø–∞—Ä–æ–ª—å", priority=True)
        messagebox.showerror("–û—à–∏–±–∫–∞", "–ù–µ–≤–µ—Ä–Ω–æ–µ –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏–ª–∏ –ø–∞—Ä–æ–ª—å")
    
    def register_user(self):
        """–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –Ω–æ–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π —Å–æ–≥–ª–∞—à–µ–Ω–∏—è"""
        username = self.reg_username.get().strip()
        password = self.reg_password.get().strip()
        password_confirm = self.reg_password_confirm.get().strip()
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã—Ö –ø–æ–ª–µ–π
        if not username or not password:
            self.speak("–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è", priority=True)
            messagebox.showerror("–û—à–∏–±–∫–∞", "–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è")
            return
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–ª–∏–Ω—ã –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        if len(username) < 3:
            self.speak("–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –Ω–µ –º–µ–Ω–µ–µ 3 —Å–∏–º–≤–æ–ª–æ–≤", priority=True)
            messagebox.showerror("–û—à–∏–±–∫–∞", "–ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –Ω–µ –º–µ–Ω–µ–µ 3 —Å–∏–º–≤–æ–ª–æ–≤")
            return
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–ª–∏–Ω—ã –ø–∞—Ä–æ–ª—è
        if len(password) < 6:
            self.speak("–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–µ –º–µ–Ω–µ–µ 6 —Å–∏–º–≤–æ–ª–æ–≤", priority=True)
            messagebox.showerror("–û—à–∏–±–∫–∞", "–ü–∞—Ä–æ–ª—å –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–µ –º–µ–Ω–µ–µ 6 —Å–∏–º–≤–æ–ª–æ–≤")
            return
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è –ø–∞—Ä–æ–ª–µ–π
        if password != password_confirm:
            self.speak("–ü–∞—Ä–æ–ª–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç", priority=True)
            messagebox.showerror("–û—à–∏–±–∫–∞", "–ü–∞—Ä–æ–ª–∏ –Ω–µ —Å–æ–≤–ø–∞–¥–∞—é—Ç")
            return
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ —Å–æ–≥–ª–∞—à–µ–Ω–∏—è
        if not self.reg_terms.get():
            self.speak("–í—ã –¥–æ–ª–∂–Ω—ã –ø—Ä–∏–Ω—è—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–µ —Å–æ–≥–ª–∞—à–µ–Ω–∏–µ", priority=True)
            messagebox.showerror("–û—à–∏–±–∫–∞", "–í—ã –¥–æ–ª–∂–Ω—ã –ø—Ä–∏–Ω—è—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–µ —Å–æ–≥–ª–∞—à–µ–Ω–∏–µ")
            self.safe_after(100, lambda: self.show_terms_of_service(self.auth_window))
            return
        
        # –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        if username in self.users:
            self.speak("–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–∏–º –∏–º–µ–Ω–µ–º —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç", priority=True)
            messagebox.showerror("–û—à–∏–±–∫–∞", "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å —Ç–∞–∫–æ–≥–æ –∏–º–µ–Ω–∏ —É–∂–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç")
            return
        
        # –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        self.users[username] = {
            "password": self.hash_password(password),
            "created_at": datetime.now().strftime("%Y-%m-%d %H:%M:%S"),
            "last_login": datetime.now().strftime("%Y-%m-%d %H:%M:%S"),
            "settings": self.settings.copy(),
            "terms_accepted": True,
            "terms_accepted_date": datetime.now().strftime("%Y-%m-%d %H:%M:%S")
        }
        
        self.save_users()
        
        # –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—Ö–æ–¥
        self.logged_in = True
        self.current_user = username
        
        # –ó–∞–∫—Ä—ã–≤–∞–µ–º –æ–∫–Ω–æ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
        if hasattr(self, 'auth_window') and self.auth_window.winfo_exists():
            try:
                self.auth_window.destroy()
            except:
                pass
        
        # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é
        self.text_anim.show_transition(f"–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–∞!\n–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, {username}!", 3)
        self.speak(f"–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø—Ä–æ—à–ª–∞ —É—Å–ø–µ—à–Ω–æ! –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, {username}!")
        
        # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± —É—Å–ø–µ—Ö–µ
        self.root.after(3500, lambda: messagebox.showinfo(
            "–£—Å–ø–µ—à–Ω–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è", 
            f"–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø—Ä–æ—à–ª–∞ —É—Å–ø–µ—à–Ω–æ!\n\n"
            f"–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, {username}!\n"
            f"–¢–µ–ø–µ—Ä—å –≤—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –ê—Ç–æ–º v4.0 PRO.")
        )
        
        self.root.after(3500, self.show_mode_selection)
    
    def guest_login(self):
        """–ì–æ—Å—Ç–µ–≤–æ–π –¥–æ—Å—Ç—É–ø"""
        self.logged_in = False
        self.current_user = None
        
        if hasattr(self, 'auth_window') and self.auth_window.winfo_exists():
            self.auth_window.destroy()
        
        # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é –¥–ª—è –≥–æ—Å—Ç—è
        self.text_anim.show_transition("–ì–æ—Å—Ç–µ–≤–æ–π –¥–æ—Å—Ç—É–ø", 2)
        self.speak("–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –≥–æ—Å—Ç–µ–≤–æ–π —Ä–µ–∂–∏–º!")
        self.root.after(2500, self.show_mode_selection)
    
    def show_terms_of_service(self, parent_window=None):
        """–ü–æ–∫–∞–∑–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–µ —Å–æ–≥–ª–∞—à–µ–Ω–∏–µ"""
        try:
            # –ï—Å–ª–∏ –æ–∫–Ω–æ —É–∂–µ –æ—Ç–∫—Ä—ã—Ç–æ, –ø—Ä–æ—Å—Ç–æ –ø–æ–¥–Ω–∏–º–∞–µ–º –µ–≥–æ
            if hasattr(self, '_terms_window') and self._terms_window and self._terms_window.winfo_exists():
                try:
                    self._terms_window.lift()
                    self._terms_window.focus_set()
                    return
                except:
                    pass
            
            if parent_window is None:
                parent_window = self.root
            
            self._terms_window = tk.Toplevel(parent_window)
            self._terms_window.title("–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–µ —Å–æ–≥–ª–∞—à–µ–Ω–∏–µ - –ê—Ç–æ–º v4.0 PRO")
            self._terms_window.geometry("700x550")
            self._terms_window.configure(bg=self.colors['bg'])
            
            # –¶–µ–Ω—Ç—Ä–∏—Ä—É–µ–º –æ–∫–Ω–æ
            self.center_window(self._terms_window)
            
            # Canvas –¥–ª—è —Ñ–æ–Ω–∞
            canvas = tk.Canvas(self._terms_window, bg=self.colors['bg'], highlightthickness=0)
            canvas.pack(fill=tk.BOTH, expand=True)
            
            # –ó–∞–≥–æ–ª–æ–≤–æ–∫
            canvas.create_text(350, 40,
                             text="üìú –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–¨–°–ö–û–ï –°–û–ì–õ–ê–®–ï–ù–ò–ï",
                             fill=self.colors['primary_light'],
                             font=('Segoe UI', 18, 'bold'))
            
            # –¢–µ–∫—Å—Ç —Å–æ–≥–ª–∞—à–µ–Ω–∏—è
            terms_text = scrolledtext.ScrolledText(
                canvas,
                height=20,
                width=80,
                bg=self.colors['bg_lighter'],
                fg=self.colors['text'],
                font=("Segoe UI", 10),
                wrap=tk.WORD,
                relief=tk.FLAT,
                borderwidth=0,
                padx=15,
                pady=15
            )
            canvas.create_window(350, 280, window=terms_text, width=650, height=400)
            
            # –¢–µ–∫—Å—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ —Å–æ–≥–ª–∞—à–µ–Ω–∏—è
            terms_content = """–ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–¨–°–ö–û–ï –°–û–ì–õ–ê–®–ï–ù–ò–ï
–¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≥–æ–ª–æ—Å–æ–≤–æ–≥–æ –ø–æ–º–æ—â–Ω–∏–∫–∞ "–ê—Ç–æ–º v4.0 PRO"

–î–∞—Ç–∞ –≤—Å—Ç—É–ø–ª–µ–Ω–∏—è –≤ —Å–∏–ª—É: 1 —è–Ω–≤–∞—Ä—è 2024 –≥.

1. –û–ë–©–ò–ï –ü–û–õ–û–ñ–ï–ù–ò–Ø

1.1. –ù–∞—Å—Ç–æ—è—â–µ–µ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–µ —Å–æ–≥–ª–∞—à–µ–Ω–∏–µ (–¥–∞–ª–µ–µ ‚Äì "–°–æ–≥–ª–∞—à–µ–Ω–∏–µ") —Ä–µ–≥—É–ª–∏—Ä—É–µ—Ç –æ—Ç–Ω–æ—à–µ–Ω–∏—è –º–µ–∂–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º (–¥–∞–ª–µ–µ ‚Äì "–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å") –∏ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–º –≥–æ–ª–æ—Å–æ–≤–æ–≥–æ –ø–æ–º–æ—â–Ω–∏–∫–∞ "–ê—Ç–æ–º v4.0 PRO" (–¥–∞–ª–µ–µ ‚Äì "–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫") –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –ø—Ä–æ–≥—Ä–∞–º–º—ã.

1.2. –ò—Å–ø–æ–ª—å–∑—É—è –ø—Ä–æ–≥—Ä–∞–º–º—É "–ê—Ç–æ–º v4.0 PRO", –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç, —á—Ç–æ –ø—Ä–æ—á–∏—Ç–∞–ª, –ø–æ–Ω—è–ª –∏ —Å–æ–≥–ª–∞—Å–µ–Ω —Å —É—Å–ª–æ–≤–∏—è–º–∏ –Ω–∞—Å—Ç–æ—è—â–µ–≥–æ –°–æ–≥–ª–∞—à–µ–Ω–∏—è.

2. –†–ï–ì–ò–°–¢–†–ê–¶–ò–Ø –ò –£–ß–ï–¢–ù–ê–Ø –ó–ê–ü–ò–°–¨

2.1. –î–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤—Å–µ—Ö —Ñ—É–Ω–∫—Ü–∏–π –ø—Ä–æ–≥—Ä–∞–º–º—ã —Ç—Ä–µ–±—É–µ—Ç—Å—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —É—á–µ—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏.

2.2. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ–±—è–∑—É–µ—Ç—Å—è –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—Ç—å –¥–æ—Å—Ç–æ–≤–µ—Ä–Ω—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –ø—Ä–∏ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏.

2.3. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–∞–º–æ—Å—Ç–æ—è—Ç–µ–ª—å–Ω–æ –Ω–µ—Å–µ—Ç –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å –∑–∞ —Å–æ—Ö—Ä–∞–Ω–Ω–æ—Å—Ç—å —Å–≤–æ–∏—Ö —É—á–µ—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.

2.4. –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–µ –Ω–µ—Å–µ—Ç –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å –∑–∞ –Ω–µ—Å–∞–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ —É—á–µ—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

3. –ü–†–ê–í–ê –ò –û–ë–Ø–ó–ê–ù–ù–û–°–¢–ò –ü–û–õ–¨–ó–û–í–ê–¢–ï–õ–Ø

3.1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏–º–µ–µ—Ç –ø—Ä–∞–≤–æ:
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É –≤ –ª–∏—á–Ω—ã—Ö –Ω–µ–∫–æ–º–º–µ—Ä—á–µ—Å–∫–∏—Ö —Ü–µ–ª—è—Ö;
- –°–æ–∑–¥–∞–≤–∞—Ç—å —Ä–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏ —Å–≤–æ–∏—Ö –¥–∞–Ω–Ω—ã—Ö;
- –û–±—Ä–∞—â–∞—Ç—å—Å—è –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É –ø–æ –≤–æ–ø—Ä–æ—Å–∞–º —Ä–∞–±–æ—Ç—ã –ø—Ä–æ–≥—Ä–∞–º–º—ã.

3.2. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ–±—è–∑—É–µ—Ç—Å—è:
- –ù–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—É –¥–ª—è –ø—Ä–æ—Ç–∏–≤–æ–ø—Ä–∞–≤–Ω–æ–π –¥–µ—è—Ç–µ–ª—å–Ω–æ—Å—Ç–∏;
- –ù–µ —Ä–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω—è—Ç—å –≤—Ä–µ–¥–æ–Ω–æ—Å–Ω–æ–µ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–µ –æ–±–µ—Å–ø–µ—á–µ–Ω–∏–µ;
- –ù–µ –ø—ã—Ç–∞—Ç—å—Å—è –≤–∑–ª–æ–º–∞—Ç—å –∏–ª–∏ –æ–±–æ–π—Ç–∏ –∑–∞—â–∏—Ç—É –ø—Ä–æ–≥—Ä–∞–º–º—ã;
- –ù–µ –Ω–∞—Ä—É—à–∞—Ç—å –∞–≤—Ç–æ—Ä—Å–∫–∏–µ –ø—Ä–∞–≤–∞ —Ç—Ä–µ—Ç—å–∏—Ö –ª–∏—Ü.

4. –û–ì–†–ê–ù–ò–ß–ï–ù–ò–Ø –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Ø

4.1. –ü—Ä–æ–≥—Ä–∞–º–º–∞ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è "–∫–∞–∫ –µ—Å—Ç—å" (as is).

4.2. –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–µ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –±–µ—Å–ø–µ—Ä–µ–±–æ–π–Ω—É—é —Ä–∞–±–æ—Ç—É –ø—Ä–æ–≥—Ä–∞–º–º—ã.

4.3. –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ –æ—Å—Ç–∞–≤–ª—è–µ—Ç –∑–∞ —Å–æ–±–æ–π –ø—Ä–∞–≤–æ –≤–Ω–æ—Å–∏—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ –ø—Ä–æ–≥—Ä–∞–º–º—É –±–µ–∑ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–≥–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è.

5. –ö–û–ù–§–ò–î–ï–ù–¶–ò–ê–õ–¨–ù–û–°–¢–¨

5.1. –í—Å–µ –¥–∞–Ω–Ω—ã–µ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Ö—Ä–∞–Ω—è—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ –Ω–∞ –µ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ.

5.2. –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–µ —Å–æ–±–∏—Ä–∞–µ—Ç –∏ –Ω–µ –ø–µ—Ä–µ–¥–∞–µ—Ç –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Ç—Ä–µ—Ç—å–∏–º –ª–∏—Ü–∞–º.

5.3. –•–µ—à–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–∞—Ä–æ–ª–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –ª–æ–∫–∞–ª—å–Ω–æ–º —Ñ–∞–π–ª–µ –¥–ª—è —Ü–µ–ª–µ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏.

6. –ê–í–¢–û–†–°–ö–ò–ï –ü–†–ê–í–ê

6.1. –í—Å–µ –ø—Ä–∞–≤–∞ –Ω–∞ –ø—Ä–æ–≥—Ä–∞–º–º—É "–ê—Ç–æ–º v4.0 PRO" –ø—Ä–∏–Ω–∞–¥–ª–µ–∂–∞—Ç –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫—É.

6.2. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –ø—Ä–∞–≤–æ –Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å —É—Å–ª–æ–≤–∏—è–º–∏ –Ω–∞—Å—Ç–æ—è—â–µ–≥–æ –°–æ–≥–ª–∞—à–µ–Ω–∏—è.

7. –û–¢–í–ï–¢–°–¢–í–ï–ù–ù–û–°–¢–¨

7.1. –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–µ –Ω–µ—Å–µ—Ç –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏ –∑–∞:
- –£–±—ã—Ç–∫–∏, –≤–æ–∑–Ω–∏–∫—à–∏–µ –≤ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø—Ä–æ–≥—Ä–∞–º–º—ã;
- –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º—ã;
- –î–µ–π—Å—Ç–≤–∏—è —Ç—Ä–µ—Ç—å–∏—Ö –ª–∏—Ü.

7.2. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –ø—Ä–æ–≥—Ä–∞–º–º—É –Ω–∞ —Å–≤–æ–π —Å–æ–±—Å—Ç–≤–µ–Ω–Ω—ã–π —Ä–∏—Å–∫.

8. –ó–ê–ö–õ–Æ–ß–ò–¢–ï–õ–¨–ù–´–ï –ü–û–õ–û–ñ–ï–ù–ò–Ø

8.1. –ù–∞—Å—Ç–æ—è—â–µ–µ –°–æ–≥–ª–∞—à–µ–Ω–∏–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –∏–∑–º–µ–Ω–µ–Ω–æ –†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–º –±–µ–∑ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–≥–æ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è.

8.2. –ü—Ä–æ–¥–æ–ª–∂–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ø—Ä–æ–≥—Ä–∞–º–º—ã –ø–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π –æ–∑–Ω–∞—á–∞–µ—Ç —Å–æ–≥–ª–∞—Å–∏–µ —Å –Ω–æ–≤—ã–º–∏ —É—Å–ª–æ–≤–∏—è–º–∏.

8.3. –í —Å–ª—É—á–∞–µ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏—è —Å–ø–æ—Ä–æ–≤, —Å—Ç–æ—Ä–æ–Ω—ã –±—É–¥—É—Ç —Å—Ç—Ä–µ–º–∏—Ç—å—Å—è —Ä–µ—à–∏—Ç—å –∏—Ö –ø—É—Ç–µ–º –ø–µ—Ä–µ–≥–æ–≤–æ—Ä–æ–≤.

–î–ª—è —Å–≤—è–∑–∏ —Å —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–º: atom.support@example.com

–ù–∞–∂–∏–º–∞—è "–Ø —Å–æ–≥–ª–∞—Å–µ–Ω", –í—ã –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç–µ, —á—Ç–æ –ø—Ä–æ—á–∏—Ç–∞–ª–∏ –∏ –ø—Ä–∏–Ω–∏–º–∞–µ—Ç–µ —É—Å–ª–æ–≤–∏—è –¥–∞–Ω–Ω–æ–≥–æ –°–æ–≥–ª–∞—à–µ–Ω–∏—è."""
            
            terms_text.insert(tk.END, terms_content)
            terms_text.config(state=tk.DISABLED)
            
            # –§—Ä–µ–π–º –¥–ª—è –∫–Ω–æ–ø–æ–∫
            buttons_frame = tk.Frame(canvas, bg=self.colors['bg'])
            canvas.create_window(350, 520, window=buttons_frame)
            
            def accept_terms():
                try:
                    if hasattr(self, 'reg_terms'):
                        self.reg_terms.set(True)
                    self.speak("–í—ã –ø—Ä–∏–Ω—è–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–µ —Å–æ–≥–ª–∞—à–µ–Ω–∏–µ!")
                    messagebox.showinfo("–°–æ–≥–ª–∞—à–µ–Ω–∏–µ", "–í—ã –ø—Ä–∏–Ω—è–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–µ —Å–æ–≥–ª–∞—à–µ–Ω–∏–µ!")
                    
                    # –ó–∞–∫—Ä—ã–≤–∞–µ–º –æ–∫–Ω–æ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –ø–æ—Ç–æ–∫–µ
                    self.safe_after(0, lambda: self._terms_window.destroy() if hasattr(self, '_terms_window') and self._terms_window else None)
                except Exception as e:
                    print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–∏–Ω—è—Ç–∏–∏ —Å–æ–≥–ª–∞—à–µ–Ω–∏—è: {e}")
            
            def print_terms():
                try:
                    self.speak("–î–ª—è –ø–µ—á–∞—Ç–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏—é Ctrl+P")
                    messagebox.showinfo("–ü–µ—á–∞—Ç—å", "–î–ª—è –ø–µ—á–∞—Ç–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏—é Ctrl+P –≤ –æ–∫–Ω–µ —Å–æ–≥–ª–∞—à–µ–Ω–∏—è")
                except Exception as e:
                    print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–µ—á–∞—Ç–∏: {e}")
            
            def close_window():
                try:
                    if hasattr(self, '_terms_window') and self._terms_window and self._terms_window.winfo_exists():
                        self._terms_window.destroy()
                except:
                    pass
            
            # –ö–Ω–æ–ø–∫–∏ —Å —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º –¥–∏–∑–∞–π–Ω–æ–º
            accept_btn = tk.Canvas(buttons_frame, bg=self.colors['bg'], highlightthickness=0, width=180, height=35)
            accept_btn.pack(side=tk.LEFT, padx=5)
            accept_btn.create_rectangle(0, 0, 179, 34, fill=self.colors['success'], outline='')
            accept_btn.create_text(90, 17, text="‚úÖ –ü—Ä–∏–Ω—è—Ç—å —Å–æ–≥–ª–∞—à–µ–Ω–∏–µ", fill="white", font=('Segoe UI', 10, 'bold'))
            accept_btn.bind("<Button-1>", lambda e: accept_terms())
            accept_btn.bind("<Enter>", lambda e: accept_btn.config(cursor="hand2"))
            
            close_btn = tk.Canvas(buttons_frame, bg=self.colors['bg'], highlightthickness=0, width=100, height=35)
            close_btn.pack(side=tk.LEFT, padx=5)
            close_btn.create_rectangle(0, 0, 99, 34, fill=self.colors['danger'], outline='')
            close_btn.create_text(50, 17, text="‚ùå –ó–∞–∫—Ä—ã—Ç—å", fill="white", font=('Segoe UI', 10, 'bold'))
            close_btn.bind("<Button-1>", lambda e: close_window())
            close_btn.bind("<Enter>", lambda e: close_btn.config(cursor="hand2"))
            
            # –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è –æ–∫–Ω–∞
            def on_window_close():
                close_window()
                # –û—Å–≤–æ–±–æ–∂–¥–∞–µ–º —Å—Å—ã–ª–∫—É
                if hasattr(self, '_terms_window'):
                    delattr(self, '_terms_window')
            
            self._terms_window.protocol("WM_DELETE_WINDOW", on_window_close)
            
        except Exception as e:
            print(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–∫–∞–∑–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–≥–æ —Å–æ–≥–ª–∞—à–µ–Ω–∏—è: {e}")
            # –ü—ã—Ç–∞–µ–º—Å—è –ø–æ–∫–∞–∑–∞—Ç—å –ø—Ä–æ—Å—Ç–æ–µ –æ–∫–Ω–æ —Å–æ–æ–±—â–µ–Ω–∏—è
            try:
                messagebox.showerror("–û—à–∏–±–∫–∞", f"–ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–∫—Ä—ã—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–µ —Å–æ–≥–ª–∞—à–µ–Ω–∏–µ: {e}")
            except:
                pass
    
    def show_mode_selection(self):
        """–ü–æ–∫–∞–∑ –æ–∫–Ω–∞ –≤—ã–±–æ—Ä–∞ —Ä–µ–∂–∏–º–∞ –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ"""
        # –°–æ–∑–¥–∞–µ–º –æ–∫–Ω–æ –≤—ã–±–æ—Ä–∞ —Ä–µ–∂–∏–º–∞
        self.selection_window = tk.Toplevel(self.root)
        title = "–ê—Ç–æ–º v4.0 PRO - –í—ã–±–æ—Ä —Ä–µ–∂–∏–º–∞"
        self.selection_window.title(title)
        self.selection_window.geometry("600x700")
        self.selection_window.configure(bg="#0f172a")
        self.selection_window.attributes('-topmost', True)
        self.selection_window.resizable(False, False)
        
        # –¶–µ–Ω—Ç—Ä–∏—Ä—É–µ–º –æ–∫–Ω–æ
        self.center_window(self.selection_window)
        
        # Canvas –¥–ª—è —Ñ–æ–Ω–∞
        canvas = tk.Canvas(self.selection_window, bg="#0f172a", highlightthickness=0)
        canvas.pack(fill=tk.BOTH, expand=True)
        
        # –ó–∞–≥–æ–ª–æ–≤–æ–∫ —Å –∏–º–µ–Ω–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        if self.logged_in:
            title_text = f"‚öõÔ∏è –ê—Ç–æ–º v4.0 PRO - {self.current_user}"
        else:
            title_text = "‚öõÔ∏è –ê—Ç–æ–º v4.0 PRO - –ì–æ—Å—Ç—å"
        
        canvas.create_text(300, 100,
                          text=title_text,
                          fill="#ffffff",
                          font=('Segoe UI', 28, 'bold'))
        
        # –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
        if self.logged_in:
            user_info = tk.Label(canvas,
                                text=f"üë§ –í—ã –≤–æ—à–ª–∏ –∫–∞–∫: {self.current_user}",
                                bg='#0f172a',
                                fg='#60a5fa',
                                font=('Segoe UI', 12))
            canvas.create_window(300, 140, window=user_info)
        
        canvas.create_text(300, 180,
                          text="–í—ã–±–µ—Ä–∏—Ç–µ —Ä–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã:",
                          fill="#94a3b8",
                          font=('Segoe UI', 14))
        
        # –§—Ä–µ–π–º –¥–ª—è –∫–∞—Ä—Ç–æ—á–µ–∫ —Ä–µ–∂–∏–º–æ–≤
        cards_frame = tk.Frame(canvas, bg='#0f172a')
        canvas.create_window(300, 400, window=cards_frame)
        
        # –ö–∞—Ä—Ç–æ—á–∫–∞ –¥–µ–º–æ-—Ä–µ–∂–∏–º–∞
        demo_card = tk.Canvas(cards_frame, bg='#0f172a', highlightthickness=0, width=500, height=180)
        demo_card.grid(row=0, column=0, pady=10)
        
        # –§–æ–Ω –∫–∞—Ä—Ç–æ—á–∫–∏
        demo_card.create_rectangle(0, 0, 499, 179, fill='#1e293b', outline='')
        
        # –ò–∫–æ–Ω–∫–∞ –∏ –∑–∞–≥–æ–ª–æ–≤–æ–∫
        demo_card.create_text(50, 45,
                             text="üé¨",
                             fill="#f59e0b",
                             font=('Segoe UI Emoji', 24))
        
        demo_card.create_text(200, 45,
                             text="–î–ï–ú–û–ù–°–¢–†–ê–¶–ò–û–ù–ù–´–ô –†–ï–ñ–ò–ú",
                             fill="#ffffff",
                             font=('Segoe UI', 16, 'bold'),
                             anchor="w")
        
        # –û–ø–∏—Å–∞–Ω–∏–µ
        demo_card.create_text(200, 85,
                             text="‚Ä¢ –ì–æ–ª–æ—Å–æ–≤–∞—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è\n‚Ä¢ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è\n‚Ä¢ –î–µ–º–æ-—Ñ—É–Ω–∫—Ü–∏–∏\n‚Ä¢ –û–±—É—á–∞—é—â–∏–µ –≤–∏–¥–µ–æ\n‚Ä¢ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π",
                             fill="#cbd5e1",
                             font=('Segoe UI', 11),
                             anchor="w")
        
        # –ö–Ω–æ–ø–∫–∞ –≤—ã–±–æ—Ä–∞
        demo_btn = tk.Canvas(demo_card, bg='#1e293b', highlightthickness=0, width=120, height=35)
        demo_card.create_window(400, 140, window=demo_btn)
        demo_btn.create_rectangle(0, 0, 119, 34, fill='#f59e0b', outline='')
        demo_btn.create_text(60, 17, text="–í—ã–±—Ä–∞—Ç—å", fill="white", font=('Segoe UI', 10, 'bold'))
        demo_btn.bind("<Button-1>", lambda e: self.start_with_mode(True))
        demo_btn.bind("<Enter>", lambda e: demo_btn.config(cursor="hand2"))
        
        # –ö–∞—Ä—Ç–æ—á–∫–∞ —Ä–∞–±–æ—á–µ–≥–æ —Ä–µ–∂–∏–º–∞
        work_card = tk.Canvas(cards_frame, bg='#0f172a', highlightthickness=0, width=500, height=180)
        work_card.grid(row=1, column=0, pady=10)
        
        # –§–æ–Ω –∫–∞—Ä—Ç–æ—á–∫–∏
        work_card.create_rectangle(0, 0, 499, 179, fill='#1e293b', outline='')
        
        # –ò–∫–æ–Ω–∫–∞ –∏ –∑–∞–≥–æ–ª–æ–≤–æ–∫
        work_card.create_text(50, 45,
                             text="‚ö°",
                             fill="#10b981",
                             font=('Segoe UI Emoji', 24))
        
        work_card.create_text(200, 45,
                             text="–†–ê–ë–û–ß–ò–ô –†–ï–ñ–ò–ú",
                             fill="#ffffff",
                             font=('Segoe UI', 16, 'bold'),
                             anchor="w")
        
        # –û–ø–∏—Å–∞–Ω–∏–µ
        work_card.create_text(200, 85,
                             text="‚Ä¢ –†–µ–∞–ª—å–Ω–∞—è –ø–æ–≥–æ–¥–∞\n‚Ä¢ –ü–æ–∏—Å–∫ –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ\n‚Ä¢ –û—Ç–∫—Ä—ã—Ç–∏–µ —Å–∞–π—Ç–æ–≤\n‚Ä¢ –í–∏–¥–µ–æ–ø–ª–µ–µ—Ä\n‚Ä¢ –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä\n‚Ä¢ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∞–π—Ç–æ–≤\n‚Ä¢ –ù–∞—Å—Ç—Ä–æ–π–∫–∏\n‚Ä¢ –ì–û–õ–û–°–û–í–û–ô –ü–û–ú–û–©–ù–ò–ö\n‚Ä¢ –ò–ò-–ê–°–°–ò–°–¢–ï–ù–¢\n‚Ä¢ ü§ñ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –∑–∞–¥–∞—á\n‚Ä¢ üíª –†–µ–¥–∞–∫—Ç–æ—Ä –∫–æ–¥–∞",
                             fill="#cbd5e1",
                             font=('Segoe UI', 11),
                             anchor="w")
        
        # –ö–Ω–æ–ø–∫–∞ –≤—ã–±–æ—Ä–∞
        work_btn = tk.Canvas(work_card, bg='#1e293b', highlightthickness=0, width=120, height=35)
        work_card.create_window(400, 140, window=work_btn)
        work_btn.create_rectangle(0, 0, 119, 34, fill='#10b981', outline='')
        work_btn.create_text(60, 17, text="–í—ã–±—Ä–∞—Ç—å", fill="white", font=('Segoe UI', 10, 'bold'))
        work_btn.bind("<Button-1>", lambda e: self.start_with_mode(False))
        work_btn.bind("<Enter>", lambda e: work_btn.config(cursor="hand2"))
        
        # –ö–Ω–æ–ø–∫–∞ —Å–º–µ–Ω—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        if self.logged_in:
            logout_btn = tk.Label(canvas,
                                text="üîÑ –°–º–µ–Ω–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è",
                                bg='#0f172a',
                                fg='#ef4444',
                                font=('Segoe UI', 10),
                                cursor="hand2")
            canvas.create_window(300, 620, window=logout_btn)
            logout_btn.bind("<Button-1>", lambda e: self.logout_user())
        
        # –í–µ—Ä—Å–∏—è
        version_label = tk.Label(canvas,
                                text="–í–µ—Ä—Å–∏—è 4.0 PRO | ¬© 2024 | –° —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏ –ò–ò",
                                bg='#0f172a',
                                fg='#64748b',
                                font=('Segoe UI', 9))
        canvas.create_window(300, 670, window=version_label)
        
        # –ë–ª–æ–∫–∏—Ä—É–µ–º –≥–ª–∞–≤–Ω–æ–µ –æ–∫–Ω–æ
        self.selection_window.grab_set()
        self.selection_window.focus_set()
        
        # –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è –æ–∫–Ω–∞ –≤—ã–±–æ—Ä–∞
        self.selection_window.protocol("WM_DELETE_WINDOW", self.on_selection_window_close)
    
    def on_selection_window_close(self):
        """–û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è –æ–∫–Ω–∞ –≤—ã–±–æ—Ä–∞ —Ä–µ–∂–∏–º–∞"""
        if self.selection_window and self.selection_window.winfo_exists():
            self.selection_window.destroy()
        self.on_closing()
    
    def logout_user(self):
        """–í—ã—Ö–æ–¥ –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞"""
        self.logged_in = False
        self.current_user = None
        
        if hasattr(self, 'selection_window') and self.selection_window.winfo_exists():
            self.selection_window.destroy()
        
        self.speak("–í—ã –≤—ã—à–ª–∏ –∏–∑ –∞–∫–∫–∞—É–Ω—Ç–∞")
        self.show_auth_window()
    
    def start_with_mode(self, demo_mode):
        """–ó–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å –≤—ã–±—Ä–∞–Ω–Ω—ã–º —Ä–µ–∂–∏–º–æ–º"""
        self.demo_mode = demo_mode
        
        # –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—ã–±–æ—Ä —Ä–µ–∂–∏–º–∞
        self.settings["demo_mode"] = demo_mode
        self.save_settings()
        
        # –ó–∞–∫—Ä—ã–≤–∞–µ–º –æ–∫–Ω–æ –≤—ã–±–æ—Ä–∞ —Ä–µ–∂–∏–º–∞
        if hasattr(self, 'selection_window') and self.selection_window.winfo_exists():
            self.selection_window.destroy()
        
        # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é –ø—Ä–∏ —Å–º–µ–Ω–µ —Ä–µ–∂–∏–º–∞
        mode_name = "–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π" if demo_mode else "–†–∞–±–æ—á–∏–π"
        self.text_anim.show_transition(f"{mode_name} —Ä–µ–∂–∏–º", 2)
        self.speak(f"–ó–∞–ø—É—Å–∫ {mode_name.lower()} —Ä–µ–∂–∏–º–∞")
        
        # –ó–∞–≥—Ä—É–∂–∞–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –µ—Å–ª–∏ –µ—Å—Ç—å
        if self.logged_in and self.current_user in self.users:
            user_settings = self.users[self.current_user].get("settings", {})
            if user_settings:
                # –û–±–Ω–æ–≤–ª—è–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏, —Å–æ—Ö—Ä–∞–Ω—è—è –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –¥–ª—è –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏—Ö –∫–ª—é—á–µ–π
                for key, value in user_settings.items():
                    if key in self.settings:
                        self.settings[key] = value
        
        # –ó–∞–ø—É—Å–∫–∞–µ–º –æ—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø–æ—Å–ª–µ –∞–Ω–∏–º–∞—Ü–∏–∏
        self.root.after(2500, self.create_main_interface)
    
    def load_settings(self):
        """–ó–∞–≥—Ä—É–∑–∫–∞ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∏–∑ —Ñ–∞–π–ª–∞"""
        try:
            if os.path.exists(self.settings_file):
                with open(self.settings_file, 'r', encoding='utf-8') as f:
                    loaded_settings = json.load(f)
                    
                    # –û–±—ä–µ–¥–∏–Ω—è–µ–º —Å –¥–µ—Ñ–æ–ª—Ç–Ω—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
                    for key, value in loaded_settings.items():
                        if key in self.settings:
                            self.settings[key] = value
                    
                    # –û–±–Ω–æ–≤–ª—è–µ–º –≥–æ–ª–æ—Å–æ–≤—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
                    if self.speech_engine:
                        self.speech_engine.setProperty('rate', self.settings.get("voice_speed", 150))
                        self.speech_engine.setProperty('volume', self.settings.get("voice_volume", 0.9))
                        
        except Exception as e:
            print(f"–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫: {e}")
    
    def save_settings(self):
        """–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –≤ —Ñ–∞–π–ª"""
        try:
            # –°–æ—Ö—Ä–∞–Ω—è–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –µ—Å–ª–∏ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω
            if self.logged_in and self.current_user in self.users:
                self.users[self.current_user]["settings"] = self.settings
                self.save_users()
            
            # –¢–∞–∫–∂–µ —Å–æ—Ö—Ä–∞–Ω—è–µ–º –≤ –æ–±—â–∏–π —Ñ–∞–π–ª –Ω–∞—Å—Ç—Ä–æ–µ–∫
            with open(self.settings_file, 'w', encoding='utf-8') as f:
                json.dump(self.settings, f, ensure_ascii=False, indent=2)
                
        except Exception as e:
            print(f"–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫: {e}")
    
    def create_main_interface(self):
        """–°–æ–∑–¥–∞–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –ø—Ä–æ–≥—Ä–∞–º–º—ã"""
        # –û—á–∏—â–∞–µ–º –≥–ª–∞–≤–Ω–æ–µ –æ–∫–Ω–æ
        for widget in self.root.winfo_children():
            widget.destroy()
        
        # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ü–≤–µ—Ç–æ–≤–æ–π —Å—Ö–µ–º—ã
        self.setup_colors()
        
        # –°–æ–∑–¥–∞–µ–º –≤–µ—Ä—Ö–Ω—é—é –ø–∞–Ω–µ–ª—å
        self.create_top_panel()
        
        # –°–æ–∑–¥–∞–µ–º –æ—Å–Ω–æ–≤–Ω–æ–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ
        self.create_main_content()
        
        # –°–æ–∑–¥–∞–µ–º —Å—Ç–∞—Ç—É—Å –±–∞—Ä
        self.create_status_bar()
        
        # –î–æ–±–∞–≤–ª—è–µ–º –≥–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏
        self.setup_hotkeys()
        
        # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –≥–ª–∞–≤–Ω–æ–µ –æ–∫–Ω–æ
        self.root.deiconify()
        
        # –ó–∞–ø—É—Å–∫–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –æ—á–µ—Ä–µ–¥–∏ —Å–æ–æ–±—â–µ–Ω–∏–π
        self.process_queue()
        
        # –ó–∞–ø—É—Å–∫–∞–µ–º –≥–æ–ª–æ—Å–æ–≤–æ–≥–æ –ø–æ–º–æ—â–Ω–∏–∫–∞ –µ—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω
        if (SPEECH_AVAILABLE or VOICE_INPUT_AVAILABLE) and self.settings.get("voice_enabled", True) and not self.demo_mode:
            self.voice_assistant_active = True
            self.root.after(1000, self.start_voice_assistant)
        
        # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
        welcome_msg = f"–ê—Ç–æ–º v4.0 PRO –∑–∞–ø—É—â–µ–Ω –≤ {'–¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ–º' if self.demo_mode else '—Ä–∞–±–æ—á–µ–º'} —Ä–µ–∂–∏–º–µ!"
        if self.logged_in:
            welcome_msg += f"\n–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, {self.current_user}!"
        self.message_queue.put(welcome_msg)
        self.speak(welcome_msg)
        
        # –ï—Å–ª–∏ –¥–µ–º–æ-—Ä–µ–∂–∏–º, –∑–∞–ø—É—Å–∫–∞–µ–º –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—é
        if self.demo_mode:
            self.root.after(2000, self.start_demo)
    
    def setup_colors(self):
        """–ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ü–≤–µ—Ç–æ–≤–æ–π —Å—Ö–µ–º—ã"""
        self.colors = {
            'bg': '#0f172a',
            'bg_light': '#1e293b',
            'bg_lighter': '#334155',
            'text': '#f1f5f9',
            'text_secondary': '#94a3b8',
            'primary': '#3b82f6',
            'primary_light': '#60a5fa',
            'success': '#10b981',
            'warning': '#f59e0b',
            'danger': '#ef4444',
            'accent': '#8b5cf6'
        }
    
    def setup_hotkeys(self):
        """–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≥–æ—Ä—è—á–∏—Ö –∫–ª–∞–≤–∏—à"""
        # –ü–∞–Ω–µ–ª—å –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞
        self.root.bind('<Control-q>', lambda e: self.create_quick_access_panel())
        
        # –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
        self.root.bind('<Control-s>', lambda e: self.save_all_data())
        
        # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
        self.root.bind('<Control-r>', lambda e: self.refresh_interface())
        
        # –°–ø—Ä–∞–≤–∫–∞
        self.root.bind('<F1>', lambda e: self.speak("–°–ø—Ä–∞–≤–∫–∞ –æ—Ç–∫—Ä—ã—Ç–∞"))
        
        # –°–∫—Ä–∏–Ω—à–æ—Ç
        self.root.bind('<F2>', lambda e: self.take_screenshot())
    
    def create_top_panel(self):
        """–°–æ–∑–¥–∞–Ω–∏–µ –≤–µ—Ä—Ö–Ω–µ–π –ø–∞–Ω–µ–ª–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è"""
        top_frame = tk.Frame(self.root, bg=self.colors['bg_light'], height=70)
        top_frame.pack(fill=tk.X)
        
        # –õ–æ–≥–æ—Ç–∏–ø –∏ –Ω–∞–∑–≤–∞–Ω–∏–µ
        logo_frame = tk.Frame(top_frame, bg=self.colors['bg_light'])
        logo_frame.pack(side=tk.LEFT, padx=25)
        
        tk.Label(logo_frame, 
                text="‚öõÔ∏è",
                bg=self.colors['bg_light'],
                fg=self.colors['primary_light'],
                font=('Segoe UI Emoji', 28)).pack(side=tk.LEFT, padx=5)
        
        title_text = "–ê—Ç–æ–º v4.0 PRO"
        if self.logged_in:
            title_text += f" | {self.current_user}"
        if self.demo_mode:
            title_text += " | –î–µ–º–æ-—Ä–µ–∂–∏–º"
            
        tk.Label(logo_frame,
                text=title_text,
                bg=self.colors['bg_light'],
                fg=self.colors['text'],
                font=('Segoe UI', 18, 'bold')).pack(side=tk.LEFT)
        
        # –ü–∞–Ω–µ–ª—å –∫–Ω–æ–ø–æ–∫ —Å–ø—Ä–∞–≤–∞
        button_frame = tk.Frame(top_frame, bg=self.colors['bg_light'])
        button_frame.pack(side=tk.RIGHT, padx=20)
        
        # –°–æ–∑–¥–∞–µ–º —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∫–Ω–æ–ø–∫–∏
        buttons = [
            ("‚ö° –ë—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø", self.create_quick_access_panel, self.colors['accent']),
            ("üé§ –ì–æ–ª–æ—Å", self.toggle_voice_assistant, self.colors['accent']),
            ("ü§ñ –ò–ò", self.open_ai_assistant, self.colors['primary']),
            ("‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏", self.open_settings, self.colors['primary']),
            (f"üîÑ {'–í —Ä–∞–±–æ—á–∏–π' if self.demo_mode else '–í –¥–µ–º–æ'}", self.switch_mode, 
             self.colors['success'] if self.demo_mode else self.colors['warning']),
            ("üö™ –í—ã—Ö–æ–¥", self.logout_or_exit, self.colors['danger'])
        ]
        
        for text, command, color in buttons:
            btn = tk.Button(button_frame, text=text, bg=color, fg='white',
                          font=('Segoe UI', 10, 'bold'), bd=0, padx=15, pady=8,
                          cursor="hand2", command=command)
            btn.pack(side=tk.LEFT, padx=5)
    
    def create_main_content(self):
        """–°–æ–∑–¥–∞–Ω–∏–µ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–≥–æ"""
        # –§—Ä–µ–π–º –¥–ª—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞
        content_frame = tk.Frame(self.root, bg=self.colors['bg'])
        content_frame.pack(fill=tk.BOTH, expand=True, padx=20, pady=20)
        
        # –°–æ–∑–¥–∞–µ–º Notebook —Å —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º —Å—Ç–∏–ª–µ–º
        style = ttk.Style()
        style.theme_use('clam')
        style.configure('Modern.TNotebook', background=self.colors['bg_light'], borderwidth=0)
        style.configure('Modern.TNotebook.Tab', 
                       background=self.colors['bg_lighter'],
                       foreground=self.colors['text_secondary'],
                       padding=[25, 10],
                       font=('Segoe UI', 11))
        style.map('Modern.TNotebook.Tab', 
                 background=[('selected', self.colors['primary'])],
                 foreground=[('selected', 'white')])
        
        self.notebook = ttk.Notebook(content_frame, style='Modern.TNotebook')
        self.notebook.pack(fill=tk.BOTH, expand=True)
        
        # –°–æ–∑–¥–∞–µ–º –≤–∫–ª–∞–¥–∫–∏
        self.create_search_tab()
        self.create_social_tab()
        self.create_media_tab()
        self.create_tools_tab()
        self.create_automation_tab()
        self.create_development_tab()
        self.create_ai_tab()
        self.create_help_tab()
        self.create_log_tab()
    
    def create_search_tab(self):
        """–í–∫–ª–∞–¥–∫–∞ –ø–æ–∏—Å–∫–∞ —Å —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–º –¥–∏–∑–∞–π–Ω–æ–º"""
        search_frame = tk.Frame(self.notebook, bg=self.colors['bg'])
        self.notebook.add(search_frame, text='üîç –ü–æ–∏—Å–∫')
        
        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        title_label = tk.Label(search_frame, text="–ü–æ–∏—Å–∫ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏",
                              bg=self.colors['bg'], fg=self.colors['text'],
                              font=('Segoe UI', 24, 'bold'))
        title_label.pack(pady=(20, 30))
        
        # –ö–∞—Ä—Ç–æ—á–∫–∞ –ø–æ–∏—Å–∫–∞
        search_card = tk.Frame(search_frame, bg=self.colors['bg_lighter'], 
                              relief=tk.FLAT, bd=0, padx=20, pady=20)
        search_card.pack(pady=10, padx=50, fill=tk.X)
        
        # –í—ã–±–æ—Ä –ø–æ–∏—Å–∫–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã
        tk.Label(search_card, text="–ü–æ–∏—Å–∫–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞:", 
                bg=self.colors['bg_lighter'], fg=self.colors['text_secondary'],
                font=('Segoe UI', 11)).pack(anchor='w', pady=(0, 10))
        
        self.search_engine_var = tk.StringVar(value=list(self.settings["search_engines"].keys())[0])
        search_combo = ttk.Combobox(search_card, textvariable=self.search_engine_var,
                                   values=list(self.settings["search_engines"].keys()),
                                   state='readonly', width=40, font=('Segoe UI', 10))
        search_combo.pack(anchor='w', pady=(0, 20))
        
        # –ü–æ–ª–µ –≤–≤–æ–¥–∞
        tk.Label(search_card, text="–ü–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å:", 
                bg=self.colors['bg_lighter'], fg=self.colors['text_secondary'],
                font=('Segoe UI', 11)).pack(anchor='w', pady=(0, 10))
        
        self.search_query = tk.StringVar()
        search_entry = tk.Entry(search_card, textvariable=self.search_query,
                               font=('Segoe UI', 12), bg=self.colors['bg'],
                               fg=self.colors['text'], insertbackground=self.colors['text'],
                               relief=tk.FLAT, width=50)
        search_entry.pack(anchor='w', pady=(0, 20))
        
        # –ö–Ω–æ–ø–∫–∏ –ø–æ–∏—Å–∫–∞
        button_frame = tk.Frame(search_card, bg=self.colors['bg_lighter'])
        button_frame.pack()
        
        search_btn = tk.Button(button_frame, text="üîç –ù–∞–π—Ç–∏ –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ", 
                              bg=self.colors['primary'], fg='white',
                              font=('Segoe UI', 10, 'bold'), bd=0, padx=20, pady=10,
                              cursor="hand2", command=self.perform_search)
        search_btn.pack(side=tk.LEFT, padx=10)
        
        voice_btn = tk.Button(button_frame, text="üé§ –ì–æ–ª–æ—Å–æ–≤–æ–π –ø–æ–∏—Å–∫", 
                             bg=self.colors['accent'], fg='white',
                             font=('Segoe UI', 10, 'bold'), bd=0, padx=20, pady=10,
                             cursor="hand2", command=self.voice_search)
        voice_btn.pack(side=tk.LEFT, padx=10)
        
        # –ë—ã—Å—Ç—Ä—ã–π –ø–æ–∏—Å–∫
        quick_frame = tk.Frame(search_frame, bg=self.colors['bg'])
        quick_frame.pack(pady=40)
        
        tk.Label(quick_frame, text="–ë—ã—Å—Ç—Ä—ã–π –ø–æ–∏—Å–∫:", 
                bg=self.colors['bg'], fg=self.colors['text'],
                font=('Segoe UI', 16, 'bold')).pack(pady=(0, 20))
        
        # –ö–Ω–æ–ø–∫–∏ –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞
        quick_buttons = [
            ("üå§Ô∏è –ü–æ–≥–æ–¥–∞", self.open_weather),
            ("üì∞ –ù–æ–≤–æ—Å—Ç–∏", lambda: self.search_query.set("–Ω–æ–≤–æ—Å—Ç–∏")),
            ("üé¨ –í–∏–¥–µ–æ", lambda: self.search_query.set("–≤–∏–¥–µ–æ")),
            ("üó∫Ô∏è –ö–∞—Ä—Ç—ã", lambda: self.search_query.set("–∫–∞—Ä—Ç—ã")),
            ("ü§ñ DeepSeek", self.open_deepseek),
            ("üßÆ –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä", self.open_calculator),
            ("üåê –ë—Ä–∞—É–∑–µ—Ä", self.open_browser_window),
            ("üìù –ë–ª–æ–∫–Ω–æ—Ç", self.open_notepad)
        ]
        
        for i, (text, command) in enumerate(quick_buttons):
            row, col = divmod(i, 4)
            
            if col == 0:
                row_frame = tk.Frame(quick_frame, bg=self.colors['bg'])
                row_frame.pack(pady=5)
            
            btn = tk.Button(row_frame, text=text, bg=self.colors['bg_lighter'], 
                          fg=self.colors['primary'], font=('Segoe UI', 10),
                          bd=0, padx=15, pady=8, cursor="hand2", command=command)
            btn.pack(side=tk.LEFT, padx=5)
    
    def create_automation_tab(self):
        """–í–∫–ª–∞–¥–∫–∞ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏"""
        auto_frame = tk.Frame(self.notebook, bg=self.colors['bg'])
        self.notebook.add(auto_frame, text='ü§ñ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è')
        
        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        title_label = tk.Label(auto_frame, text="–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –∑–∞–¥–∞—á",
                              bg=self.colors['bg'], fg=self.colors['text'],
                              font=('Segoe UI', 24, 'bold'))
        title_label.pack(pady=(20, 30))
        
        # –°–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á
        tasks_frame = tk.Frame(auto_frame, bg=self.colors['bg_lighter'],
                              relief=tk.FLAT, bd=0, padx=20, pady=20)
        tasks_frame.pack(pady=10, padx=50, fill=tk.BOTH, expand=True)
        
        tk.Label(tasks_frame, text="üìã –ó–∞–¥–∞—á–∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏",
                bg=self.colors['bg_lighter'], fg=self.colors['text'],
                font=('Segoe UI', 16, 'bold')).pack(anchor='w', pady=(0, 20))
        
        # –°–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á
        self.tasks_listbox = tk.Listbox(tasks_frame,
                                       bg=self.colors['bg'],
                                       fg=self.colors['text'],
                                       font=('Segoe UI', 10),
                                       height=8,
                                       relief=tk.FLAT)
        self.tasks_listbox.pack(fill=tk.BOTH, expand=True, pady=(0, 20))
        
        # –ü–æ–ª–µ –¥–ª—è –Ω–æ–≤–æ–π –∑–∞–¥–∞—á–∏
        input_frame = tk.Frame(tasks_frame, bg=self.colors['bg_lighter'])
        input_frame.pack(fill=tk.X)
        
        self.new_task_var = tk.StringVar()
        task_entry = tk.Entry(input_frame, textvariable=self.new_task_var,
                            font=('Segoe UI', 11), bg=self.colors['bg'],
                            fg=self.colors['text'], width=40)
        task_entry.pack(side=tk.LEFT, padx=(0, 10), fill=tk.X, expand=True)
        
        # –ö–Ω–æ–ø–∫–∏
        buttons_frame = tk.Frame(tasks_frame, bg=self.colors['bg_lighter'])
        buttons_frame.pack()
        
        add_btn = tk.Button(buttons_frame, text="‚ûï –î–æ–±–∞–≤–∏—Ç—å",
                          bg=self.colors['success'], fg='white',
                          font=('Segoe UI', 10), bd=0, padx=15, pady=8,
                          cursor="hand2", command=self.add_automation_task)
        add_btn.pack(side=tk.LEFT, padx=5)
        
        remove_btn = tk.Button(buttons_frame, text="üóëÔ∏è –£–¥–∞–ª–∏—Ç—å",
                             bg=self.colors['danger'], fg='white',
                             font=('Segoe UI', 10), bd=0, padx=15, pady=8,
                             cursor="hand2", command=self.remove_automation_task)
        remove_btn.pack(side=tk.LEFT, padx=5)
        
        run_btn = tk.Button(buttons_frame, text="‚ñ∂Ô∏è –í—ã–ø–æ–ª–Ω–∏—Ç—å",
                          bg=self.colors['primary'], fg='white',
                          font=('Segoe UI', 10), bd=0, padx=15, pady=8,
                          cursor="hand2", command=self.run_automation_tasks)
        run_btn.pack(side=tk.LEFT, padx=5)
        
        # –®–∞–±–ª–æ–Ω—ã –∑–∞–¥–∞—á
        templates_frame = tk.Frame(auto_frame, bg=self.colors['bg_lighter'],
                                  relief=tk.FLAT, bd=0, padx=20, pady=20)
        templates_frame.pack(pady=20, padx=50, fill=tk.X)
        
        tk.Label(templates_frame, text="üéØ –®–∞–±–ª–æ–Ω—ã –∑–∞–¥–∞—á",
                bg=self.colors['bg_lighter'], fg=self.colors['text'],
                font=('Segoe UI', 16, 'bold')).pack(anchor='w', pady=(0, 20))
        
        templates = [
            "–û—Ç–∫—Ä—ã—Ç—å –≤—Å–µ —Å–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–µ—Ç–∏",
            "–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ—á—Ç—É –∏ –Ω–æ–≤–æ—Å—Ç–∏",
            "–ó–∞–ø—É—Å—Ç–∏—Ç—å —Ä–∞–±–æ—á–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è",
            "–°–¥–µ–ª–∞—Ç—å —Å–∫—Ä–∏–Ω—à–æ—Ç —ç–∫—Ä–∞–Ω–∞",
            "–û—á–∏—Å—Ç–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é –±—Ä–∞—É–∑–µ—Ä–∞"
        ]
        
        for template in templates:
            btn = tk.Button(templates_frame, text=template,
                          bg=self.colors['bg'], fg=self.colors['primary'],
                          font=('Segoe UI', 10), bd=0, padx=15, pady=8,
                          cursor="hand2",
                          command=lambda t=template: self.add_template_task(t))
            btn.pack(side=tk.LEFT, padx=5)
    
    def create_development_tab(self):
        """–í–∫–ª–∞–¥–∫–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏"""
        dev_frame = tk.Frame(self.notebook, bg=self.colors['bg'])
        self.notebook.add(dev_frame, text='üíª –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞')
        
        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        title_label = tk.Label(dev_frame, text="–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞",
                              bg=self.colors['bg'], fg=self.colors['text'],
                              font=('Segoe UI', 24, 'bold'))
        title_label.pack(pady=(20, 30))
        
        # Code Editor
        editor_frame = tk.Frame(dev_frame, bg=self.colors['bg_lighter'],
                               relief=tk.FLAT, bd=0, padx=20, pady=20)
        editor_frame.pack(pady=10, padx=50, fill=tk.BOTH, expand=True)
        
        tk.Label(editor_frame, text="üìù –†–µ–¥–∞–∫—Ç–æ—Ä –∫–æ–¥–∞",
                bg=self.colors['bg_lighter'], fg=self.colors['text'],
                font=('Segoe UI', 16, 'bold')).pack(anchor='w', pady=(0, 20))
        
        # –ü—Ä–æ—Å—Ç–æ–π —Ä–µ–¥–∞–∫—Ç–æ—Ä –∫–æ–¥–∞
        self.code_text = scrolledtext.ScrolledText(
            editor_frame,
            height=15,
            bg='#1e1e1e',
            fg='#ffffff',
            font=('Consolas', 10),
            wrap=tk.WORD,
            relief=tk.FLAT,
            borderwidth=0,
            padx=15,
            pady=15,
            insertbackground='white'
        )
        self.code_text.pack(fill=tk.BOTH, expand=True)
        
        # –ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞
        example_code = '''# –ü—Ä–∏–º–µ—Ä –∫–æ–¥–∞ Python
def fibonacci(n):
    """–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç n-–Ω–æ–µ —á–∏—Å–ª–æ –§–∏–±–æ–Ω–∞—á—á–∏"""
    if n <= 1:
        return n
    return fibonacci(n-1) + fibonacci(n-2)

# –í—ã–≤–æ–¥ –ø–µ—Ä–≤—ã—Ö 10 —á–∏—Å–µ–ª
for i in range(10):
    print(f"Fibonacci({i}) = {fibonacci(i)}")'''
        
        self.code_text.insert(tk.END, example_code)
        
        # –ö–Ω–æ–ø–∫–∏ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞
        buttons_frame = tk.Frame(editor_frame, bg=self.colors['bg_lighter'])
        buttons_frame.pack(pady=10)
        
        run_btn = tk.Button(buttons_frame, text="‚ñ∂Ô∏è –í—ã–ø–æ–ª–Ω–∏—Ç—å",
                          bg=self.colors['success'], fg='white',
                          font=('Segoe UI', 10), bd=0, padx=15, pady=8,
                          cursor="hand2", command=self.run_code)
        run_btn.pack(side=tk.LEFT, padx=5)
        
        clear_btn = tk.Button(buttons_frame, text="üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å",
                            bg=self.colors['danger'], fg='white',
                            font=('Segoe UI', 10), bd=0, padx=15, pady=8,
                            cursor="hand2", command=lambda: self.code_text.delete(1.0, tk.END))
        clear_btn.pack(side=tk.LEFT, padx=5)
        
        save_btn = tk.Button(buttons_frame, text="üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å",
                           bg=self.colors['primary'], fg='white',
                           font=('Segoe UI', 10), bd=0, padx=15, pady=8,
                           cursor="hand2", command=self.save_code)
        save_btn.pack(side=tk.LEFT, padx=5)
        
        # –ö–æ–Ω—Å–æ–ª—å –≤—ã–≤–æ–¥–∞
        console_frame = tk.Frame(dev_frame, bg=self.colors['bg_lighter'],
                                relief=tk.FLAT, bd=0, padx=20, pady=20)
        console_frame.pack(pady=20, padx=50, fill=tk.BOTH, expand=True)
        
        tk.Label(console_frame, text="üìä –ö–æ–Ω—Å–æ–ª—å –≤—ã–≤–æ–¥–∞",
                bg=self.colors['bg_lighter'], fg=self.colors['text'],
                font=('Segoe UI', 16, 'bold')).pack(anchor='w', pady=(0, 20))
        
        self.console_output = scrolledtext.ScrolledText(
            console_frame,
            height=8,
            bg='#0f172a',
            fg='#ffffff',
            font=('Consolas', 9),
            wrap=tk.WORD,
            relief=tk.FLAT,
            borderwidth=0,
            padx=15,
            pady=15,
            state=tk.DISABLED
        )
        self.console_output.pack(fill=tk.BOTH, expand=True)
    
    def create_ai_tab(self):
        """–í–∫–ª–∞–¥–∫–∞ –ò–ò-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞"""
        ai_frame = tk.Frame(self.notebook, bg=self.colors['bg'])
        self.notebook.add(ai_frame, text='ü§ñ –ò–ò –ê—Å—Å–∏—Å—Ç–µ–Ω—Ç')
        
        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        title_label = tk.Label(ai_frame, text="–ò—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç",
                              bg=self.colors['bg'], fg=self.colors['text'],
                              font=('Segoe UI', 24, 'bold'))
        title_label.pack(pady=(20, 10))
        
        # –û–ø–∏—Å–∞–Ω–∏–µ
        desc_label = tk.Label(ai_frame, 
                             text="–û–±—É—á–∞–π—Ç–µ –Ω–µ–π—Ä–æ—Å–µ—Ç–∏, –¥–µ–ª–∞–π—Ç–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –∏ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ –¥–∞–Ω–Ω—ã–µ",
                             bg=self.colors['bg'], fg=self.colors['text_secondary'],
                             font=('Segoe UI', 12))
        desc_label.pack(pady=(0, 30))
        
        # –ü–∞–Ω–µ–ª—å —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ò–ò
        control_frame = tk.Frame(ai_frame, bg=self.colors['bg_lighter'],
                                relief=tk.FLAT, bd=0, padx=20, pady=20)
        control_frame.pack(pady=10, padx=50, fill=tk.X)
        
        tk.Label(control_frame, text="ü§ñ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ò–ò-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–æ–º",
                bg=self.colors['bg_lighter'], fg=self.colors['text'],
                font=('Segoe UI', 16, 'bold')).pack(anchor='w', pady=(0, 20))
        
        # –ö–Ω–æ–ø–∫–∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
        buttons_frame = tk.Frame(control_frame, bg=self.colors['bg_lighter'])
        buttons_frame.pack()
        
        ai_buttons = [
            ("üß† –û–±—É—á–∏—Ç—å –Ω–µ–π—Ä–æ—Å–µ—Ç—å", self.train_neural_network_ui),
            ("üå≤ –°–ª—É—á–∞–π–Ω—ã–π –ª–µ—Å", self.train_random_forest_ui),
            ("üìä –ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö", self.analyze_data_ui),
            ("üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –º–æ–¥–µ–ª–∏", self.save_ai_models),
            ("üìà –°—Ç–∞—Ç—É—Å", self.show_ai_status),
            ("‚ùì –ü–æ–º–æ—â—å", self.show_ai_help)
        ]
        
        for i, (text, command) in enumerate(ai_buttons):
            row, col = divmod(i, 3)
            
            if col == 0:
                row_frame = tk.Frame(buttons_frame, bg=self.colors['bg_lighter'])
                row_frame.pack(pady=5)
            
            btn = tk.Button(row_frame, text=text, bg=self.colors['primary'], 
                          fg='white', font=('Segoe UI', 10),
                          bd=0, padx=15, pady=8, cursor="hand2", command=command)
            btn.pack(side=tk.LEFT, padx=5)
        
        # –û–±–ª–∞—Å—Ç—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π
        predict_frame = tk.Frame(ai_frame, bg=self.colors['bg_lighter'],
                                relief=tk.FLAT, bd=0, padx=20, pady=20)
        predict_frame.pack(pady=20, padx=50, fill=tk.X)
        
        tk.Label(predict_frame, text="üìä –°–¥–µ–ª–∞—Ç—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ",
                bg=self.colors['bg_lighter'], fg=self.colors['text'],
                font=('Segoe UI', 16, 'bold')).pack(anchor='w', pady=(0, 20))
        
        # –í–≤–æ–¥ –¥–∞–Ω–Ω—ã—Ö
        input_frame = tk.Frame(predict_frame, bg=self.colors['bg_lighter'])
        input_frame.pack()
        
        tk.Label(input_frame, text="–í—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é):",
                bg=self.colors['bg_lighter'], fg=self.colors['text_secondary'],
                font=('Segoe UI', 11)).pack(anchor='w', pady=(0, 5))
        
        self.ai_input_data = tk.StringVar(value="0.5, -0.2, 0.8, 0.1, 0.3")
        ai_input_entry = tk.Entry(input_frame, textvariable=self.ai_input_data,
                                 font=('Segoe UI', 11), bg=self.colors['bg'],
                                 fg=self.colors['text'], insertbackground=self.colors['text'],
                                 relief=tk.FLAT, width=50)
        ai_input_entry.pack(anchor='w', pady=(0, 15))
        
        # –í—ã–±–æ—Ä –º–æ–¥–µ–ª–∏
        model_frame = tk.Frame(input_frame, bg=self.colors['bg_lighter'])
        model_frame.pack(anchor='w', pady=(0, 15))
        
        tk.Label(model_frame, text="–ú–æ–¥–µ–ª—å:",
                bg=self.colors['bg_lighter'], fg=self.colors['text_secondary'],
                font=('Segoe UI', 11)).pack(side=tk.LEFT, padx=(0, 10))
        
        self.ai_model_var = tk.StringVar()
        model_combo = ttk.Combobox(model_frame, textvariable=self.ai_model_var,
                                  values=list(self.ai_assistant.models.keys()),
                                  state='readonly', width=30, font=('Segoe UI', 10))
        model_combo.pack(side=tk.LEFT)
        
        # –ö–Ω–æ–ø–∫–∞ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
        predict_btn = tk.Button(input_frame, text="üîÆ –°–¥–µ–ª–∞—Ç—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ",
                              bg=self.colors['success'], fg='white',
                              font=('Segoe UI', 10, 'bold'), bd=0, padx=20, pady=10,
                              cursor="hand2", command=self.make_ai_prediction)
        predict_btn.pack(anchor='w')
        
        # –†–µ–∑—É–ª—å—Ç–∞—Ç
        self.ai_result_text = tk.Text(ai_frame, height=6, width=80,
                                     bg=self.colors['bg_lighter'],
                                     fg=self.colors['text'],
                                     font=('Consolas', 10),
                                     wrap=tk.WORD,
                                     relief=tk.FLAT,
                                     borderwidth=0,
                                     padx=15,
                                     pady=15)
        self.ai_result_text.pack(pady=20, padx=50, fill=tk.X)
        self.ai_result_text.insert(tk.END, "–ó–¥–µ—Å—å –±—É–¥—É—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ä–∞–±–æ—Ç—ã –ò–ò...")
        self.ai_result_text.config(state=tk.DISABLED)
    
    def train_neural_network_ui(self):
        """–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –æ–±—É—á–µ–Ω–∏—è –Ω–µ–π—Ä–æ—Å–µ—Ç–∏"""
        train_window = tk.Toplevel(self.root)
        train_window.title("–û–±—É—á–µ–Ω–∏–µ –Ω–µ–π—Ä–æ—Å–µ—Ç–∏")
        train_window.geometry("500x400")
        train_window.configure(bg=self.colors['bg'])
        
        self.center_window(train_window)
        
        tk.Label(train_window, text="üß† –û–±—É—á–µ–Ω–∏–µ –Ω–µ–π—Ä–æ–Ω–Ω–æ–π —Å–µ—Ç–∏",
                bg=self.colors['bg'], fg=self.colors['text'],
                font=('Segoe UI', 16, 'bold')).pack(pady=20)
        
        # –¢–∏–ø –∑–∞–¥–∞—á–∏
        tk.Label(train_window, text="–¢–∏–ø –∑–∞–¥–∞—á–∏:",
                bg=self.colors['bg'], fg=self.colors['text_secondary'],
                font=('Segoe UI', 11)).pack(anchor='w', padx=50, pady=(0, 5))
        
        task_var = tk.StringVar(value="classification")
        task_frame = tk.Frame(train_window, bg=self.colors['bg'])
        task_frame.pack(anchor='w', padx=50, pady=(0, 15))
        
        tk.Radiobutton(task_frame, text="–ö–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏—è", variable=task_var, 
                      value="classification", bg=self.colors['bg'],
                      fg=self.colors['text']).pack(side=tk.LEFT, padx=10)
        tk.Radiobutton(task_frame, text="–†–µ–≥—Ä–µ—Å—Å–∏—è", variable=task_var,
                      value="regression", bg=self.colors['bg'],
                      fg=self.colors['text']).pack(side=tk.LEFT, padx=10)
        
        # –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—Ä–∞–∑—Ü–æ–≤
        tk.Label(train_window, text="–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ–±—Ä–∞–∑—Ü–æ–≤:",
                bg=self.colors['bg'], fg=self.colors['text_secondary'],
                font=('Segoe UI', 11)).pack(anchor='w', padx=50, pady=(0, 5))
        
        samples_var = tk.IntVar(value=100)
        samples_spin = tk.Spinbox(train_window, from_=10, to=1000, 
                                 textvariable=samples_var,
                                 font=('Segoe UI', 11), bg=self.colors['bg_lighter'],
                                 fg=self.colors['text'], width=10)
        samples_spin.pack(anchor='w', padx=50, pady=(0, 15))
        
        # –ö–Ω–æ–ø–∫–∏
        button_frame = tk.Frame(train_window, bg=self.colors['bg'])
        button_frame.pack(pady=30)
        
        def start_training():
            task = task_var.get()
            samples = samples_var.get()
            
            if task == "classification":
                query = "–æ–±—É—á–∏ –Ω–µ–π—Ä–æ—Å–µ—Ç—å –¥–ª—è –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏"
            else:
                query = "–æ–±—É—á–∏ –Ω–µ–π—Ä–æ—Å–µ—Ç—å –¥–ª—è —Ä–µ–≥—Ä–µ—Å—Å–∏–∏"
            
            result = self.ai_assistant.enhanced_process_query(query)
            
            # –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–∏—Å–æ–∫ –º–æ–¥–µ–ª–µ–π
            self.update_ai_model_list()
            
            # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
            self.ai_result_text.config(state=tk.NORMAL)
            self.ai_result_text.delete(1.0, tk.END)
            self.ai_result_text.insert(tk.END, result)
            self.ai_result_text.config(state=tk.DISABLED)
            
            self.speak("–ù–µ–π—Ä–æ—Å–µ—Ç—å –æ–±—É—á–µ–Ω–∞!")
            train_window.destroy()
        
        train_btn = tk.Button(button_frame, text="üöÄ –ù–∞—á–∞—Ç—å –æ–±—É—á–µ–Ω–∏–µ",
                            bg=self.colors['success'], fg='white',
                            font=('Segoe UI', 10, 'bold'), bd=0, padx=20, pady=10,
                            cursor="hand2", command=start_training)
        train_btn.pack(side=tk.LEFT, padx=10)
        
        cancel_btn = tk.Button(button_frame, text="‚ùå –û—Ç–º–µ–Ω–∞",
                             bg=self.colors['danger'], fg='white',
                             font=('Segoe UI', 10, 'bold'), bd=0, padx=20, pady=10,
                             cursor="hand2", command=train_window.destroy)
        cancel_btn.pack(side=tk.LEFT, padx=10)
    
    def train_random_forest_ui(self):
        """–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –æ–±—É—á–µ–Ω–∏—è —Å–ª—É—á–∞–π–Ω–æ–≥–æ –ª–µ—Å–∞"""
        query = "—Å–æ–∑–¥–∞–π —Å–ª—É—á–∞–π–Ω—ã–π –ª–µ—Å"
        result = self.ai_assistant.enhanced_process_query(query)
        
        self.ai_result_text.config(state=tk.NORMAL)
        self.ai_result_text.delete(1.0, tk.END)
        self.ai_result_text.insert(tk.END, result)
        self.ai_result_text.config(state=tk.DISABLED)
        
        self.update_ai_model_list()
        self.speak("–°–ª—É—á–∞–π–Ω—ã–π –ª–µ—Å —Å–æ–∑–¥–∞–Ω!")
    
    def analyze_data_ui(self):
        """–ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ –ò–ò"""
        result = self.ai_assistant.analyze_data("–∞–Ω–∞–ª–∏–∑")
        
        self.ai_result_text.config(state=tk.NORMAL)
        self.ai_result_text.delete(1.0, tk.END)
        self.ai_result_text.insert(tk.END, result)
        self.ai_result_text.config(state=tk.DISABLED)
        
        self.speak("–î–∞–Ω–Ω—ã–µ –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã!")
    
    def save_ai_models(self):
        """–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–µ–π –ò–ò"""
        result = self.ai_assistant.process_query("—Å–æ—Ö—Ä–∞–Ω–∏ –≤—Å–µ –º–æ–¥–µ–ª–∏")
        
        self.ai_result_text.config(state=tk.NORMAL)
        self.ai_result_text.delete(1.0, tk.END)
        self.ai_result_text.insert(tk.END, result)
        self.ai_result_text.config(state=tk.DISABLED)
        
        self.speak("–ú–æ–¥–µ–ª–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã!")
    
    def show_ai_status(self):
        """–ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç—É—Å –ò–ò"""
        result = self.ai_assistant.show_status()
        
        self.ai_result_text.config(state=tk.NORMAL)
        self.ai_result_text.delete(1.0, tk.END)
        self.ai_result_text.insert(tk.END, result)
        self.ai_result_text.config(state=tk.DISABLED)
        
        self.speak("–°—Ç–∞—Ç—É—Å –ø–æ–∫–∞–∑–∞–Ω!")
    
    def show_ai_help(self):
        """–ü–æ–∫–∞–∑–∞—Ç—å —Å–ø—Ä–∞–≤–∫—É –ò–ò"""
        result = self.ai_assistant.show_help()
        
        self.ai_result_text.config(state=tk.NORMAL)
        self.ai_result_text.delete(1.0, tk.END)
        self.ai_result_text.insert(tk.END, result)
        self.ai_result_text.config(state=tk.DISABLED)
        
        self.speak("–°–ø—Ä–∞–≤–∫–∞ –ø–æ–∫–∞–∑–∞–Ω–∞!")
    
    def make_ai_prediction(self):
        """–°–¥–µ–ª–∞—Ç—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ —Å –ø–æ–º–æ—â—å—é –ò–ò"""
        input_data = self.ai_input_data.get()
        model_name = self.ai_model_var.get()
        
        if not input_data:
            messagebox.showerror("–û—à–∏–±–∫–∞", "–í–≤–µ–¥–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è")
            return
        
        if not model_name:
            messagebox.showerror("–û—à–∏–±–∫–∞", "–í—ã–±–µ—Ä–∏—Ç–µ –º–æ–¥–µ–ª—å")
            return
        
        query = f"–ø—Ä–µ–¥—Å–∫–∞–∂–∏ –ø–æ –º–æ–¥–µ–ª–∏ {model_name} –¥–∞–Ω–Ω—ã–µ: {input_data}"
        result = self.ai_assistant.enhanced_process_query(query)
        
        self.ai_result_text.config(state=tk.NORMAL)
        self.ai_result_text.delete(1.0, tk.END)
        self.ai_result_text.insert(tk.END, f"–ó–∞–ø—Ä–æ—Å: {query}\n\n–†–µ–∑—É–ª—å—Ç–∞—Ç:\n{result}")
        self.ai_result_text.config(state=tk.DISABLED)
        
        self.speak("–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ!")
    
    def update_ai_model_list(self):
        """–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –º–æ–¥–µ–ª–µ–π –≤ –∫–æ–º–±–æ–±–æ–∫—Å–µ"""
        model_names = list(self.ai_assistant.models.keys())
        if model_names:
            self.ai_model_var.set(model_names[0])
        
        # –ü–æ–ª—É—á–∞–µ–º –≤–∏–¥–∂–µ—Ç –∫–æ–º–±–æ–±–æ–∫—Å–∞
        for widget in self.notebook.winfo_children():
            if isinstance(widget, tk.Frame):
                for child in widget.winfo_children():
                    if isinstance(child, ttk.Combobox):
                        if child.get() == "" and model_names:
                            child['values'] = model_names
                            child.set(model_names[0])
    
    def open_ai_assistant(self):
        """–û—Ç–∫—Ä—ã—Ç—å –ò–ò-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞"""
        # –ü–µ—Ä–µ–∫–ª—é—á–∞–µ–º—Å—è –Ω–∞ –≤–∫–ª–∞–¥–∫—É –ò–ò
        self.notebook.select(6)
        
        # –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–ø—Ä–∞–≤–∫—É
        result = self.ai_assistant.show_help()
        
        self.ai_result_text.config(state=tk.NORMAL)
        self.ai_result_text.delete(1.0, tk.END)
        self.ai_result_text.insert(tk.END, result)
        self.ai_result_text.config(state=tk.DISABLED)
        
        self.speak("–ò–ò-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç –æ—Ç–∫—Ä—ã—Ç! –Ø –≥–æ—Ç–æ–≤ –ø–æ–º–æ–≥–∞—Ç—å –≤–∞–º —Å –∑–∞–¥–∞—á–∞–º–∏ –º–∞—à–∏–Ω–Ω–æ–≥–æ –æ–±—É—á–µ–Ω–∏—è.")
    
    def create_social_tab(self):
        """–í–∫–ª–∞–¥–∫–∞ —Å–æ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–µ—Ç–µ–π"""
        social_frame = tk.Frame(self.notebook, bg=self.colors['bg'])
        self.notebook.add(social_frame, text='üë• –°–æ—Ü—Å–µ—Ç–∏')
        
        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        title_label = tk.Label(social_frame, text="–°–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–µ—Ç–∏ –∏ –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä—ã",
                              bg=self.colors['bg'], fg=self.colors['text'],
                              font=('Segoe UI', 24, 'bold'))
        title_label.pack(pady=(20, 30))
        
        # –°–µ—Ç–∫–∞ —Å–æ—Ü—Å–µ—Ç–µ–π
        socials_frame = tk.Frame(social_frame, bg=self.colors['bg'])
        socials_frame.pack(pady=20)
        
        social_buttons = list(self.settings["social_networks"].items())
        
        for i, (name, url) in enumerate(social_buttons):
            row, col = divmod(i, 4)
            
            if col == 0:
                row_frame = tk.Frame(socials_frame, bg=self.colors['bg'])
                row_frame.pack(pady=10)
            
            card = tk.Frame(row_frame, bg=self.colors['bg_lighter'], 
                           relief=tk.FLAT, bd=0, width=150, height=80)
            card.pack_propagate(False)
            card.pack(side=tk.LEFT, padx=10)
            
            # –ò–∫–æ–Ω–∫–∞
            icon_label = tk.Label(card, text=self.get_social_icon(name),
                                 bg=self.colors['bg_lighter'], fg=self.colors['primary'],
                                 font=('Segoe UI Emoji', 20))
            icon_label.pack(pady=(10, 5))
            
            # –ù–∞–∑–≤–∞–Ω–∏–µ
            name_label = tk.Label(card, text=name, bg=self.colors['bg_lighter'],
                                 fg=self.colors['text'], font=('Segoe UI', 9))
            name_label.pack()
            
            # –ü—Ä–∏–≤—è–∑—ã–≤–∞–µ–º —Å–æ–±—ã—Ç–∏–µ –∫–ª–∏–∫–∞
            card.bind("<Button-1>", lambda e, u=url, n=name: self.open_url_with_voice(u, n))
            icon_label.bind("<Button-1>", lambda e, u=url, n=name: self.open_url_with_voice(u, n))
            name_label.bind("<Button-1>", lambda e, u=url, n=name: self.open_url_with_voice(u, n))
            
            # –ú–µ–Ω—è–µ–º –∫—É—Ä—Å–æ—Ä
            for widget in [card, icon_label, name_label]:
                widget.bind("<Enter>", lambda e, w=widget: w.config(cursor="hand2"))
    
    def get_social_icon(self, social_name):
        """–ü–æ–ª—É—á–µ–Ω–∏–µ –∏–∫–æ–Ω–∫–∏ –¥–ª—è —Å–æ—Ü—Å–µ—Ç–∏"""
        icons = {
            '–í–ö–æ–Ω—Ç–∞–∫—Ç–µ': 'üë•',
            '–û–¥–Ω–æ–∫–ª–∞—Å—Å–Ω–∏–∫–∏': 'üë®‚Äçüë©‚Äçüëß‚Äçüë¶',
            'Telegram': 'üì®',
            'WhatsApp Web': 'üí¨',
            'Discord': 'üéÆ',
            'Twitter': 'üê¶',
            'Facebook': 'üìò',
            'Instagram': 'üì∑',
            'YouTube': 'üé•',
            'Twitch': 'üïπÔ∏è',
            'DeepSeek AI': 'ü§ñ'
        }
        return icons.get(social_name, 'üåê')
    
    def open_url_with_voice(self, url, name):
        """–û—Ç–∫—Ä—ã—Ç—å URL —Å –æ–∑–≤—É—á–∫–æ–π"""
        self.open_url(url)
        self.speak(f"–û—Ç–∫—Ä—ã–≤–∞—é {name}")
    
    def create_media_tab(self):
        """–í–∫–ª–∞–¥–∫–∞ –º–µ–¥–∏–∞"""
        media_frame = tk.Frame(self.notebook, bg=self.colors['bg'])
        self.notebook.add(media_frame, text='üéµ –ú–µ–¥–∏–∞')
        
        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        title_label = tk.Label(media_frame, text="–ú–µ–¥–∏–∞ –∏ —Ä–∞–∑–≤–ª–µ—á–µ–Ω–∏—è",
                              bg=self.colors['bg'], fg=self.colors['text'],
                              font=('Segoe UI', 24, 'bold'))
        title_label.pack(pady=(20, 30))
        
        # –í–∏–¥–µ–æ–ø–æ–∏—Å–∫
        video_frame = tk.Frame(media_frame, bg=self.colors['bg_lighter'],
                              relief=tk.FLAT, bd=0, padx=20, pady=20)
        video_frame.pack(pady=10, padx=50, fill=tk.X)
        
        tk.Label(video_frame, text="üé¨ –ü–æ–∏—Å–∫ –≤–∏–¥–µ–æ",
                bg=self.colors['bg_lighter'], fg=self.colors['text'],
                font=('Segoe UI', 16, 'bold')).pack(anchor='w', pady=(0, 20))
        
        search_frame = tk.Frame(video_frame, bg=self.colors['bg_lighter'])
        search_frame.pack()
        
        self.video_search_query = tk.StringVar()
        video_entry = tk.Entry(search_frame, textvariable=self.video_search_query,
                              font=('Segoe UI', 11), bg=self.colors['bg'],
                              fg=self.colors['text'], insertbackground=self.colors['text'],
                              relief=tk.FLAT, width=40)
        video_entry.pack(side=tk.LEFT, padx=(0, 10))
        
        video_btn = tk.Button(search_frame, text="üîç –ò—Å–∫–∞—Ç—å –≤–∏–¥–µ–æ",
                             bg=self.colors['primary'], fg='white',
                             font=('Segoe UI', 10, 'bold'), bd=0, padx=15, pady=8,
                             cursor="hand2", command=self.search_and_play_video)
        video_btn.pack(side=tk.LEFT)
        
        # –†–∞–¥–∏–æ
        radio_frame = tk.Frame(media_frame, bg=self.colors['bg_lighter'],
                              relief=tk.FLAT, bd=0, padx=20, pady=20)
        radio_frame.pack(pady=20, padx=50, fill=tk.X)
        
        tk.Label(radio_frame, text="üìª –ò–Ω—Ç–µ—Ä–Ω–µ—Ç-—Ä–∞–¥–∏–æ",
                bg=self.colors['bg_lighter'], fg=self.colors['text'],
                font=('Segoe UI', 16, 'bold')).pack(anchor='w', pady=(0, 20))
        
        radio_stations = [
            ("–ï–≤—Ä–æ–ø–∞ –ü–ª—é—Å", "http://ep128.hostingradio.ru:8030/ep128"),
            ("–†—É—Å—Å–∫–æ–µ –†–∞–¥–∏–æ", "http://rusradio.hostingradio.ru/rusradio96.aacp"),
            ("–î–∏-FM", "http://dfm.hostingradio.ru/dfm96.aacp"),
            ("–ù–∞—à–µ –†–∞–¥–∏–æ", "http://nashe1.hostingradio.ru/nashe-256")
        ]
        
        stations_frame = tk.Frame(radio_frame, bg=self.colors['bg_lighter'])
        stations_frame.pack()
        
        for name, url in radio_stations:
            btn = tk.Button(stations_frame, text=name, bg=self.colors['primary'],
                          fg='white', font=('Segoe UI', 10, 'bold'), bd=0,
                          padx=15, pady=8, cursor="hand2",
                          command=lambda u=url, n=name: self.play_radio_with_voice(u, n))
            btn.pack(side=tk.LEFT, padx=10)
    
    def play_radio_with_voice(self, url, name):
        """–í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ —Ä–∞–¥–∏–æ —Å –æ–∑–≤—É—á–∫–æ–π"""
        self.play_radio(url)
        self.speak(f"–ó–∞–ø—É—Å–∫–∞—é —Ä–∞–¥–∏–æ {name}")
    
    def create_tools_tab(self):
        """–í–∫–ª–∞–¥–∫–∞ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤"""
        tools_frame = tk.Frame(self.notebook, bg=self.colors['bg'])
        self.notebook.add(tools_frame, text='üõ†Ô∏è –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã')
        
        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        title_label = tk.Label(tools_frame, text="–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –∏ —É—Ç–∏–ª–∏—Ç—ã",
                              bg=self.colors['bg'], fg=self.colors['text'],
                              font=('Segoe UI', 24, 'bold'))
        title_label.pack(pady=(20, 30))
        
        # –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä
        calc_frame = tk.Frame(tools_frame, bg=self.colors['bg_lighter'],
                             relief=tk.FLAT, bd=0, padx=20, pady=20)
        calc_frame.pack(pady=10, padx=50, fill=tk.X)
        
        tk.Label(calc_frame, text="üßÆ –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä",
                bg=self.colors['bg_lighter'], fg=self.colors['text'],
                font=('Segoe UI', 16, 'bold')).pack(anchor='w', pady=(0, 20))
        
        # –ü–æ–ª–µ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞
        self.calc_display = tk.StringVar(value="0")
        calc_entry = tk.Entry(calc_frame, textvariable=self.calc_display,
                             font=('Segoe UI', 14), bg=self.colors['bg'],
                             fg=self.colors['text'], insertbackground=self.colors['text'],
                             relief=tk.FLAT, justify=tk.RIGHT, width=30)
        calc_entry.pack(pady=(0, 20))
        
        # –ö–Ω–æ–ø–∫–∏ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞
        calc_buttons = [
            ('7', '8', '9', '/'),
            ('4', '5', '6', '*'),
            ('1', '2', '3', '-'),
            ('0', '.', '=', '+')
        ]
        
        for i, row in enumerate(calc_buttons):
            row_frame = tk.Frame(calc_frame, bg=self.colors['bg_lighter'])
            row_frame.pack()
            
            for btn_text in row:
                color = self.colors['primary'] if btn_text.isdigit() or btn_text == '.' else \
                       self.colors['success'] if btn_text == '=' else \
                       self.colors['warning']
                
                btn = tk.Button(row_frame, text=btn_text, bg=color, fg='white',
                              font=('Segoe UI', 12, 'bold'), bd=0, width=4, height=2,
                              cursor="hand2", command=lambda t=btn_text: self.calc_button_click(t))
                btn.pack(side=tk.LEFT, padx=2, pady=2)
        
        # –î—Ä—É–≥–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã
        tools_frame2 = tk.Frame(tools_frame, bg=self.colors['bg_lighter'],
                               relief=tk.FLAT, bd=0, padx=20, pady=20)
        tools_frame2.pack(pady=20, padx=50, fill=tk.X)
        
        tk.Label(tools_frame2, text="üìä –î—Ä—É–≥–∏–µ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã",
                bg=self.colors['bg_lighter'], fg=self.colors['text'],
                font=('Segoe UI', 16, 'bold')).pack(anchor='w', pady=(0, 20))
        
        # –ö–Ω–æ–ø–∫–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
        tools_buttons = [
            ("üìÅ –ü—Ä–æ–≤–æ–¥–Ω–∏–∫", self.open_file_explorer),
            ("üé® Paint", self.open_paint),
            ("üìù –ë–ª–æ–∫–Ω–æ—Ç", self.open_notepad),
            ("üïê –ß–∞—Å—ã", self.show_clock),
            ("üåê –ë—Ä–∞—É–∑–µ—Ä", self.open_browser_window),
            ("üå§Ô∏è –ü–æ–≥–æ–¥–∞", self.open_weather),
            ("ü§ñ DeepSeek", self.open_deepseek),
            ("‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏", self.open_settings)
        ]
        
        for i, (text, command) in enumerate(tools_buttons):
            row, col = divmod(i, 4)
            
            if col == 0:
                row_frame = tk.Frame(tools_frame2, bg=self.colors['bg_lighter'])
                row_frame.pack(pady=5)
            
            btn = tk.Button(row_frame, text=text, bg=self.colors['bg'], 
                          fg=self.colors['primary'], font=('Segoe UI', 10),
                          bd=0, padx=15, pady=8, cursor="hand2", command=command)
            btn.pack(side=tk.LEFT, padx=5)
    
    def create_help_tab(self):
        """–í–∫–ª–∞–¥–∫–∞ –ø–æ–º–æ—â–∏"""
        help_frame = tk.Frame(self.notebook, bg=self.colors['bg'])
        self.notebook.add(help_frame, text='‚ùì –ü–æ–º–æ—â—å')
        
        # –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –ø—Ä–æ–≥—Ä–∞–º–º–µ
        info_text = f"""‚öõÔ∏è –ê—Ç–æ–º v4.0 PRO

–í–µ—Ä—Å–∏—è: 4.0 PRO (—Å —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏ –ò–ò)
–†–µ–∂–∏–º: {'–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π' if self.demo_mode else '–†–∞–±–æ—á–∏–π'}
–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å: {self.current_user if self.logged_in else '–ì–æ—Å—Ç—å'}
–ì–æ–ª–æ—Å–æ–≤–æ–π –ø–æ–º–æ—â–Ω–∏–∫: {'–î–æ—Å—Ç—É–ø–µ–Ω' if SPEECH_AVAILABLE else '–ù–µ –¥–æ—Å—Ç—É–ø–µ–Ω'}

–ù–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ v4.0:
‚Ä¢ –£–ª—É—á—à–µ–Ω–Ω—ã–π –ò–ò-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç —Å –∞–Ω–∞–ª–∏–∑–∞—Ç–æ—Ä–æ–º –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è
‚Ä¢ ü§ñ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –ø–æ–≤—Å–µ–¥–Ω–µ–≤–Ω—ã—Ö –∑–∞–¥–∞—á
‚Ä¢ üíª –†–µ–¥–∞–∫—Ç–æ—Ä –∫–æ–¥–∞ —Å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ–º Python
‚Ä¢ –°–∏—Å—Ç–µ–º–∞ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π
‚Ä¢ –ü—Ä–æ—Å—Ç–æ–π –ø–µ—Ä–µ–≤–æ–¥—á–∏–∫
‚Ä¢ –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –∫–æ–¥–∞
‚Ä¢ –ß–∞—Å—Ç–∏—Ü—ã –Ω–∞ —Ñ–æ–Ω–µ
‚Ä¢ –ì–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏ (Ctrl+Q, Ctrl+S, Ctrl+R)
‚Ä¢ –ü–∞–Ω–µ–ª—å –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞

–ì–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏:
‚Ä¢ Ctrl+Q - –ë—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø
‚Ä¢ Ctrl+S - –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤—Å—ë
‚Ä¢ Ctrl+R - –û–±–Ω–æ–≤–∏—Ç—å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
‚Ä¢ F1 - –°–ø—Ä–∞–≤–∫–∞
‚Ä¢ F2 - –°–∫—Ä–∏–Ω—à–æ—Ç

¬© 2024 –†–∞–∑—Ä–∞–±–æ—Ç–∞–Ω–æ –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π –ò–ò"""
        
        info_label = tk.Label(help_frame, text=info_text, bg=self.colors['bg'],
                             fg=self.colors['text'], font=('Segoe UI', 11),
                             justify=tk.LEFT)
        info_label.pack(pady=50, padx=50)
        
        # –ì–æ–ª–æ—Å–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã
        if SPEECH_AVAILABLE or VOICE_INPUT_AVAILABLE:
            commands_frame = tk.Frame(help_frame, bg=self.colors['bg_lighter'],
                                     relief=tk.FLAT, bd=0, padx=20, pady=20)
            commands_frame.pack(pady=20, padx=50, fill=tk.X)
            
            tk.Label(commands_frame, text="üé§ –ì–æ–ª–æ—Å–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã",
                    bg=self.colors['bg_lighter'], fg=self.colors['text'],
                    font=('Segoe UI', 16, 'bold')).pack(anchor='w', pady=(0, 20))
            
            commands_text = """–î–æ—Å—Ç—É–ø–Ω—ã–µ –≥–æ–ª–æ—Å–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã:

‚Ä¢ "–ê—Ç–æ–º" - –∞–∫—Ç–∏–≤–∞—Ü–∏—è –ø–æ –∫–ª—é—á–µ–≤–æ–º—É —Å–ª–æ–≤—É
‚Ä¢ "–ü–æ–∏—Å–∫ [–∑–∞–ø—Ä–æ—Å]" - –ø–æ–∏—Å–∫ –≤ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç–µ
‚Ä¢ "–û—Ç–∫—Ä–æ–π [—Å–∞–π—Ç]" - –æ—Ç–∫—Ä—ã—Ç—å —Å–∞–π—Ç
‚Ä¢ "–ü–æ–≥–æ–¥–∞" - –ø–æ–∫–∞–∑–∞—Ç—å –ø–æ–≥–æ–¥—É
‚Ä¢ "–ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä" - –æ—Ç–∫—Ä—ã—Ç—å –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä
‚Ä¢ "–í—Ä–µ–º—è" - –ø–æ–∫–∞–∑–∞—Ç—å —Ç–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è
‚Ä¢ "–ë—Ä–∞—É–∑–µ—Ä" - –æ—Ç–∫—Ä—ã—Ç—å –±—Ä–∞—É–∑–µ—Ä
‚Ä¢ "–ë–ª–æ–∫–Ω–æ—Ç" - –æ—Ç–∫—Ä—ã—Ç—å –±–ª–æ–∫–Ω–æ—Ç
‚Ä¢ "–î–∏–ø—Å–∏–∫" –∏–ª–∏ "DeepSeek" - –æ—Ç–∫—Ä—ã—Ç—å DeepSeek AI

–ù–û–í–´–ï –ö–û–ú–ê–ù–î–´ v4.0:
‚Ä¢ "–î–æ–±–∞–≤—å –∑–∞–¥–∞—á—É [—Ç–µ–∫—Å—Ç]" - –¥–æ–±–∞–≤–∏—Ç—å –∑–∞–¥–∞—á—É –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏
‚Ä¢ "–ü–æ–∫–∞–∂–∏ –∑–∞–¥–∞—á–∏" - –ø–æ–∫–∞–∑–∞—Ç—å —Å–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á
‚Ä¢ "–í—ã–ø–æ–ª–Ω–∏ –∑–∞–¥–∞—á–∏" - –∑–∞–ø—É—Å—Ç–∏—Ç—å –∑–∞–¥–∞—á–∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏
‚Ä¢ "–ù–æ–≤—ã–π –∫–æ–¥" - –æ—á–∏—Å—Ç–∏—Ç—å —Ä–µ–¥–∞–∫—Ç–æ—Ä –∫–æ–¥–∞
‚Ä¢ "–°–æ—Ö—Ä–∞–Ω–∏ –∫–æ–¥" - —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–æ–¥ –∏–∑ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞
‚Ä¢ "–°–∫—Ä–∏–Ω—à–æ—Ç" - —Å–¥–µ–ª–∞—Ç—å —Å–Ω–∏–º–æ–∫ —ç–∫—Ä–∞–Ω–∞
‚Ä¢ "–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π —Ç–µ–∫—Å—Ç [—Ç–µ–∫—Å—Ç]" - –∞–Ω–∞–ª–∏–∑ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏—è —Ç–µ–∫—Å—Ç–∞
‚Ä¢ "–ß—Ç–æ –Ω–∞ —ç–∫—Ä–∞–Ω–µ" - –ø—Ä–æ—á–∏—Ç–∞—Ç—å —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ —ç–∫—Ä–∞–Ω–∞ (–¥–µ–º–æ)

–ò–ò-–ö–û–ú–ê–ù–î–´:
‚Ä¢ "–û–±—É—á–∏ –Ω–µ–π—Ä–æ—Å–µ—Ç—å" - –æ–±—É—á–∏—Ç—å –Ω–µ–π—Ä–æ—Å–µ—Ç—å
‚Ä¢ "–ü—Ä–µ–¥—Å–∫–∞–∂–∏ —Å –ø–æ–º–æ—â—å—é [–º–æ–¥–µ–ª—å]" - —Å–¥–µ–ª–∞—Ç—å –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ
‚Ä¢ "–ê–Ω–∞–ª–∏–∑ –¥–∞–Ω–Ω—ã—Ö" - –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞—Ç—å –¥–∞–Ω–Ω—ã–µ
‚Ä¢ "–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è" - –ø–æ–ª—É—á–∏—Ç—å —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—é
‚Ä¢ "–ü–µ—Ä–µ–≤–µ–¥–∏ [—Ç–µ–∫—Å—Ç]" - –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ —Ç–µ–∫—Å—Ç

–°–ò–°–¢–ï–ú–ù–´–ï –ö–û–ú–ê–ù–î–´:
‚Ä¢ "–°—Ç–æ–ø" - –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≥–æ–ª–æ—Å–æ–≤–æ–≥–æ –ø–æ–º–æ—â–Ω–∏–∫–∞
‚Ä¢ "–ù–∞—Å—Ç—Ä–æ–π–∫–∏" - –æ—Ç–∫—Ä—ã—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
‚Ä¢ "–ü–æ–º–æ—â—å" - –ø–æ–∫–∞–∑–∞—Ç—å —Å–ø—Ä–∞–≤–∫—É
‚Ä¢ "–í—ã–π—Ç–∏" - –≤—ã—Ö–æ–¥ –∏–∑ –ø—Ä–æ–≥—Ä–∞–º–º—ã"""
            
            commands_label = tk.Label(commands_frame, text=commands_text,
                                     bg=self.colors['bg_lighter'], fg=self.colors['text_secondary'],
                                     font=('Segoe UI', 9), justify=tk.LEFT)
            commands_label.pack(anchor='w')
    
    def create_log_tab(self):
        """–í–∫–ª–∞–¥–∫–∞ –ª–æ–≥–∞ —Å–æ–æ–±—â–µ–Ω–∏–π"""
        log_frame = tk.Frame(self.notebook, bg=self.colors['bg'])
        self.notebook.add(log_frame, text='üìù –õ–æ–≥')
        
        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        title_label = tk.Label(log_frame, text="–ñ—É—Ä–Ω–∞–ª —Å–æ–±—ã—Ç–∏–π",
                              bg=self.colors['bg'], fg=self.colors['text'],
                              font=('Segoe UI', 24, 'bold'))
        title_label.pack(pady=20)
        
        # –¢–µ–∫—Å—Ç–æ–≤–∞—è –æ–±–ª–∞—Å—Ç—å –ª–æ–≥–∞
        self.log_text = scrolledtext.ScrolledText(
            log_frame,
            bg=self.colors['bg_lighter'],
            fg=self.colors['text'],
            font=("Consolas", 10),
            wrap=tk.WORD,
            height=25,
            relief=tk.FLAT,
            borderwidth=0,
            padx=15,
            pady=15
        )
        self.log_text.pack(fill=tk.BOTH, expand=True, padx=20, pady=10)
        self.log_text.config(state=tk.DISABLED)
    
    def create_status_bar(self):
        """–°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç–∞—Ç—É—Å –±–∞—Ä–∞"""
        status_frame = tk.Frame(self.root, bg=self.colors['bg_light'], height=40)
        status_frame.pack(side=tk.BOTTOM, fill=tk.X)
        
        # –°—Ç–∞—Ç—É—Å
        self.status_label = tk.Label(status_frame, text="–ì–æ—Ç–æ–≤",
                                    bg=self.colors['bg_light'],
                                    fg=self.colors['text_secondary'],
                                    font=('Segoe UI', 10))
        self.status_label.pack(side=tk.LEFT, padx=20)
        
        # –†–µ–∂–∏–º
        mode_text = "–î–µ–º–æ-—Ä–µ–∂–∏–º" if self.demo_mode else "–†–∞–±–æ—á–∏–π —Ä–µ–∂–∏–º"
        self.mode_label = tk.Label(status_frame,
                                  text=f"–†–µ–∂–∏–º: {mode_text}",
                                  bg=self.colors['bg_light'],
                                  fg=self.colors['warning'] if self.demo_mode else self.colors['success'],
                                  font=('Segoe UI', 10))
        self.mode_label.pack(side=tk.LEFT, padx=20)
        
        # –í—Ä–µ–º—è
        self.time_label = tk.Label(status_frame,
                                  text=time.strftime("%H:%M:%S"),
                                  bg=self.colors['bg_light'],
                                  fg=self.colors['text'],
                                  font=('Segoe UI', 10))
        self.time_label.pack(side=tk.RIGHT, padx=20)
        
        # –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏
        self.update_time()
    
    def update_time(self):
        """–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–∏ –≤ —Å—Ç–∞—Ç—É—Å –±–∞—Ä–µ"""
        if not self.running or not self.root.winfo_exists():
            return
            
        current_time = time.strftime("%H:%M:%S")
        try:
            self.time_label.config(text=current_time)
            self.root.after(1000, self.update_time)
        except tk.TclError:
            pass
    
    def add_automation_task(self):
        """–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏"""
        task = self.new_task_var.get().strip()
        if task:
            self.automation_tasks.append(task)
            self.tasks_listbox.insert(tk.END, f"‚úì {task}")
            self.new_task_var.set("")
            self.speak(f"–ó–∞–¥–∞—á–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞: {task}")
    
    def remove_automation_task(self):
        """–£–¥–∞–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏"""
        selection = self.tasks_listbox.curselection()
        if selection:
            index = selection[0]
            task = self.automation_tasks.pop(index)
            self.tasks_listbox.delete(index)
            self.speak(f"–ó–∞–¥–∞—á–∞ —É–¥–∞–ª–µ–Ω–∞: {task}")
    
    def add_template_task(self, template):
        """–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∑–∞–¥–∞—á–∏ –∏–∑ —à–∞–±–ª–æ–Ω–∞"""
        self.automation_tasks.append(template)
        self.tasks_listbox.insert(tk.END, f"‚úì {template}")
        self.speak(f"–î–æ–±–∞–≤–ª–µ–Ω —à–∞–±–ª–æ–Ω: {template}")
    
    def run_automation_tasks(self):
        """–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–¥–∞—á –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏"""
        if not self.automation_tasks:
            self.speak("–ù–µ—Ç –∑–∞–¥–∞—á –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è")
            return
        
        self.speak(f"–ù–∞—á–∏–Ω–∞—é –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ {len(self.automation_tasks)} –∑–∞–¥–∞—á")
        
        for i, task in enumerate(self.automation_tasks, 1):
            self.message_queue.put(f"–ó–∞–¥–∞—á–∞ {i}/{len(self.automation_tasks)}: {task}")
            self.perform_automated_task(task)
            time.sleep(1)
        
        self.speak("–í—Å–µ –∑–∞–¥–∞—á–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã")
    
    def perform_automated_task(self, task):
        """–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–π –∑–∞–¥–∞—á–∏"""
        task_lower = task.lower()
        
        if "—Å–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–µ—Ç–∏" in task_lower:
            self.open_all_social_networks()
        elif "–ø–æ—á—Ç" in task_lower or "–Ω–æ–≤–æ—Å—Ç–∏" in task_lower:
            self.check_news_and_mail()
        elif "–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è" in task_lower:
            self.open_work_apps()
        elif "—Å–∫—Ä–∏–Ω—à–æ—Ç" in task_lower:
            self.take_screenshot()
        elif "–∏—Å—Ç–æ—Ä–∏" in task_lower:
            self.clear_browser_history()
        else:
            self.message_queue.put(f"–í—ã–ø–æ–ª–Ω—è—é: {task}")
    
    def open_all_social_networks(self):
        """–û—Ç–∫—Ä—ã—Ç—å –≤—Å–µ —Å–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–µ—Ç–∏"""
        for name, url in self.settings["social_networks"].items():
            if name != "DeepSeek AI":  # –ü—Ä–æ–ø—É—Å–∫–∞–µ–º DeepSeek
                self.open_url(url)
                time.sleep(0.5)
        self.speak("–í—Å–µ —Å–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–µ—Ç–∏ –æ—Ç–∫—Ä—ã—Ç—ã")
    
    def check_news_and_mail(self):
        """–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–æ–≤–æ—Å—Ç–∏ –∏ –ø–æ—á—Ç—É"""
        sites = [
            ("–ù–æ–≤–æ—Å—Ç–∏", "https://news.google.com"),
            ("–ü–æ—á—Ç–∞", "https://mail.google.com"),
            ("–Ø–Ω–¥–µ–∫—Å.–ù–æ–≤–æ—Å—Ç–∏", "https://news.yandex.ru")
        ]
        
        for name, url in sites:
            self.open_url(url)
            time.sleep(1)
        
        self.speak("–ù–æ–≤–æ—Å—Ç–∏ –∏ –ø–æ—á—Ç–∞ –ø—Ä–æ–≤–µ—Ä–µ–Ω—ã")
    
    def open_work_apps(self):
        """–û—Ç–∫—Ä—ã—Ç—å —Ä–∞–±–æ—á–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è"""
        self.open_notepad()
        self.open_calculator()
        self.open_browser_window()
        self.speak("–†–∞–±–æ—á–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∑–∞–ø—É—â–µ–Ω—ã")
    
    def take_screenshot(self):
        """–°–¥–µ–ª–∞—Ç—å —Å–∫—Ä–∏–Ω—à–æ—Ç (–¥–µ–º–æ-–≤–µ—Ä—Å–∏—è)"""
        try:
            timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
            filename = f"screenshot_{timestamp}.png"
            
            # –í —Ä–µ–∞–ª—å–Ω–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∑–¥–µ—Å—å –±—ã–ª –±—ã –∫–æ–¥ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å–∫—Ä–∏–Ω—à–æ—Ç–∞
            # –ù–æ –¥–ª—è –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –ø—Ä–æ—Å—Ç–æ —Å–æ–∑–¥–∞–µ–º —Ñ–∞–π–ª-–∑–∞–≥–ª—É—à–∫—É
            with open(filename, 'w') as f:
                f.write("–î–µ–º–æ-—Å–∫—Ä–∏–Ω—à–æ—Ç\n")
            
            self.screenshots.append(filename)
            self.message_queue.put(f"–°–∫—Ä–∏–Ω—à–æ—Ç —Å–æ—Ö—Ä–∞–Ω–µ–Ω: {filename}")
            self.speak("–°–∫—Ä–∏–Ω—à–æ—Ç —Å–¥–µ–ª–∞–Ω –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω")
        except Exception as e:
            self.message_queue.put(f"–û—à–∏–±–∫–∞ —Å–∫—Ä–∏–Ω—à–æ—Ç–∞: {e}")
    
    def clear_browser_history(self):
        """–û—á–∏—Å—Ç–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é –±—Ä–∞—É–∑–µ—Ä–∞ (–¥–µ–º–æ)"""
        self.message_queue.put("–ò—Å—Ç–æ—Ä–∏—è –±—Ä–∞—É–∑–µ—Ä–∞ –æ—á–∏—â–µ–Ω–∞ (–¥–µ–º–æ)")
        self.speak("–ò—Å—Ç–æ—Ä–∏—è –±—Ä–∞—É–∑–µ—Ä–∞ –æ—á–∏—â–µ–Ω–∞ –≤ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω–æ–º —Ä–µ–∂–∏–º–µ")
    
    def run_code(self):
        """–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–¥–∞ –∏–∑ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞"""
        code = self.code_text.get(1.0, tk.END).strip()
        
        if not code:
            self.speak("–ù–µ—Ç –∫–æ–¥–∞ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è")
            return
        
        # –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–¥–∞
        try:
            # –°–æ–∑–¥–∞–µ–º –±–µ–∑–æ–ø–∞—Å–Ω–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
            safe_globals = {
                '__builtins__': __builtins__,
                'print': lambda *args: self.code_print(*args),
                'math': math,
                'random': random,
                'time': time
            }
            
            # –í—ã–ø–æ–ª–Ω—è–µ–º –∫–æ–¥
            self.console_output.config(state=tk.NORMAL)
            self.console_output.delete(1.0, tk.END)
            self.console_output.insert(tk.END, ">>> –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∫–æ–¥–∞...\n\n")
            
            # –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –≤—ã–≤–æ–¥
            exec(code, safe_globals)
            
            self.console_output.insert(tk.END, "\n>>> –ö–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ!\n")
            self.console_output.see(tk.END)
            self.console_output.config(state=tk.DISABLED)
            
            self.speak("–ö–æ–¥ –≤—ã–ø–æ–ª–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ")
            
        except Exception as e:
            self.console_output.insert(tk.END, f"\n>>> –û—à–∏–±–∫–∞: {str(e)}\n")
            self.console_output.see(tk.END)
            self.console_output.config(state=tk.DISABLED)
            self.speak(f"–û—à–∏–±–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–¥–∞: {str(e)[:50]}")
    
    def code_print(self, *args, **kwargs):
        """–ö–∞—Å—Ç–æ–º–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è print –¥–ª—è —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ –∫–æ–¥–∞"""
        text = " ".join(str(arg) for arg in args)
        self.console_output.config(state=tk.NORMAL)
        self.console_output.insert(tk.END, text + "\n")
        self.console_output.see(tk.END)
        self.console_output.config(state=tk.DISABLED)
    
    def save_code(self):
        """–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∫–æ–¥–∞ –≤ —Ñ–∞–π–ª"""
        code = self.code_text.get(1.0, tk.END).strip()
        
        if not code:
            self.speak("–ù–µ—Ç –∫–æ–¥–∞ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è")
            return
        
        file_path = filedialog.asksaveasfilename(
            defaultextension=".py",
            filetypes=[("Python files", "*.py"), ("All files", "*.*")]
        )
        
        if file_path:
            try:
                with open(file_path, 'w', encoding='utf-8') as f:
                    f.write(code)
                self.message_queue.put(f"–ö–æ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω: {file_path}")
                self.speak("–ö–æ–¥ —Å–æ—Ö—Ä–∞–Ω–µ–Ω —É—Å–ø–µ—à–Ω–æ")
            except Exception as e:
                self.message_queue.put(f"–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è: {e}")
                self.speak("–ù–µ —É–¥–∞–ª–æ—Å—å —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –∫–æ–¥")
    
    def create_quick_access_panel(self):
        """–ü–∞–Ω–µ–ª—å –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞"""
        quick_panel = tk.Toplevel(self.root)
        quick_panel.title("–ë—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø")
        quick_panel.geometry("300x500")
        quick_panel.configure(bg=self.colors['bg'])
        quick_panel.attributes('-topmost', True)
        quick_panel.overrideredirect(True)
        
        # –ü–æ–∑–∏—Ü–∏—è –≤ –ø—Ä–∞–≤–æ–º –≤–µ—Ä—Ö–Ω–µ–º —É–≥–ª—É
        screen_width = self.root.winfo_screenwidth()
        quick_panel.geometry(f"300x500+{screen_width-320}+20")
        
        # –ó–∞–≥–æ–ª–æ–≤–æ–∫
        title_label = tk.Label(quick_panel, text="‚ö° –ë—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø",
                              bg=self.colors['primary'], fg='white',
                              font=('Segoe UI', 12, 'bold'), pady=10)
        title_label.pack(fill=tk.X)
        
        # –ö–Ω–æ–ø–∫–∏ –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞
        quick_actions = [
            ("üé§ –ì–æ–ª–æ—Å–æ–≤–∞—è –∫–æ–º–∞–Ω–¥–∞", self.voice_search),
            ("üì∏ –°–∫—Ä–∏–Ω—à–æ—Ç", self.take_screenshot),
            ("üßÆ –ö–∞–ª—å–∫—É–ª—è—Ç–æ—Ä", self.open_calculator),
            ("üìù –ë–ª–æ–∫–Ω–æ—Ç", self.open_notepad),
            ("üåê –ë—Ä–∞—É–∑–µ—Ä", self.open_browser_window),
            ("ü§ñ –ò–ò –ê—Å—Å–∏—Å—Ç–µ–Ω—Ç", self.open_ai_assistant),
            ("‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏", self.open_settings),
            ("üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤—Å—ë", self.save_all_data),
            ("üîÑ –û–±–Ω–æ–≤–∏—Ç—å", self.refresh_interface)
        ]
        
        for text, command in quick_actions:
            btn = tk.Button(quick_panel, text=text,
                          bg=self.colors['bg_lighter'], fg=self.colors['text'],
                          font=('Segoe UI', 10), bd=0, padx=10, pady=12,
                          cursor="hand2", command=command,
                          anchor='w', width=25)
            btn.pack(pady=2, padx=10)
        
        # –ö–Ω–æ–ø–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è
        close_btn = tk.Button(quick_panel, text="‚úï",
                            bg=self.colors['danger'], fg='white',
                            font=('Segoe UI', 10, 'bold'), bd=0,
                            cursor="hand2", command=quick_panel.destroy)
        close_btn.place(x=270, y=5, width=25, height=25)
    
    def save_all_data(self):
        """–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ–≥—Ä–∞–º–º—ã"""
        try:
            # –°–æ—Ö—Ä–∞–Ω—è–µ–º –∑–∞–¥–∞—á–∏ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏
            with open("automation_tasks.json", "w", encoding="utf-8") as f:
                json.dump(self.automation_tasks, f, ensure_ascii=False, indent=2)
            
            # –°–æ—Ö—Ä–∞–Ω—è–µ–º –∫–æ–¥ –∏–∑ —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞
            code = self.code_text.get(1.0, tk.END).strip()
            if code:
                with open("saved_code.py", "w", encoding="utf-8") as f:
                    f.write(code)
            
            # –°–æ—Ö—Ä–∞–Ω—è–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
            self.save_settings()
            
            self.speak("–í—Å–µ –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ")
            self.message_queue.put("–í—Å–µ –¥–∞–Ω–Ω—ã–µ –ø—Ä–æ–≥—Ä–∞–º–º—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã")
            
        except Exception as e:
            self.speak(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –¥–∞–Ω–Ω—ã—Ö: {str(e)[:30]}")
    
    def refresh_interface(self):
        """–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞"""
        self.speak("–û–±–Ω–æ–≤–ª—è—é –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å")
        self.message_queue.put("–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞...")
        
        # –ü–µ—Ä–µ–∑–∞–≥—Ä—É–∂–∞–µ–º —Ü–≤–µ—Ç–∞
        self.setup_colors()
        
        # –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å
        self.status_label.config(bg=self.colors['bg_light'], fg=self.colors['text_secondary'])
        
        self.speak("–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å –æ–±–Ω–æ–≤–ª–µ–Ω")
    
    def perform_search(self):
        """–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –ø–æ–∏—Å–∫–∞"""
        query = self.search_query.get().strip()
        if not query:
            self.speak("–í–≤–µ–¥–∏—Ç–µ –ø–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å")
            self.message_queue.put("–í–≤–µ–¥–∏—Ç–µ –ø–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å")
            return
        
        engine_name = self.search_engine_var.get()
        if engine_name not in self.settings["search_engines"]:
            engine_name = list(self.settings["search_engines"].keys())[0]
        
        base_url = self.settings["search_engines"][engine_name]
        search_url = base_url + quote(query.encode('utf-8'))
        
        self.open_url(search_url)
        self.message_queue.put(f"–ü–æ–∏—Å–∫ '{query}' –≤ {engine_name}")
        self.speak(f"–ò—â—É {query} –≤ {engine_name}")
    
    def search_and_play_video(self):
        """–ü–æ–∏—Å–∫ –∏ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –≤–∏–¥–µ–æ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é"""
        query = self.video_search_query.get().strip()
        if not query:
            self.speak("–í–≤–µ–¥–∏—Ç–µ –∑–∞–ø—Ä–æ—Å –¥–ª—è –ø–æ–∏—Å–∫–∞ –≤–∏–¥–µ–æ")
            self.message_queue.put("–í–≤–µ–¥–∏—Ç–µ –∑–∞–ø—Ä–æ—Å –¥–ª—è –ø–æ–∏—Å–∫–∞ –≤–∏–¥–µ–æ")
            return
        
        search_url = f"https://www.youtube.com/results?search_query={quote(query.encode('utf-8'))}"
        
        # –û—Ç–∫—Ä—ã–≤–∞–µ–º –ø–æ–∏—Å–∫ –≤–∏–¥–µ–æ
        self.open_url(search_url)
        self.message_queue.put(f"–ò—â—É –≤–∏–¥–µ–æ '{query}' –Ω–∞ YouTube")
        self.speak(f"–ò—â—É –≤–∏–¥–µ–æ {query} –Ω–∞ YouTube")
    
    def play_radio(self, url):
        """–í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç-—Ä–∞–¥–∏–æ"""
        try:
            self.open_url(url)
            self.message_queue.put(f"–†–∞–¥–∏–æ –∑–∞–ø—É—â–µ–Ω–æ: {url}")
            self.speak("–ó–∞–ø—É—Å–∫–∞—é –∏–Ω—Ç–µ—Ä–Ω–µ—Ç —Ä–∞–¥–∏–æ")
        except Exception as e:
            self.message_queue.put(f"–û—à–∏–±–∫–∞ –≤–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏—è —Ä–∞–¥–∏–æ: {e}")
            self.speak("–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–ø—É—Å—Ç–∏—Ç—å —Ä–∞–¥–∏–æ")
    
    def calc_button_click(self, button_text):
        """–û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞–∂–∞—Ç–∏—è –∫–Ω–æ–ø–∫–∏ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞"""
        current = self.calc_display.get()
        
        if button_text == '=':
            try:
                # –ó–∞–º–µ–Ω—è–µ–º —Å–∏–º–≤–æ–ª—ã –¥–ª—è eval
                expression = current.replace('√ó', '*').replace('√∑', '/')
                result = eval(expression)
                self.calc_display.set(str(result))
                self.speak(f"–†–µ–∑—É–ª—å—Ç–∞—Ç: {result}")
            except Exception as e:
                self.calc_display.set("–û—à–∏–±–∫–∞")
                self.speak("–û—à–∏–±–∫–∞ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è")
                self.root.after(2000, lambda: self.calc_display.set("0"))
        elif button_text == 'C':
            self.calc_display.set("0")
        elif current == "0" or current == "–û—à–∏–±–∫–∞":
            self.calc_display.set(button_text)
        else:
            self.calc_display.set(current + button_text)
    
    def open_file_explorer(self):
        """–û—Ç–∫—Ä—ã—Ç—å –ø—Ä–æ–≤–æ–¥–Ω–∏–∫ —Ñ–∞–π–ª–æ–≤"""
        try:
            if os.name == 'nt':  # Windows
                os.system('explorer .')
            elif os.name == 'posix':  # Linux, macOS
                os.system('xdg-open .' if os.name != 'darwin' else 'open .')
            
            self.message_queue.put("–û—Ç–∫—Ä—ã—Ç –ø—Ä–æ–≤–æ–¥–Ω–∏–∫ —Ñ–∞–π–ª–æ–≤")
            self.speak("–û—Ç–∫—Ä—ã–≤–∞—é –ø—Ä–æ–≤–æ–¥–Ω–∏–∫ —Ñ–∞–π–ª–æ–≤")
        except Exception as e:
            self.message_queue.put(f"–û—à–∏–±–∫–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è –ø—Ä–æ–≤–æ–¥–Ω–∏–∫–∞: {e}")
            self.speak("–ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–∫—Ä—ã—Ç—å –ø—Ä–æ–≤–æ–¥–Ω–∏–∫")
    
    def open_paint(self):
        """–û—Ç–∫—Ä—ã—Ç—å Paint"""
        try:
            if os.name == 'nt':  # Windows
                os.system('mspaint')
            elif os.name == 'posix':  # Linux
                os.system('pinta' if os.system('which pinta') == 0 else 'krita')
            elif os.name == 'darwin':  # macOS
                os.system('open -a Paintbrush')
            
            self.message_queue.put("–û—Ç–∫—Ä—ã—Ç Paint")
            self.speak("–û—Ç–∫—Ä—ã–≤–∞—é Paint")
        except Exception as e:
            self.message_queue.put(f"–û—à–∏–±–∫–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è Paint: {e}")
            self.speak("–ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–∫—Ä—ã—Ç—å Paint")
    
    def open_notepad(self):
        """–û—Ç–∫—Ä—ã—Ç—å –±–ª–æ–∫–Ω–æ—Ç"""
        try:
            notepad_window = tk.Toplevel(self.root)
            notepad_window.title("–ë–ª–æ–∫–Ω–æ—Ç - –ê—Ç–æ–º v4.0 PRO")
            notepad_window.geometry("600x400")
            notepad_window.configure(bg=self.colors['bg'])
            
            self.center_window(notepad_window)
            
            text_area = scrolledtext.ScrolledText(
                notepad_window,
                bg='#ffffff',
                fg='#000000',
                font=('Consolas', 10),
                wrap=tk.WORD,
                relief=tk.FLAT,
                borderwidth=0,
                padx=15,
                pady=15
            )
            text_area.pack(fill=tk.BOTH, expand=True, padx=10, pady=10)
            
            # –ü–∞–Ω–µ–ª—å –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–æ–≤
            toolbar = tk.Frame(notepad_window, bg=self.colors['bg_light'])
            toolbar.pack(fill=tk.X, padx=10, pady=(10, 0))
            
            def save_file():
                file_path = filedialog.asksaveasfilename(
                    defaultextension=".txt",
                    filetypes=[("Text files", "*.txt"), ("All files", "*.*")]
                )
                if file_path:
                    try:
                        with open(file_path, 'w', encoding='utf-8') as f:
                            f.write(text_area.get(1.0, tk.END))
                        self.message_queue.put(f"–§–∞–π–ª —Å–æ—Ö—Ä–∞–Ω–µ–Ω: {file_path}")
                        self.speak("–§–∞–π–ª —Å–æ—Ö—Ä–∞–Ω–µ–Ω")
                    except Exception as e:
                        self.message_queue.put(f"–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è: {e}")
            
            def open_file():
                file_path = filedialog.askopenfilename(
                    filetypes=[("Text files", "*.txt"), ("All files", "*.*")]
                )
                if file_path:
                    try:
                        with open(file_path, 'r', encoding='utf-8') as f:
                            text_area.delete(1.0, tk.END)
                            text_area.insert(1.0, f.read())
                        self.message_queue.put(f"–§–∞–π–ª –æ—Ç–∫—Ä—ã—Ç: {file_path}")
                        self.speak("–§–∞–π–ª –æ—Ç–∫—Ä—ã—Ç")
                    except Exception as e:
                        self.message_queue.put(f"–û—à–∏–±–∫–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è: {e}")
            
            save_btn = tk.Button(toolbar, text="üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å", bg=self.colors['primary'],
                               fg='white', font=('Segoe UI', 9), bd=0, padx=10,
                               cursor="hand2", command=save_file)
            save_btn.pack(side=tk.LEFT, padx=5)
            
            open_btn = tk.Button(toolbar, text="üìÇ –û—Ç–∫—Ä—ã—Ç—å", bg=self.colors['success'],
                               fg='white', font=('Segoe UI', 9), bd=0, padx=10,
                               cursor="hand2", command=open_file)
            open_btn.pack(side=tk.LEFT, padx=5)
            
            clear_btn = tk.Button(toolbar, text="üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å", bg=self.colors['danger'],
                                fg='white', font=('Segoe UI', 9), bd=0, padx=10,
                                cursor="hand2", command=lambda: text_area.delete(1.0, tk.END))
            clear_btn.pack(side=tk.LEFT, padx=5)
            
            self.message_queue.put("–û—Ç–∫—Ä—ã—Ç –±–ª–æ–∫–Ω–æ—Ç")
            self.speak("–û—Ç–∫—Ä—ã–≤–∞—é –±–ª–æ–∫–Ω–æ—Ç")
            
        except Exception as e:
            self.message_queue.put(f"–û—à–∏–±–∫–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è –±–ª–æ–∫–Ω–æ—Ç–∞: {e}")
            self.speak("–ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–∫—Ä—ã—Ç—å –±–ª–æ–∫–Ω–æ—Ç")
    
    def open_browser_window(self):
        """–û—Ç–∫—Ä—ã—Ç—å –æ–∫–Ω–æ –±—Ä–∞—É–∑–µ—Ä–∞"""
        try:
            browser = self.settings.get("default_browser", "default")
            browser_name = "–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é"
            
            for name, key in self.settings["browsers"].items():
                if key == browser:
                    browser_name = name
                    break
            
            url = "https://chat.deepseek.com/"
            self.open_url(url)
            
            self.message_queue.put(f"–û—Ç–∫—Ä—ã—Ç –±—Ä–∞—É–∑–µ—Ä ({browser_name}): {url}")
            self.speak(f"–û—Ç–∫—Ä—ã–≤–∞—é –±—Ä–∞—É–∑–µ—Ä. –ü–µ—Ä–µ—Ö–æ–∂—É –Ω–∞ DeepSeek AI")
            
        except Exception as e:
            self.message_queue.put(f"–û—à–∏–±–∫–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è –±—Ä–∞—É–∑–µ—Ä–∞: {e}")
            self.speak("–ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–∫—Ä—ã—Ç—å –±—Ä–∞—É–∑–µ—Ä")
    
    def open_deepseek(self):
        """–û—Ç–∫—Ä—ã—Ç—å DeepSeek AI"""
        deepseek_url = "https://chat.deepseek.com/"
        self.open_url(deepseek_url)
        self.message_queue.put("–û—Ç–∫—Ä—ã–≤–∞—é DeepSeek AI")
        self.speak("–û—Ç–∫—Ä—ã–≤–∞—é DeepSeek AI - —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–π –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç")
    
    def open_weather(self):
        """–û—Ç–∫—Ä—ã—Ç—å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–≥–æ–¥–µ"""
        city = self.settings.get("weather_city", "–ú–æ—Å–∫–≤–∞")
        
        if self.demo_mode:
            self.show_demo_weather(city)
        else:
            search_url = f"https://www.google.com/search?q=–ø–æ–≥–æ–¥–∞+{quote(city.encode('utf-8'))}"
            self.open_url(search_url)
            self.message_queue.put(f"–ü–æ–≥–æ–¥–∞ –¥–ª—è {city}")
            self.speak(f"–ü–æ–∫–∞–∑—ã–≤–∞—é –ø–æ–≥–æ–¥—É –≤ –≥–æ—Ä–æ–¥–µ {city}")
    
    def show_demo_weather(self, city):
        """–ü–æ–∫–∞–∑–∞—Ç—å –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—É—é –ø–æ–≥–æ–¥—É"""
        weather_window = tk.Toplevel(self.root)
        weather_window.title(f"–î–µ–º–æ: –ü–æ–≥–æ–¥–∞ –≤ {city}")
        weather_window.geometry("400x300")
        weather_window.configure(bg=self.colors['bg'])
        
        self.center_window(weather_window)
        
        canvas = tk.Canvas(weather_window, bg=self.colors['bg'], highlightthickness=0)
        canvas.pack(fill=tk.BOTH, expand=True)
        
        canvas.create_text(200, 50,
                          text=f"üå§Ô∏è –ü–æ–≥–æ–¥–∞ –≤ {city}",
                          fill=self.colors['primary_light'],
                          font=('Segoe UI', 20, 'bold'))
        
        weather_data = [
            ("–¢–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞", f"{random.randint(-10, 30)}¬∞C"),
            ("–û—â—É—â–∞–µ—Ç—Å—è –∫–∞–∫", f"{random.randint(-15, 28)}¬∞C"),
            ("–í–ª–∞–∂–Ω–æ—Å—Ç—å", f"{random.randint(40, 95)}%"),
            ("–í–µ—Ç–µ—Ä", f"{random.randint(0, 15)} –º/—Å"),
            ("–î–∞–≤–ª–µ–Ω–∏–µ", f"{random.randint(720, 780)} –º–º —Ä—Ç. —Å—Ç."),
            ("–í–∏–¥–∏–º–æ—Å—Ç—å", f"{random.randint(5, 20)} –∫–º")
        ]
        
        y_pos = 120
        for name, value in weather_data:
            canvas.create_text(150, y_pos,
                              text=name,
                              fill=self.colors['text_secondary'],
                              font=('Segoe UI', 11),
                              anchor="e")
            
            canvas.create_text(250, y_pos,
                              text=value,
                              fill=self.colors['text'],
                              font=('Segoe UI', 11, 'bold'),
                              anchor="w")
            y_pos += 30
        
        canvas.create_text(200, 250,
                          text="‚òÄÔ∏è‚õÖüåßÔ∏è‚ùÑÔ∏è",
                          fill=self.colors['primary_light'],
                          font=('Segoe UI Emoji', 24))
        
        canvas.create_text(200, 280,
                          text="–°–æ–ª–Ω–µ—á–Ω–æ, –æ–±–ª–∞—á–Ω–æ, –≤–æ–∑–º–æ–∂–µ–Ω –¥–æ–∂–¥—å",
                          fill=self.colors['text_secondary'],
                          font=('Segoe UI', 9))
        
        self.message_queue.put(f"–î–µ–º–æ-–ø–æ–≥–æ–¥–∞ –¥–ª—è {city}")
        self.speak(f"–ü–æ–∫–∞–∑—ã–≤–∞—é –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—É—é –ø–æ–≥–æ–¥—É –≤ –≥–æ—Ä–æ–¥–µ {city}")
    
    def show_clock(self):
        """–ü–æ–∫–∞–∑–∞—Ç—å —á–∞—Å—ã"""
        clock_window = tk.Toplevel(self.root)
        clock_window.title("–ß–∞—Å—ã - –ê—Ç–æ–º v4.0 PRO")
        clock_window.geometry("300x200")
        clock_window.configure(bg=self.colors['bg'])
        
        self.center_window(clock_window)
        
        canvas = tk.Canvas(clock_window, bg=self.colors['bg'], highlightthickness=0)
        canvas.pack(fill=tk.BOTH, expand=True)
        
        time_label = tk.Label(canvas,
                            text=time.strftime("%H:%M:%S"),
                            bg=self.colors['bg'],
                            fg=self.colors['primary_light'],
                            font=('Consolas', 36, 'bold'))
        canvas.create_window(150, 80, window=time_label)
        
        date_label = tk.Label(canvas,
                            text=time.strftime("%d.%m.%Y"),
                            bg=self.colors['bg'],
                            fg=self.colors['text'],
                            font=('Segoe UI', 16))
        canvas.create_window(150, 120, window=date_label)
        
        days = ["–ü–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫", "–í—Ç–æ—Ä–Ω–∏–∫", "–°—Ä–µ–¥–∞", "–ß–µ—Ç–≤–µ—Ä–≥", "–ü—è—Ç–Ω–∏—Ü–∞", "–°—É–±–±–æ—Ç–∞", "–í–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ"]
        day_label = tk.Label(canvas,
                           text=days[int(time.strftime("%w")) - 1],
                           bg=self.colors['bg'],
                           fg=self.colors['text_secondary'],
                           font=('Segoe UI', 12))
        canvas.create_window(150, 150, window=day_label)
        
        def update_clock():
            if clock_window.winfo_exists():
                current_time = time.strftime("%H:%M:%S")
                time_label.config(text=current_time)
                clock_window.after(1000, update_clock)
        
        update_clock()
        
        self.message_queue.put("–û—Ç–∫—Ä—ã—Ç—ã —á–∞—Å—ã")
        self.speak("–ü–æ–∫–∞–∑—ã–≤–∞—é —Ç–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è")
    
    def open_url(self, url):
        """–û—Ç–∫—Ä—ã—Ç—å URL –≤ –±—Ä–∞—É–∑–µ—Ä–µ"""
        try:
            browser = self.settings.get("default_browser", "default")
            
            if browser == "default":
                webbrowser.open(url)
            else:
                webbrowser.get(browser).open(url)
                
            return True
        except Exception as e:
            try:
                webbrowser.open(url)
                return True
            except:
                self.message_queue.put(f"–û—à–∏–±–∫–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è URL: {e}")
                return False
    
    def toggle_voice_assistant(self):
        """–í–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å –≥–æ–ª–æ—Å–æ–≤–æ–≥–æ –ø–æ–º–æ—â–Ω–∏–∫–∞"""
        if not SPEECH_AVAILABLE and not VOICE_INPUT_AVAILABLE:
            self.speak("–ì–æ–ª–æ—Å–æ–≤–æ–π –ø–æ–º–æ—â–Ω–∏–∫ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω")
            self.message_queue.put("–ì–æ–ª–æ—Å–æ–≤–æ–π –ø–æ–º–æ—â–Ω–∏–∫ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω")
            return
        
        self.voice_assistant_active = not self.voice_assistant_active
        self.background_listening = self.voice_assistant_active
        
        if self.voice_assistant_active:
            self.speak(f"–ì–æ–ª–æ—Å–æ–≤–æ–π –ø–æ–º–æ—â–Ω–∏–∫ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω")
            self.message_queue.put(f"–ì–æ–ª–æ—Å–æ–≤–æ–π –ø–æ–º–æ—â–Ω–∏–∫ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω")
            self.status_label.config(text=f"üé§ –û–∂–∏–¥–∞–Ω–∏–µ: '{self.voice_wake_word}'", fg=self.colors['primary_light'])
            self.start_voice_assistant()
        else:
            self.background_listening = False
            self.speak("–ì–æ–ª–æ—Å–æ–≤–æ–π –ø–æ–º–æ—â–Ω–∏–∫ –æ—Ç–∫–ª—é—á–µ–Ω")
            self.message_queue.put("–ì–æ–ª–æ—Å–æ–≤–æ–π –ø–æ–º–æ—â–Ω–∏–∫ –æ—Ç–∫–ª—é—á–µ–Ω")
            self.status_label.config(text="–ì–æ–ª–æ—Å–æ–≤–æ–π –ø–æ–º–æ—â–Ω–∏–∫ –æ—Ç–∫–ª—é—á–µ–Ω", fg=self.colors['danger'])
    
    def open_settings(self):
        """–û—Ç–∫—Ä—ã—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏"""
        settings_window = tk.Toplevel(self.root)
        settings_window.title("–ù–∞—Å—Ç—Ä–æ–π–∫–∏ - –ê—Ç–æ–º v4.0 PRO")
        settings_window.geometry("800x700")
        settings_window.configure(bg=self.colors['bg'])
        
        self.center_window(settings_window)
        
        notebook = ttk.Notebook(settings_window)
        notebook.pack(fill=tk.BOTH, expand=True, padx=10, pady=10)
        
        general_frame = tk.Frame(notebook, bg=self.colors['bg'])
        notebook.add(general_frame, text="–û–±—â–∏–µ")
        
        voice_frame = tk.Frame(notebook, bg=self.colors['bg'])
        notebook.add(voice_frame, text="–ì–æ–ª–æ—Å")
        
        appearance_frame = tk.Frame(notebook, bg=self.colors['bg'])
        notebook.add(appearance_frame, text="–í–Ω–µ—à–Ω–∏–π –≤–∏–¥")
        
        self.create_general_settings(general_frame)
        self.create_improved_voice_settings(voice_frame)
        self.create_appearance_settings(appearance_frame)
        
        buttons_frame = tk.Frame(settings_window, bg=self.colors['bg_light'])
        buttons_frame.pack(fill=tk.X, padx=10, pady=10)
        
        def save_settings():
            self.settings["wake_word"] = self.voice_wake_word
            self.settings["wake_word_sensitivity"] = self.wake_sensitivity
            
            variants_text = self.wake_variants_var.get()
            variants = [v.strip().lower() for v in variants_text.split(",") if v.strip()]
            if variants:
                self.settings["wake_word_variants"] = variants
                self.activation_phrases = variants
            
            self.save_settings()
            settings_window.destroy()
            self.speak("–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã")
            self.message_queue.put("–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã")
            
            if self.voice_assistant_active:
                self.background_listening = False
                time.sleep(0.5)
                self.background_listening = True
                self.start_voice_assistant()
        
        save_btn = tk.Button(buttons_frame, text="üíæ –°–æ—Ö—Ä–∞–Ω–∏—Ç—å",
                           bg=self.colors['success'], fg='white',
                           font=('Segoe UI', 10, 'bold'), bd=0, padx=20, pady=10,
                           cursor="hand2", command=save_settings)
        save_btn.pack(side=tk.RIGHT, padx=5)
        
        cancel_btn = tk.Button(buttons_frame, text="‚ùå –û—Ç–º–µ–Ω–∞",
                             bg=self.colors['danger'], fg='white',
                             font=('Segoe UI', 10, 'bold'), bd=0, padx=20, pady=10,
                             cursor="hand2", command=settings_window.destroy)
        cancel_btn.pack(side=tk.RIGHT, padx=5)
    
    def create_general_settings(self, parent):
        """–°–æ–∑–¥–∞–Ω–∏–µ –æ–±—â–∏—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫"""
        row = 0
        
        tk.Label(parent, text="–ü–æ–∏—Å–∫–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:",
                bg=self.colors['bg'], fg=self.colors['text'],
                font=('Segoe UI', 11)).grid(row=row, column=0, sticky='w', padx=20, pady=10)
        
        search_engine_var = tk.StringVar(value=list(self.settings["search_engines"].keys())[0])
        search_combo = ttk.Combobox(parent, textvariable=search_engine_var,
                                   values=list(self.settings["search_engines"].keys()),
                                   state='readonly', width=30, font=('Segoe UI', 10))
        search_combo.grid(row=row, column=1, padx=20, pady=10, sticky='w')
        row += 1
        
        tk.Label(parent, text="–ì–æ—Ä–æ–¥ –¥–ª—è –ø–æ–≥–æ–¥—ã:",
                bg=self.colors['bg'], fg=self.colors['text'],
                font=('Segoe UI', 11)).grid(row=row, column=0, sticky='w', padx=20, pady=10)
        
        weather_city_var = tk.StringVar(value=self.settings.get("weather_city", "–ú–æ—Å–∫–≤–∞"))
        weather_entry = tk.Entry(parent, textvariable=weather_city_var,
                                font=('Segoe UI', 11), bg=self.colors['bg_lighter'],
                                fg=self.colors['text'], width=30)
        weather_entry.grid(row=row, column=1, padx=20, pady=10, sticky='w')
        row += 1
        
        tk.Label(parent, text="–ë—Ä–∞—É–∑–µ—Ä –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:",
                bg=self.colors['bg'], fg=self.colors['text'],
                font=('Segoe UI', 11)).grid(row=row, column=0, sticky='w', padx=20, pady=10)
        
        browser_var = tk.StringVar(value=self.settings.get("default_browser", "default"))
        browser_combo = ttk.Combobox(parent, textvariable=browser_var,
                                    values=list(self.settings["browsers"].keys()),
                                    state='readonly', width=30, font=('Segoe UI', 10))
        browser_combo.grid(row=row, column=1, padx=20, pady=10, sticky='w')
        row += 1
        
        auto_start_var = tk.BooleanVar(value=self.settings.get("auto_start", True))
        auto_start_check = tk.Checkbutton(parent, text="–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ —Å–∏—Å—Ç–µ–º—ã",
                                         variable=auto_start_var,
                                         bg=self.colors['bg'], fg=self.colors['text'],
                                         font=('Segoe UI', 11))
        auto_start_check.grid(row=row, column=0, columnspan=2, sticky='w', padx=20, pady=10)
        row += 1
        
        notifications_var = tk.BooleanVar(value=self.settings.get("notifications", True))
        notifications_check = tk.Checkbutton(parent, text="–ü–æ–∫–∞–∑—ã–≤–∞—Ç—å —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è",
                                           variable=notifications_var,
                                           bg=self.colors['bg'], fg=self.colors['text'],
                                           font=('Segoe UI', 11))
        notifications_check.grid(row=row, column=0, columnspan=2, sticky='w', padx=20, pady=10)
        row += 1
    
    def create_improved_voice_settings(self, parent):
        """–°–æ–∑–¥–∞–Ω–∏–µ —É–ª—É—á—à–µ–Ω–Ω—ã—Ö –≥–æ–ª–æ—Å–æ–≤—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫"""
        row = 0
        
        tk.Label(parent, text="–ö–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ –¥–ª—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏:",
                bg=self.colors['bg'], fg=self.colors['text'],
                font=('Segoe UI', 11)).grid(row=row, column=0, sticky='w', padx=20, pady=10)
        
        self.wake_word_var = tk.StringVar(value=self.voice_wake_word)
        wake_word_entry = tk.Entry(parent, textvariable=self.wake_word_var,
                                  font=('Segoe UI', 11), bg=self.colors['bg_lighter'],
                                  fg=self.colors['text'], width=30)
        wake_word_entry.grid(row=row, column=1, padx=20, pady=10, sticky='w')
        row += 1
        
        tk.Label(parent, text="–í–∞—Ä–∏–∞–Ω—Ç—ã —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è (—á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é):",
                bg=self.colors['bg'], fg=self.colors['text'],
                font=('Segoe UI', 11)).grid(row=row, column=0, sticky='w', padx=20, pady=10)
        
        variants_text = ", ".join(self.activation_phrases)
        self.wake_variants_var = tk.StringVar(value=variants_text)
        wake_variants_entry = tk.Entry(parent, textvariable=self.wake_variants_var,
                                      font=('Segoe UI', 11), bg=self.colors['bg_lighter'],
                                      fg=self.colors['text'], width=30)
        wake_variants_entry.grid(row=row, column=1, padx=20, pady=10, sticky='w')
        row += 1
        
        tk.Label(parent, text="–ß—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è:",
                bg=self.colors['bg'], fg=self.colors['text'],
                font=('Segoe UI', 11)).grid(row=row, column=0, sticky='w', padx=20, pady=10)
        
        sensitivity_frame = tk.Frame(parent, bg=self.colors['bg'])
        sensitivity_frame.grid(row=row, column=1, padx=20, pady=10, sticky='w')
        
        self.sensitivity_var = tk.DoubleVar(value=self.wake_sensitivity)
        sensitivity_scale = tk.Scale(sensitivity_frame, from_=0.1, to=1.0, 
                                    resolution=0.1, orient=tk.HORIZONTAL,
                                    variable=self.sensitivity_var,
                                    length=200, bg=self.colors['bg_lighter'],
                                    fg=self.colors['text'], highlightthickness=0)
        sensitivity_scale.pack()
        
        sensitivity_label = tk.Label(sensitivity_frame, 
                                    text=f"–¢–µ–∫—É—â–∞—è: {self.wake_sensitivity:.1f}",
                                    bg=self.colors['bg'], fg=self.colors['text_secondary'],
                                    font=('Segoe UI', 9))
        sensitivity_label.pack()
        
        def update_sensitivity_label(*args):
            sensitivity_label.config(text=f"–¢–µ–∫—É—â–∞—è: {self.sensitivity_var.get():.1f}")
        
        self.sensitivity_var.trace_add('write', update_sensitivity_label)
        row += 1
        
        voice_enabled_var = tk.BooleanVar(value=self.settings.get("voice_enabled", True))
        voice_enabled_check = tk.Checkbutton(parent, text="–í–∫–ª—é—á–∏—Ç—å –≥–æ–ª–æ—Å–æ–≤–æ–≥–æ –ø–æ–º–æ—â–Ω–∏–∫–∞",
                                           variable=voice_enabled_var,
                                           bg=self.colors['bg'], fg=self.colors['text'],
                                           font=('Segoe UI', 11))
        voice_enabled_check.grid(row=row, column=0, columnspan=2, sticky='w', padx=20, pady=10)
        row += 1
        
        voice_feedback_var = tk.BooleanVar(value=self.settings.get("voice_feedback", True))
        voice_feedback_check = tk.Checkbutton(parent, text="–û–∑–≤—É—á–∏–≤–∞—Ç—å –≤—Å–µ –¥–µ–π—Å—Ç–≤–∏—è",
                                             variable=voice_feedback_var,
                                             bg=self.colors['bg'], fg=self.colors['text'],
                                             font=('Segoe UI', 11))
        voice_feedback_check.grid(row=row, column=0, columnspan=2, sticky='w', padx=20, pady=10)
        row += 1
        
        tk.Label(parent, text="–°–∫–æ—Ä–æ—Å—Ç—å —Ä–µ—á–∏:",
                bg=self.colors['bg'], fg=self.colors['text'],
                font=('Segoe UI', 11)).grid(row=row, column=0, sticky='w', padx=20, pady=10)
        
        speed_var = tk.IntVar(value=self.settings.get("voice_speed", 150))
        speed_scale = tk.Scale(parent, from_=100, to=300, 
                              resolution=10, orient=tk.HORIZONTAL,
                              variable=speed_var,
                              length=200, bg=self.colors['bg_lighter'],
                              fg=self.colors['text'], highlightthickness=0)
        speed_scale.grid(row=row, column=1, padx=20, pady=10, sticky='w')
        row += 1
        
        tk.Label(parent, text="–ì—Ä–æ–º–∫–æ—Å—Ç—å:",
                bg=self.colors['bg'], fg=self.colors['text'],
                font=('Segoe UI', 11)).grid(row=row, column=0, sticky='w', padx=20, pady=10)
        
        volume_var = tk.DoubleVar(value=self.settings.get("voice_volume", 0.9))
        volume_scale = tk.Scale(parent, from_=0.1, to=1.0, 
                               resolution=0.1, orient=tk.HORIZONTAL,
                               variable=volume_var,
                               length=200, bg=self.colors['bg_lighter'],
                              fg=self.colors['text'], highlightthickness=0)
        volume_scale.grid(row=row, column=1, padx=20, pady=10, sticky='w')
        row += 1
        
        test_frame = tk.Frame(parent, bg=self.colors['bg'])
        test_frame.grid(row=row, column=0, columnspan=2, pady=20, padx=20, sticky='w')
        
        def test_wake_word():
            self.speak(f"–¢–µ—Å—Ç–∏—Ä—É—é —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏–µ –∫–ª—é—á–µ–≤–æ–≥–æ —Å–ª–æ–≤–∞...")
            messagebox.showinfo("–¢–µ—Å—Ç", 
                f"–ü—Ä–æ–∏–∑–Ω–µ—Å–∏—Ç–µ –æ–¥–Ω–æ –∏–∑ –∫–ª—é—á–µ–≤—ã—Ö —Å–ª–æ–≤:\n{', '.join(self.activation_phrases)}\n\n"
                f"–ß—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: {self.sensitivity_var.get():.1f}")
        
        test_btn = tk.Button(test_frame, text="üé§ –¢–µ—Å—Ç —Ä–∞—Å–ø–æ–∑–Ω–∞–≤–∞–Ω–∏—è",
                           bg=self.colors['primary'], fg='white',
                           font=('Segoe UI', 10, 'bold'), bd=0, padx=20, pady=10,
                           cursor="hand2", command=test_wake_word)
        test_btn.pack(side=tk.LEFT, padx=5)
        
        def calibrate_microphone():
            self.speak("–ö–∞–ª–∏–±—Ä–æ–≤–∫–∞ –º–∏–∫—Ä–æ—Ñ–æ–Ω–∞. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–º–æ–ª—á–∏—Ç–µ 3 —Å–µ–∫—É–Ω–¥—ã.")
            try:
                with sr.Microphone() as source:
                    self.recognizer.adjust_for_ambient_noise(source, duration=3)
                    self.speak("–ö–∞–ª–∏–±—Ä–æ–≤–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞. –ú–∏–∫—Ä–æ—Ñ–æ–Ω –Ω–∞—Å—Ç—Ä–æ–µ–Ω.")
                    messagebox.showinfo("–ö–∞–ª–∏–±—Ä–æ–≤–∫–∞", "–ú–∏–∫—Ä–æ—Ñ–æ–Ω —É—Å–ø–µ—à–Ω–æ –æ—Ç–∫–∞–ª–∏–±—Ä–æ–≤–∞–Ω.")
            except Exception as e:
                messagebox.showerror("–û—à–∏–±–∫–∞", f"–ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–∫–∞–ª–∏–±—Ä–æ–≤–∞—Ç—å –º–∏–∫—Ä–æ—Ñ–æ–Ω: {e}")
        
        calibrate_btn = tk.Button(test_frame, text="üéöÔ∏è –ö–∞–ª–∏–±—Ä–æ–≤–∞—Ç—å –º–∏–∫—Ä–æ—Ñ–æ–Ω",
                                bg=self.colors['warning'], fg='white',
                                font=('Segoe UI', 10, 'bold'), bd=0, padx=20, pady=10,
                                cursor="hand2", command=calibrate_microphone)
        calibrate_btn.pack(side=tk.LEFT, padx=5)
        
        def update_wake_word(*args):
            new_word = self.wake_word_var.get().strip().lower()
            if new_word:
                self.voice_wake_word = new_word
                if new_word not in self.activation_phrases:
                    self.activation_phrases.append(new_word)
                    variants_text = ", ".join(self.activation_phrases)
                    self.wake_variants_var.set(variants_text)
        
        def update_sensitivity(*args):
            self.wake_sensitivity = self.sensitivity_var.get()
        
        self.wake_word_var.trace_add('write', update_wake_word)
        self.sensitivity_var.trace_add('write', update_sensitivity)
        
        def save_voice_settings():
            self.settings["voice_enabled"] = voice_enabled_var.get()
            self.settings["voice_feedback"] = voice_feedback_var.get()
            self.settings["voice_speed"] = speed_var.get()
            self.settings["voice_volume"] = volume_var.get()
            
            if self.speech_engine:
                self.speech_engine.setProperty('rate', speed_var.get())
                self.speech_engine.setProperty('volume', volume_var.get())
        
        voice_enabled_var.trace_add('write', lambda *args: save_voice_settings())
        voice_feedback_var.trace_add('write', lambda *args: save_voice_settings())
        speed_var.trace_add('write', lambda *args: save_voice_settings())
        volume_var.trace_add('write', lambda *args: save_voice_settings())
    
    def create_appearance_settings(self, parent):
        """–°–æ–∑–¥–∞–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –≤–Ω–µ—à–Ω–µ–≥–æ –≤–∏–¥–∞"""
        row = 0
        
        tk.Label(parent, text="–¢–µ–º–∞ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è:",
                bg=self.colors['bg'], fg=self.colors['text'],
                font=('Segoe UI', 11)).grid(row=row, column=0, sticky='w', padx=20, pady=10)
        
        theme_var = tk.StringVar(value=self.settings.get("theme", "dark"))
        theme_combo = ttk.Combobox(parent, textvariable=theme_var,
                                  values=["dark", "light", "blue", "green"],
                                  state='readonly', width=30, font=('Segoe UI', 10))
        theme_combo.grid(row=row, column=1, padx=20, pady=10, sticky='w')
        row += 1
        
        tk.Label(parent, text="–û—Å–Ω–æ–≤–Ω–æ–π —Ü–≤–µ—Ç:",
                bg=self.colors['bg'], fg=self.colors['text'],
                font=('Segoe UI', 11)).grid(row=row, column=0, sticky='w', padx=20, pady=10)
        
        color_var = tk.StringVar(value=self.settings.get("theme_color", "#3b82f6"))
        color_entry = tk.Entry(parent, textvariable=color_var,
                              font=('Segoe UI', 11), bg=self.colors['bg_lighter'],
                              fg=self.colors['text'], width=30)
        color_entry.grid(row=row, column=1, padx=20, pady=10, sticky='w')
        row += 1
        
        tk.Label(parent, text="–†–∞–∑–º–µ—Ä —à—Ä–∏—Ñ—Ç–∞:",
                bg=self.colors['bg'], fg=self.colors['text'],
                font=('Segoe UI', 11)).grid(row=row, column=0, sticky='w', padx=20, pady=10)
        
        font_size_var = tk.StringVar(value=self.settings.get("font_size", "normal"))
        font_combo = ttk.Combobox(parent, textvariable=font_size_var,
                                 values=["small", "normal", "large", "x-large"],
                                 state='readonly', width=30, font=('Segoe UI', 10))
        font_combo.grid(row=row, column=1, padx=20, pady=10, sticky='w')
        row += 1
        
        animations_var = tk.BooleanVar(value=self.settings.get("animations", True))
        animations_check = tk.Checkbutton(parent, text="–í–∫–ª—é—á–∏—Ç—å –∞–Ω–∏–º–∞—Ü–∏–∏",
                                        variable=animations_var,
                                        bg=self.colors['bg'], fg=self.colors['text'],
                                        font=('Segoe UI', 11))
        animations_check.grid(row=row, column=0, columnspan=2, sticky='w', padx=20, pady=10)
        row += 1
    
    def switch_mode(self):
        """–ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É –¥–µ–º–æ –∏ —Ä–∞–±–æ—á–∏–º —Ä–µ–∂–∏–º–æ–º"""
        self.demo_mode = not self.demo_mode
        self.settings["demo_mode"] = self.demo_mode
        self.save_settings()
        
        mode_name = "–¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π" if self.demo_mode else "—Ä–∞–±–æ—á–∏–π"
        self.speak(f"–ü–µ—Ä–µ–∫–ª—é—á–µ–Ω –≤ {mode_name} —Ä–µ–∂–∏–º")
        self.text_anim.show_transition(f"{mode_name.capitalize()} —Ä–µ–∂–∏–º", 2)
        
        self.root.after(2500, self.create_main_interface)
    
    def logout_or_exit(self):
        """–í—ã—Ö–æ–¥ –∏–ª–∏ —Å–º–µ–Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"""
        if self.logged_in:
            choice_window = tk.Toplevel(self.root)
            choice_window.title("–í—ã—Ö–æ–¥")
            choice_window.geometry("300x200")
            choice_window.configure(bg=self.colors['bg'])
            choice_window.resizable(False, False)
            
            self.center_window(choice_window)
            
            tk.Label(choice_window, text="–í—ã–±–µ—Ä–∏—Ç–µ –¥–µ–π—Å—Ç–≤–∏–µ:",
                    bg=self.colors['bg'], fg=self.colors['text'],
                    font=('Segoe UI', 14)).pack(pady=30)
            
            logout_btn = tk.Button(choice_window, text="üîÑ –°–º–µ–Ω–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è",
                                 bg=self.colors['primary'], fg='white',
                                 font=('Segoe UI', 10, 'bold'), bd=0, padx=20, pady=10,
                                 cursor="hand2", command=lambda: [choice_window.destroy(), self.logout_user()])
            logout_btn.pack(pady=10)
            
            exit_btn = tk.Button(choice_window, text="üö™ –í—ã–π—Ç–∏ –∏–∑ –ø—Ä–æ–≥—Ä–∞–º–º—ã",
                               bg=self.colors['danger'], fg='white',
                               font=('Segoe UI', 10, 'bold'), bd=0, padx=20, pady=10,
                               cursor="hand2", command=self.on_closing)
            exit_btn.pack(pady=10)
            
            cancel_btn = tk.Button(choice_window, text="‚ùå –û—Ç–º–µ–Ω–∞",
                                 bg=self.colors['bg_lighter'], fg=self.colors['text'],
                                 font=('Segoe UI', 10), bd=0, padx=20, pady=10,
                                 cursor="hand2", command=choice_window.destroy)
            cancel_btn.pack(pady=10)
        else:
            self.on_closing()
    
    def open_calculator(self):
        """–û—Ç–∫—Ä—ã—Ç—å –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä"""
        self.notebook.select(3)
        self.speak("–û—Ç–∫—Ä—ã–≤–∞—é –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä")
    
    def start_demo(self):
        """–ó–∞–ø—É—Å–∫ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ –≤ –¥–µ–º–æ-—Ä–µ–∂–∏–º–µ"""
        if not self.demo_mode:
            return
        
        self.message_queue.put("–ó–∞–ø—É—Å–∫ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏...")
        self.speak("–ó–∞–ø—É—Å–∫–∞—é –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—é –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–µ–π –ê—Ç–æ–º v4.0 PRO")
        
        demo_steps = [
            (2000, lambda: self.speak("–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –≥–æ–ª–æ—Å–æ–≤–æ–≥–æ –ø–æ–º–æ—â–Ω–∏–∫–∞")),
            (4000, lambda: self.speak("–°–µ–π—á–∞—Å –ø–æ–∫–∞–∂—É –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –ø–æ–∏—Å–∫–∞")),
            (6000, lambda: [self.search_query.set("–ø—Ä–∏–º–µ—Ä –ø–æ–∏—Å–∫–∞"), self.perform_search()]),
            (9000, lambda: self.speak("–û—Ç–∫—Ä—ã–≤–∞—é —Å–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–µ—Ç–∏")),
            (10000, lambda: self.notebook.select(1)),
            (12000, lambda: self.speak("–ü–æ–∫–∞–∑—ã–≤–∞—é –º–µ–¥–∏–∞ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏")),
            (13000, lambda: self.notebook.select(2)),
            (14000, lambda: [self.video_search_query.set("–º—É–∑—ã–∫–∞"), self.search_and_play_video()]),
            (17000, lambda: self.speak("–î–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É—é –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã")),
            (18000, lambda: self.notebook.select(3)),
            (19000, lambda: self.open_calculator()),
            (22000, lambda: self.speak("–î–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É—é –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—é")),
            (23000, lambda: self.notebook.select(4)),
            (24000, lambda: self.add_template_task("–û—Ç–∫—Ä—ã—Ç—å –≤—Å–µ —Å–æ—Ü–∏–∞–ª—å–Ω—ã–µ —Å–µ—Ç–∏")),
            (27000, lambda: self.speak("–î–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É—é —Ä–µ–¥–∞–∫—Ç–æ—Ä –∫–æ–¥–∞")),
            (28000, lambda: self.notebook.select(5)),
            (30000, lambda: self.speak("–î–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É—é –ò–ò-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞")),
            (31000, lambda: self.notebook.select(6)),
            (32000, lambda: self.train_neural_network_ui()),
            (35000, lambda: self.speak("–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞")),
            (36000, lambda: self.message_queue.put("–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞"))
        ]
        
        for delay, action in demo_steps:
            self.root.after(delay, action)
    
    def process_queue(self):
        """–û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—á–µ—Ä–µ–¥–∏ —Å–æ–æ–±—â–µ–Ω–∏–π"""
        try:
            while not self.message_queue.empty():
                message = self.message_queue.get_nowait()
                self.add_to_log(message)
        except queue.Empty:
            pass
        finally:
            if self.running:
                self.root.after(100, self.process_queue)
    
    def add_to_log(self, message):
        """–î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –ª–æ–≥"""
        try:
            timestamp = time.strftime("%H:%M:%S")
            log_entry = f"[{timestamp}] {message}\n"
            
            self.log_text.config(state=tk.NORMAL)
            self.log_text.insert(tk.END, log_entry)
            self.log_text.see(tk.END)
            self.log_text.config(state=tk.DISABLED)
        except Exception as e:
            print(f"–û—à–∏–±–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ –ª–æ–≥: {e}")
    
    def play_activation_sound(self):
        """–í–æ—Å–ø—Ä–æ–∏–∑–≤–µ–¥–µ–Ω–∏–µ –∑–≤—É–∫–∞ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏"""
        try:
            if WINSOUND_AVAILABLE:
                winsound.Beep(1000, 200)
        except:
            pass
    
    def is_similar(self, phrase, text, threshold=0.7):
        """–ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—Ö–æ–∂–µ—Å—Ç—å —Ñ—Ä–∞–∑"""
        if phrase in text or text in phrase:
            return True
        
        if len(phrase) >= 3 and len(text) >= 3:
            if phrase[:3] == text[:3]:
                return True
            
            if phrase[-3:] == text[-3:]:
                return True
        
        return False
    
    def process_enhanced_command(self, command):
        """–û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã—Ö –≥–æ–ª–æ—Å–æ–≤—ã—Ö –∫–æ–º–∞–Ω–¥"""
        print(f"–û–±—Ä–∞–±–∞—Ç—ã–≤–∞—é –∫–æ–º–∞–Ω–¥—É: '{command}'")
        
        original_command = command
        
        for phrase in self.activation_phrases:
            if command.startswith(phrase):
                command = command[len(phrase):].strip()
                print(f"–û—á–∏—â–µ–Ω–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞: '{command}'")
        
        command = command.replace(",", "").replace(".", "").replace("!", "").replace("?", "").strip()
        
        if not command:
            command = original_command
            print(f"–ò—Å–ø–æ–ª—å–∑—É—é –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—É—é –∫–æ–º–∞–Ω–¥—É: '{command}'")
        
        words = command.split()
        
        if not words:
            print("‚úó –ü—É—Å—Ç–∞—è –∫–æ–º–∞–Ω–¥–∞")
            self.speak("–ù–µ —É—Å–ª—ã—à–∞–ª –∫–æ–º–∞–Ω–¥—É")
            self.status_label.config(text=f"üé§ –û–∂–∏–¥–∞–Ω–∏–µ: '{self.voice_wake_word}'", fg=self.colors['primary_light'])
            return
        
        command_lower = command.lower()
        
        print(f"–ê–Ω–∞–ª–∏–∑–∏—Ä—É—é –∫–æ–º–∞–Ω–¥—É: '{command_lower}'")
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–æ–≤—ã–µ –∫–æ–º–∞–Ω–¥—ã –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏
        if "–¥–æ–±–∞–≤—å –∑–∞–¥–∞—á—É" in command_lower:
            task = command_lower.replace("–¥–æ–±–∞–≤—å –∑–∞–¥–∞—á—É", "").strip()
            if task:
                self.automation_tasks.append(task)
                self.message_queue.put(f"–ó–∞–¥–∞—á–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∞: {task}")
                self.speak(f"–ó–∞–¥–∞—á–∞ '{task}' –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤ —Å–ø–∏—Å–æ–∫ –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏")
                self.status_label.config(text=f"üé§ –û–∂–∏–¥–∞–Ω–∏–µ: '{self.voice_wake_word}'", fg=self.colors['primary_light'])
                return True
        
        elif "–ø–æ–∫–∞–∂–∏ –∑–∞–¥–∞—á–∏" in command_lower or "—Å–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á" in command_lower:
            if self.automation_tasks:
                tasks_text = ", ".join(self.automation_tasks[:5])
                self.speak(f"–£ –≤–∞—Å {len(self.automation_tasks)} –∑–∞–¥–∞—á: {tasks_text}")
            else:
                self.speak("–°–ø–∏—Å–æ–∫ –∑–∞–¥–∞—á –ø—É—Å—Ç")
            self.status_label.config(text=f"üé§ –û–∂–∏–¥–∞–Ω–∏–µ: '{self.voice_wake_word}'", fg=self.colors['primary_light'])
            return True
        
        elif "–≤—ã–ø–æ–ª–Ω–∏ –∑–∞–¥–∞—á–∏" in command_lower or "–∑–∞–ø—É—Å—Ç–∏ –∑–∞–¥–∞—á–∏" in command_lower:
            self.run_automation_tasks()
            self.status_label.config(text=f"üé§ –û–∂–∏–¥–∞–Ω–∏–µ: '{self.voice_wake_word}'", fg=self.colors['primary_light'])
            return True
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ–º–∞–Ω–¥—ã –¥–ª—è —Ä–µ–¥–∞–∫—Ç–æ—Ä–∞ –∫–æ–¥–∞
        elif "–Ω–æ–≤—ã–π –∫–æ–¥" in command_lower or "—á–∏—Å—Ç—ã–π —Ä–µ–¥–∞–∫—Ç–æ—Ä" in command_lower:
            self.code_text.delete(1.0, tk.END)
            self.speak("–†–µ–¥–∞–∫—Ç–æ—Ä –∫–æ–¥–∞ –æ—á–∏—â–µ–Ω")
            self.status_label.config(text=f"üé§ –û–∂–∏–¥–∞–Ω–∏–µ: '{self.voice_wake_word}'", fg=self.colors['primary_light'])
            return True
        
        elif "—Å–æ—Ö—Ä–∞–Ω–∏ –∫–æ–¥" in command_lower:
            self.save_code()
            self.status_label.config(text=f"üé§ –û–∂–∏–¥–∞–Ω–∏–µ: '{self.voice_wake_word}'", fg=self.colors['primary_light'])
            return True
        
        # –°–∏—Å—Ç–µ–º–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã
        elif "—Å–∫—Ä–∏–Ω—à–æ—Ç" in command_lower:
            self.take_screenshot()
            self.status_label.config(text=f"üé§ –û–∂–∏–¥–∞–Ω–∏–µ: '{self.voice_wake_word}'", fg=self.colors['primary_light'])
            return True
        
        # –ò–ò –∫–æ–º–∞–Ω–¥—ã
        elif any(word in command_lower for word in ['–ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π —Ç–µ–∫—Å—Ç', '–∞–Ω–∞–ª–∏–∑ —Ç–µ–∫—Å—Ç–∞', '–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞']):
            text = command_lower.replace("–ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π —Ç–µ–∫—Å—Ç", "").replace("–∞–Ω–∞–ª–∏–∑ —Ç–µ–∫—Å—Ç–∞", "").replace("–Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞", "").strip()
            if text:
                sentiment, score = self.ai_assistant.sentiment_analyzer.analyze(text)
                response = f"–ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—Å—Ç–∞: –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ - {sentiment}, —É–≤–µ—Ä–µ–Ω–Ω–æ—Å—Ç—å - {score:.0%}"
                self.speak(response)
                self.status_label.config(text=f"üé§ –û–∂–∏–¥–∞–Ω–∏–µ: '{self.voice_wake_word}'", fg=self.colors['primary_light'])
                return True
        
        # –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã
        command_mappings = [
            (["–ø–æ–∏—Å–∫", "–Ω–∞–π–¥–∏", "–Ω–∞–π—Ç–∏", "–∏—â–∏", "–∏—Å–∫–∞—Ç—å"], self.handle_search_command),
            (["–æ—Ç–∫—Ä–æ–π", "–æ—Ç–∫—Ä—ã—Ç—å", "–∑–∞–π–¥–∏", "–∑–∞–π—Ç–∏", "–ø–µ—Ä–µ–π–¥–∏", "–ø–µ—Ä–µ–π—Ç–∏"], self.handle_open_command),
            (["–ø–æ–≥–æ–¥–∞", "–ø–æ–≥–æ–¥—É", "–ø–æ–≥–æ–¥–µ", "—Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä–∞", "—Ç–µ–º–ø–µ—Ä–∞—Ç—É—Ä—É"], self.handle_weather_command),
            (["–∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä", "–ø–æ—Å—á–∏—Ç–∞–π", "–≤—ã—á–∏—Å–ª–∏", "—Å—á–∏—Ç–∞–π"], self.handle_calculator_command),
            (["–≤—Ä–µ–º—è", "—á–∞—Å", "—Å–∫–æ–ª—å–∫–æ –≤—Ä–µ–º–µ–Ω–∏", "–∫–æ—Ç–æ—Ä—ã–π —á–∞—Å"], self.handle_time_command),
            (["–±—Ä–∞—É–∑–µ—Ä", "–∏–Ω—Ç–µ—Ä–Ω–µ—Ç", "—Å–µ—Ç—å"], self.handle_browser_command),
            (["–±–ª–æ–∫–Ω–æ—Ç", "–∑–∞–º–µ—Ç–∫–∞", "–∑–∞–º–µ—Ç–∫–∏", "—Ç–µ–∫—Å—Ç"], self.handle_notepad_command),
            (["–¥–∏–ø—Å–∏–∫", "deepseek", "–∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç", "–∏–∏", "–∞–π", "ai"], self.handle_deepseek_command),
            (["–ø–æ–º–æ—â—å", "—Å–ø—Ä–∞–≤–∫–∞", "—á—Ç–æ —Ç—ã —É–º–µ–µ—à—å", "–∫–æ–º–∞–Ω–¥—ã"], self.handle_help_command),
            (["–Ω–∞—Å—Ç—Ä–æ–π–∫–∏", "–æ–ø—Ü–∏–∏", "–ø–∞—Ä–∞–º–µ—Ç—Ä—ã"], self.handle_settings_command),
            (["—Ä–µ–∂–∏–º", "–¥–µ–º–æ", "—Ä–∞–±–æ—á–∏–π"], self.handle_mode_command),
            (["—Å—Ç–æ–ø", "—Ö–≤–∞—Ç–∏—Ç", "–≤—ã–π—Ç–∏", "–∑–∞–∫–æ–Ω—á–∏", "–æ—Ç–∫–ª—é—á–∏—Å—å", "–≤—ã–∫–ª—é—á–∏—Å—å"], self.handle_stop_command),
            (["—Å–ø–∞—Å–∏–±–æ", "–±–ª–∞–≥–æ–¥–∞—Ä—é", "—Å–ø—Å", "thanks", "thank you"], self.handle_thanks_command),
            (["–∏–∏", "–∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ–ª–ª–µ–∫—Ç", "–æ–±—É—á–∏", "—Ç—Ä–µ–Ω–∏—Ä—É–π", "—Å–æ–∑–¥–∞–π –º–æ–¥–µ–ª—å", "–ø—Ä–µ–¥—Å–∫–∞–∂–∏", "–ø—Ä–æ–≥–Ω–æ–∑", "–∫–ª–∞—Å—Å–∏—Ñ–∏—Ü–∏—Ä—É–π", "—Ä–∞—Å–ø–æ–∑–Ω–∞–π"], self.handle_ai_command)
        ]
        
        for keywords, handler in command_mappings:
            for keyword in keywords:
                if keyword in command_lower:
                    print(f"‚úì –ù–∞–π–¥–µ–Ω–æ –∫–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ: '{keyword}'")
                    handler(command_lower, keyword)
                    return
        
        question_words = ["—á—Ç–æ", "–∫–∞–∫", "–≥–¥–µ", "–∫—Ç–æ", "–ø–æ—á–µ–º—É", "–∑–∞—á–µ–º", "–∫–æ–≥–¥–∞", "—Å–∫–æ–ª—å–∫–æ"]
        if any(word in words[:2] for word in question_words):
            print(f"‚úì –û–ø—Ä–µ–¥–µ–ª–µ–Ω –∫–∞–∫ –ø–æ–∏—Å–∫–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å: '{command}'")
            self.search_query.set(command)
            self.perform_search()
            self.status_label.config(text=f"üé§ –û–∂–∏–¥–∞–Ω–∏–µ: '{self.voice_wake_word}'", fg=self.colors['primary_light'])
            return
        
        print(f"‚úó –ù–µ–ø–æ–Ω—è—Ç–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞, –æ—Ç–∫—Ä—ã–≤–∞—é –∫–∞–∫ —Å–∞–π—Ç: '{command}'")
        self.open_site_by_voice(command)
        self.status_label.config(text=f"üé§ –û–∂–∏–¥–∞–Ω–∏–µ: '{self.voice_wake_word}'", fg=self.colors['primary_light'])
    
    def handle_search_command(self, command, keyword):
        """–û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥ –ø–æ–∏—Å–∫–∞"""
        query = command.replace(keyword, "").strip()
        if not query:
            self.speak("–ß—Ç–æ –∏—Å–∫–∞—Ç—å?")
            return
        
        self.search_query.set(query)
        self.perform_search()
        self.status_label.config(text=f"üé§ –û–∂–∏–¥–∞–Ω–∏–µ: '{self.voice_wake_word}'", fg=self.colors['primary_light'])
    
    def handle_open_command(self, command, keyword):
        """–û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥ –æ—Ç–∫—Ä—ã—Ç–∏—è"""
        site_name = command.replace(keyword, "").strip()
        if not site_name:
            self.speak("–ß—Ç–æ –æ—Ç–∫—Ä—ã—Ç—å?")
            return
        
        self.open_site_by_voice(site_name)
        self.status_label.config(text=f"üé§ –û–∂–∏–¥–∞–Ω–∏–µ: '{self.voice_wake_word}'", fg=self.colors['primary_light'])
    
    def handle_weather_command(self, command, keyword):
        """–û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥ –ø–æ–≥–æ–¥—ã"""
        city = command.replace(keyword, "").strip()
        if city:
            self.settings["weather_city"] = city
            self.save_settings()
        
        self.open_weather()
        self.status_label.config(text=f"üé§ –û–∂–∏–¥–∞–Ω–∏–µ: '{self.voice_wake_word}'", fg=self.colors['primary_light'])
    
    def handle_calculator_command(self, command, keyword):
        """–û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥ –∫–∞–ª—å–∫—É–ª—è—Ç–æ—Ä–∞"""
        self.open_calculator()
        self.status_label.config(text=f"üé§ –û–∂–∏–¥–∞–Ω–∏–µ: '{self.voice_wake_word}'", fg=self.colors['primary_light'])
    
    def handle_time_command(self, command, keyword):
        """–û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥ –≤—Ä–µ–º–µ–Ω–∏"""
        current_time = time.strftime("%H:%M:%S")
        current_date = time.strftime("%d.%m.%Y")
        
        response = f"–°–µ–π—á–∞—Å {current_time}, —Å–µ–≥–æ–¥–Ω—è {current_date}"
        self.speak(response)
        self.message_queue.put(f"–í—Ä–µ–º—è: {response}")
        self.status_label.config(text=f"üé§ –û–∂–∏–¥–∞–Ω–∏–µ: '{self.voice_wake_word}'", fg=self.colors['primary_light'])
    
    def handle_browser_command(self, command, keyword):
        """–û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥ –±—Ä–∞—É–∑–µ—Ä–∞"""
        self.open_browser_window()
        self.status_label.config(text=f"üé§ –û–∂–∏–¥–∞–Ω–∏–µ: '{self.voice_wake_word}'", fg=self.colors['primary_light'])
    
    def handle_notepad_command(self, command, keyword):
        """–û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥ –±–ª–æ–∫–Ω–æ—Ç–∞"""
        self.open_notepad()
        self.status_label.config(text=f"üé§ –û–∂–∏–¥–∞–Ω–∏–µ: '{self.voice_wake_word}'", fg=self.colors['primary_light'])
    
    def handle_deepseek_command(self, command, keyword):
        """–û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥ DeepSeek"""
        self.open_deepseek()
        self.status_label.config(text=f"üé§ –û–∂–∏–¥–∞–Ω–∏–µ: '{self.voice_wake_word}'", fg=self.colors['primary_light'])
    
    def handle_help_command(self, command, keyword):
        """–û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥ –ø–æ–º–æ—â–∏"""
        self.speak("–û—Ç–∫—Ä—ã–≤–∞—é —Å–ø—Ä–∞–≤–∫—É")
        self.notebook.select(7)
        self.status_label.config(text=f"üé§ –û–∂–∏–¥–∞–Ω–∏–µ: '{self.voice_wake_word}'", fg=self.colors['primary_light'])
    
    def handle_settings_command(self, command, keyword):
        """–û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥ –Ω–∞—Å—Ç—Ä–æ–µ–∫"""
        self.open_settings()
        self.status_label.config(text=f"üé§ –û–∂–∏–¥–∞–Ω–∏–µ: '{self.voice_wake_word}'", fg=self.colors['primary_light'])
    
    def handle_mode_command(self, command, keyword):
        """–û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥ —Å–º–µ–Ω—ã —Ä–µ–∂–∏–º–∞"""
        self.switch_mode()
        self.status_label.config(text=f"üé§ –û–∂–∏–¥–∞–Ω–∏–µ: '{self.voice_wake_word}'", fg=self.colors['primary_light'])
    
    def handle_stop_command(self, command, keyword):
        """–û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏"""
        self.voice_assistant_active = False
        self.background_listening = False
        self.speak("–ì–æ–ª–æ—Å–æ–≤–æ–π –ø–æ–º–æ—â–Ω–∏–∫ –æ—Ç–∫–ª—é—á–µ–Ω")
        self.status_label.config(text="–ì–æ–ª–æ—Å–æ–≤–æ–π –ø–æ–º–æ—â–Ω–∏–∫ –æ—Ç–∫–ª—é—á–µ–Ω", fg=self.colors['danger'])
    
    def handle_thanks_command(self, command, keyword):
        """–û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥ –±–ª–∞–≥–æ–¥–∞—Ä–Ω–æ—Å—Ç–∏"""
        responses = [
            "–í—Å–µ–≥–¥–∞ –ø–æ–∂–∞–ª—É–π—Å—Ç–∞!",
            "–†–∞–¥ –±—ã–ª –ø–æ–º–æ—á—å!",
            "–û–±—Ä–∞—â–∞–π—Ç–µ—Å—å!",
            "–ü–æ–∂–∞–ª—É–π—Å—Ç–∞! –ë—É–¥—É —Ä–∞–¥ –ø–æ–º–æ—á—å —Å–Ω–æ–≤–∞."
        ]
        response = random.choice(responses)
        self.speak(response)
        self.status_label.config(text=f"üé§ –û–∂–∏–¥–∞–Ω–∏–µ: '{self.voice_wake_word}'", fg=self.colors['primary_light'])
    
    def handle_ai_command(self, command, keyword):
        """–û–±—Ä–∞–±–æ—Ç–∫–∞ –∫–æ–º–∞–Ω–¥ –ò–ò-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç–∞"""
        self.open_ai_assistant()
        
        if any(word in command for word in ["–æ–±—É—á–∏", "—Ç—Ä–µ–Ω–∏—Ä—É–π", "—Å–æ–∑–¥–∞–π"]):
            self.speak("–û–±—Ä–∞–±–∞—Ç—ã–≤–∞—é –∑–∞–ø—Ä–æ—Å –Ω–∞ –æ–±—É—á–µ–Ω–∏–µ –ò–ò...")
            result = self.ai_assistant.enhanced_process_query(command)
            self.message_queue.put(f"–ò–ò: {result[:100]}...")
        
        self.status_label.config(text=f"üé§ –û–∂–∏–¥–∞–Ω–∏–µ: '{self.voice_wake_word}'", fg=self.colors['primary_light'])
    
    def open_site_by_voice(self, site_name):
        """–û—Ç–∫—Ä—ã—Ç–∏–µ —Å–∞–π—Ç–∞ –ø–æ –≥–æ–ª–æ—Å–æ–≤–æ–π –∫–æ–º–∞–Ω–¥–µ"""
        site_name_lower = site_name.lower()
        
        site_mapping = {
            "–≤–∫–æ–Ω—Ç–∞–∫—Ç–µ": ("–í–ö–æ–Ω—Ç–∞–∫—Ç–µ", self.settings["social_networks"]["–í–ö–æ–Ω—Ç–∞–∫—Ç–µ"]),
            "vk": ("–í–ö–æ–Ω—Ç–∞–∫—Ç–µ", self.settings["social_networks"]["–í–ö–æ–Ω—Ç–∞–∫—Ç–µ"]),
            "–æ–¥–Ω–æ–∫–ª–∞—Å—Å–Ω–∏–∫–∏": ("–û–¥–Ω–æ–∫–ª–∞—Å—Å–Ω–∏–∫–∏", self.settings["social_networks"]["–û–¥–Ω–æ–∫–ª–∞—Å—Å–Ω–∏–∫–∏"]),
            "–æ–∫": ("–û–¥–Ω–æ–∫–ª–∞—Å—Å–Ω–∏–∫–∏", self.settings["social_networks"]["–û–¥–Ω–æ–∫–ª–∞—Å—Å–Ω–∏–∫–∏"]),
            "—Ç–µ–ª–µ–≥—Ä–∞–º": ("Telegram", self.settings["social_networks"]["Telegram"]),
            "telegram": ("Telegram", self.settings["social_networks"]["Telegram"]),
            "–≤–∞—Ç—Å–∞–ø": ("WhatsApp Web", self.settings["social_networks"]["WhatsApp Web"]),
            "whatsapp": ("WhatsApp Web", self.settings["social_networks"]["WhatsApp Web"]),
            "–¥–∏—Å–∫–æ—Ä–¥": ("Discord", self.settings["social_networks"]["Discord"]),
            "discord": ("Discord", self.settings["social_networks"]["Discord"]),
            "—Ç–≤–∏—Ç—Ç–µ—Ä": ("Twitter", self.settings["social_networks"]["Twitter"]),
            "twitter": ("Twitter", self.settings["social_networks"]["Twitter"]),
            "—Ñ–µ–π—Å–±—É–∫": ("Facebook", self.settings["social_networks"]["Facebook"]),
            "facebook": ("Facebook", self.settings["social_networks"]["Facebook"]),
            "–∏–Ω—Å—Ç–∞–≥—Ä–∞–º": ("Instagram", self.settings["social_networks"]["Instagram"]),
            "instagram": ("Instagram", self.settings["social_networks"]["Instagram"]),
            "—é—Ç—É–±": ("YouTube", self.settings["social_networks"]["YouTube"]),
            "youtube": ("YouTube", self.settings["social_networks"]["YouTube"]),
            "—Ç–≤–∏—á": ("Twitch", self.settings["social_networks"]["Twitch"]),
            "twitch": ("Twitch", self.settings["social_networks"]["Twitch"]),
            "–¥–∏–ø—Å–∏–∫": ("DeepSeek AI", self.settings["social_networks"]["DeepSeek AI"]),
            "deepseek": ("DeepSeek AI", self.settings["social_networks"]["DeepSeek AI"]),
            "–≥—É–≥–ª": ("Google", self.settings["search_engines"]["Google"]),
            "google": ("Google", self.settings["search_engines"]["Google"]),
            "—è–Ω–¥–µ–∫—Å": ("–Ø–Ω–¥–µ–∫—Å", self.settings["search_engines"]["–Ø–Ω–¥–µ–∫—Å"]),
            "yandex": ("–Ø–Ω–¥–µ–∫—Å", self.settings["search_engines"]["–Ø–Ω–¥–µ–∫—Å"]),
            "–±–∏–Ω–≥": ("Bing", self.settings["search_engines"]["Bing"]),
            "bing": ("Bing", self.settings["search_engines"]["Bing"]),
            "–ø–æ—á—Ç–∞": ("–ü–æ—á—Ç–∞", "https://mail.google.com"),
            "gmail": ("Gmail", "https://mail.google.com"),
            "–Ω–æ–≤–æ—Å—Ç–∏": ("–ù–æ–≤–æ—Å—Ç–∏", "https://news.google.com"),
            "–∫–∞—Ä—Ç—ã": ("–ö–∞—Ä—Ç—ã", "https://www.google.com/maps"),
            "google maps": ("–ö–∞—Ä—Ç—ã", "https://www.google.com/maps"),
            "–ø–µ—Ä–µ–≤–æ–¥—á–∏–∫": ("–ü–µ—Ä–µ–≤–æ–¥—á–∏–∫", "https://translate.google.com"),
            "google translate": ("–ü–µ—Ä–µ–≤–æ–¥—á–∏–∫", "https://translate.google.com")
        }
        
        # –ü–æ–∏—Å–∫ –ø–æ —Ç–æ—á–Ω–æ–º—É —Å–æ–≤–ø–∞–¥–µ–Ω–∏—é
        if site_name_lower in site_mapping:
            name, url = site_mapping[site_name_lower]
            self.open_url(url)
            self.speak(f"–û—Ç–∫—Ä—ã–≤–∞—é {name}")
            return True
        
        # –ü–æ–∏—Å–∫ –ø–æ —á–∞—Å—Ç–∏—á–Ω–æ–º—É —Å–æ–≤–ø–∞–¥–µ–Ω–∏—é
        for key, (name, url) in site_mapping.items():
            if key in site_name_lower or site_name_lower in key:
                self.open_url(url)
                self.speak(f"–û—Ç–∫—Ä—ã–≤–∞—é {name}")
                return True
        
        # –ï—Å–ª–∏ –Ω–µ –Ω–∞—à–ª–∏ - –¥–µ–ª–∞–µ–º –ø–æ–∏—Å–∫
        self.search_query.set(site_name)
        self.perform_search()
        self.speak(f"–ò—â—É –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ {site_name}")
        return False
    
    def update_status_for_wake_word(self):
        """–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –ø—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ –∫–ª—é—á–µ–≤–æ–≥–æ —Å–ª–æ–≤–∞"""
        try:
            if hasattr(self, 'status_label'):
                self.status_label.config(text="üé§ –ö–ª—é—á–µ–≤–æ–µ —Å–ª–æ–≤–æ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–æ!", fg=self.colors['success'])
        except:
            pass
    
    def on_closing(self):
        """–û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è"""
        if messagebox.askyesno("–í—ã—Ö–æ–¥", "–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –≤—ã–π—Ç–∏?"):
            # –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≤—Å–µ —Ñ–æ–Ω–æ–≤—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã
            self.running = False
            self.background_listening = False
            self.voice_assistant_active = False
            
            # –û—Ç–º–µ–Ω—è–µ–º –≤—Å–µ –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏
            self.cancel_all_after()
            
            # –°–æ—Ö—Ä–∞–Ω—è–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
            self.save_settings()
            
            # –û—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –≥–æ–ª–æ—Å–æ–≤–æ–π –¥–≤–∏–∂–æ–∫
            if self.speech_engine:
                try:
                    self.speech_engine.stop()
                except:
                    pass
            
            # –ó–∞–∫—Ä—ã–≤–∞–µ–º –≤—Å–µ –æ–∫–Ω–∞
            try:
                if hasattr(self, 'selection_window') and self.selection_window.winfo_exists():
                    self.selection_window.destroy()
                
                if hasattr(self, 'auth_window') and self.auth_window.winfo_exists():
                    self.auth_window.destroy()
            except:
                pass
            
            # –ó–∞–∫—Ä—ã–≤–∞–µ–º –≥–ª–∞–≤–Ω–æ–µ –æ–∫–Ω–æ
            self.root.destroy()

# ========== –¢–û–ß–ö–ê –í–•–û–î–ê ==========

def main():
    """–ì–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è"""
    try:
        # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –≥–ª–∞–≤–Ω–æ–≥–æ –æ–∫–Ω–∞
        root = tk.Tk()
        
        # –°–æ–∑–¥–∞–Ω–∏–µ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        app = EnhancedVoiceAssistantGUI(root)
        
        # –û–±—Ä–∞–±–æ—Ç–∫–∞ –∑–∞–∫—Ä—ã—Ç–∏—è –æ–∫–Ω–∞
        root.protocol("WM_DELETE_WINDOW", app.on_closing)
        
        # –ó–∞–ø—É—Å–∫ –≥–ª–∞–≤–Ω–æ–≥–æ —Ü–∏–∫–ª–∞
        root.mainloop()
        
    except Exception as e:
        print(f"–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞: {e}")
        import traceback
        traceback.print_exc()
        
        # –ü—ã—Ç–∞–µ–º—Å—è —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏ –∞–≤–∞—Ä–∏–π–Ω–æ–º –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏
        try:
            if 'app' in locals():
                app.save_settings()
        except:
            pass

if __name__ == "__main__":
    main()